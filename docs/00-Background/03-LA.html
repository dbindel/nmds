<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Linear Algebra – Numerical Methods for Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../00-Background/04-Calculus.html" rel="next">
<link href="../00-Background/02-Performance.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../00-Background/00-Intro.html">Background Plus a Bit</a></li><li class="breadcrumb-item"><a href="../00-Background/03-LA.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Numerical Methods for Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../00-Background/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Background Plus a Bit</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/01-Julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Julia programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/02-Performance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Performance Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/03-LA.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/04-Calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Calculus and analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/05-Optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Optimization theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00-Background/06-Probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../01-Fund1d/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fundamentals in 1D</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/01-Error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Notions of Error</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/02-Arithmetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Floating Point</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/03-Approximation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Approximation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/04-AutoDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Automatic Differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/05-NumDiff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Numerical Differentiation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/06-Quadrature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Quadrature</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/07-Roots-Opt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Root Finding and Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01-Fund1d/08-Random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Computing with Randomness</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../02-NLA/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/01-Systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linear Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/02-Least-Squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Least Squares</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/03-Eigenvalues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Eigenvalue Problems and the SVD</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/04-Signals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Signals and Transforms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/05-Stationary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Stationary Iterations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02-NLA/06-Krylov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Krylov Subspaces</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../03-Nonlinear/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nonlinear Equations and Optimization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Nonlinear/01-Calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Calculus Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Nonlinear/02-Nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Nonlinear Equations and Unconstrained Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Nonlinear/03-Continuation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Continuation and Bifurcation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Nonlinear/04-Constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Constrained Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03-Nonlinear/05-Least-Squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Nonlinear Least Squares</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../04-Random/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing with Randomness</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-Random/01-Sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-Random/02-Monte-Carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Quadrature and Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-Random/03-Solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Solvers from Monte Carlo to Las Vegas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04-Random/04-UQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Uncertainty Quantification</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../05-Reduction/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dimension Reduction and Latent Factor Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-Reduction/01-Matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Latent Factors and Matrix Factorization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-Reduction/02-Tensor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">From Matrices to Tensors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05-Reduction/03-Nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Nonlinear Dimensionality Reduction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../06-Approximation/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Function Approximation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-Approximation/01-Concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Fundamental Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-Approximation/02-Low-Dimension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Low-Dimensional Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-Approximation/03-Kernels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Kernels and RBFs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06-Approximation/04-NN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Neural Networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../07-Networks/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Network Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-Networks/01-Matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Graphs and Matrices</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-Networks/02-Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Functions on Graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-Networks/03-Cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Clustering and Partitioning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07-Networks/04-Centrality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Centrality Measures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../08-Dynamics/00-Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning Dynamics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/01-Fundamentals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Fundamentals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/02-Model-Reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Model Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/03-Linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Learning Linear Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/04-Extrapolation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Extrapolation and Acceleration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/05-Koopman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">From Markov to Koopman</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08-Dynamics/06-Nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Learning Nonlinear Dynamics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#vector-spaces" id="toc-vector-spaces" class="nav-link active" data-scroll-target="#vector-spaces"><span class="header-section-number">4.1</span> Vector spaces</a>
  <ul class="collapse">
  <li><a href="#polynomials" id="toc-polynomials" class="nav-link" data-scroll-target="#polynomials"><span class="header-section-number">4.1.1</span> Polynomials</a></li>
  <li><a href="#dual-spaces" id="toc-dual-spaces" class="nav-link" data-scroll-target="#dual-spaces"><span class="header-section-number">4.1.2</span> Dual spaces</a></li>
  <li><a href="#subspaces" id="toc-subspaces" class="nav-link" data-scroll-target="#subspaces"><span class="header-section-number">4.1.3</span> Subspaces</a></li>
  <li><a href="#quasimatrices" id="toc-quasimatrices" class="nav-link" data-scroll-target="#quasimatrices"><span class="header-section-number">4.1.4</span> Quasimatrices</a></li>
  <li><a href="#bases" id="toc-bases" class="nav-link" data-scroll-target="#bases"><span class="header-section-number">4.1.5</span> Bases</a></li>
  <li><a href="#vector-norms" id="toc-vector-norms" class="nav-link" data-scroll-target="#vector-norms"><span class="header-section-number">4.1.6</span> Vector norms</a></li>
  <li><a href="#sec-la-bg-inner-product" id="toc-sec-la-bg-inner-product" class="nav-link" data-scroll-target="#sec-la-bg-inner-product"><span class="header-section-number">4.1.7</span> Inner products</a></li>
  </ul></li>
  <li><a href="#maps-and-forms" id="toc-maps-and-forms" class="nav-link" data-scroll-target="#maps-and-forms"><span class="header-section-number">4.2</span> Maps and forms</a>
  <ul class="collapse">
  <li><a href="#dual-and-adjoint-maps" id="toc-dual-and-adjoint-maps" class="nav-link" data-scroll-target="#dual-and-adjoint-maps"><span class="header-section-number">4.2.1</span> Dual and adjoint maps</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices"><span class="header-section-number">4.2.2</span> Matrices</a></li>
  <li><a href="#block-matrices" id="toc-block-matrices" class="nav-link" data-scroll-target="#block-matrices"><span class="header-section-number">4.2.3</span> Block matrices</a></li>
  <li><a href="#canonical-forms" id="toc-canonical-forms" class="nav-link" data-scroll-target="#canonical-forms"><span class="header-section-number">4.2.4</span> Canonical forms</a></li>
  <li><a href="#pseudoinverses" id="toc-pseudoinverses" class="nav-link" data-scroll-target="#pseudoinverses"><span class="header-section-number">4.2.5</span> (Pseudo)inverses</a></li>
  <li><a href="#norms" id="toc-norms" class="nav-link" data-scroll-target="#norms"><span class="header-section-number">4.2.6</span> Norms</a></li>
  <li><a href="#isometries" id="toc-isometries" class="nav-link" data-scroll-target="#isometries"><span class="header-section-number">4.2.7</span> Isometries</a></li>
  <li><a href="#volume-scaling" id="toc-volume-scaling" class="nav-link" data-scroll-target="#volume-scaling"><span class="header-section-number">4.2.8</span> Volume scaling</a></li>
  </ul></li>
  <li><a href="#operators" id="toc-operators" class="nav-link" data-scroll-target="#operators"><span class="header-section-number">4.3</span> Operators</a>
  <ul class="collapse">
  <li><a href="#minimal-polynomial" id="toc-minimal-polynomial" class="nav-link" data-scroll-target="#minimal-polynomial"><span class="header-section-number">4.3.1</span> Minimal polynomial</a></li>
  <li><a href="#canonical-forms-1" id="toc-canonical-forms-1" class="nav-link" data-scroll-target="#canonical-forms-1"><span class="header-section-number">4.3.2</span> Canonical forms</a></li>
  <li><a href="#similar-matrices" id="toc-similar-matrices" class="nav-link" data-scroll-target="#similar-matrices"><span class="header-section-number">4.3.3</span> Similar matrices</a></li>
  <li><a href="#trace" id="toc-trace" class="nav-link" data-scroll-target="#trace"><span class="header-section-number">4.3.4</span> Trace</a></li>
  <li><a href="#frobenius-inner-product" id="toc-frobenius-inner-product" class="nav-link" data-scroll-target="#frobenius-inner-product"><span class="header-section-number">4.3.5</span> Frobenius inner product</a></li>
  <li><a href="#hermitian-and-skew" id="toc-hermitian-and-skew" class="nav-link" data-scroll-target="#hermitian-and-skew"><span class="header-section-number">4.3.6</span> Hermitian and skew</a></li>
  </ul></li>
  <li><a href="#hermitian-and-quadratic-forms" id="toc-hermitian-and-quadratic-forms" class="nav-link" data-scroll-target="#hermitian-and-quadratic-forms"><span class="header-section-number">4.4</span> Hermitian and quadratic forms</a>
  <ul class="collapse">
  <li><a href="#matrices-1" id="toc-matrices-1" class="nav-link" data-scroll-target="#matrices-1"><span class="header-section-number">4.4.1</span> Matrices</a></li>
  <li><a href="#canonical-forms-2" id="toc-canonical-forms-2" class="nav-link" data-scroll-target="#canonical-forms-2"><span class="header-section-number">4.4.2</span> Canonical forms</a></li>
  <li><a href="#a-derivative-example" id="toc-a-derivative-example" class="nav-link" data-scroll-target="#a-derivative-example"><span class="header-section-number">4.4.3</span> A derivative example</a></li>
  </ul></li>
  <li><a href="#sec-tensor-bg-sec" id="toc-sec-tensor-bg-sec" class="nav-link" data-scroll-target="#sec-tensor-bg-sec"><span class="header-section-number">4.5</span> Tensors and determinants</a>
  <ul class="collapse">
  <li><a href="#takes-on-tensors" id="toc-takes-on-tensors" class="nav-link" data-scroll-target="#takes-on-tensors"><span class="header-section-number">4.5.1</span> Takes on tensors</a></li>
  <li><a href="#multilinear-forms" id="toc-multilinear-forms" class="nav-link" data-scroll-target="#multilinear-forms"><span class="header-section-number">4.5.2</span> Multilinear forms</a></li>
  <li><a href="#polynomial-products" id="toc-polynomial-products" class="nav-link" data-scroll-target="#polynomial-products"><span class="header-section-number">4.5.3</span> Polynomial products</a></li>
  <li><a href="#alternating-forms" id="toc-alternating-forms" class="nav-link" data-scroll-target="#alternating-forms"><span class="header-section-number">4.5.4</span> Alternating forms</a></li>
  <li><a href="#sec-determinant-sec" id="toc-sec-determinant-sec" class="nav-link" data-scroll-target="#sec-determinant-sec"><span class="header-section-number">4.5.5</span> Determinants</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../00-Background/00-Intro.html">Background Plus a Bit</a></li><li class="breadcrumb-item"><a href="../00-Background/03-LA.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-la-ch" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We will not get far in this book without a strong foundation in linear algebra. That means knowing how to compute with matrices, but it also means understanding the abstractions of linear algebra well enough to use them effectively. We assume prior familiarity with linear algebra at the level of an undergraduate course taught from <span class="citation" data-cites="strang-2023">Strang (<a href="../references.html#ref-strang-2023" role="doc-biblioref">2023</a>)</span> or <span class="citation" data-cites="lay-2015">Lay, Lay, and McDonald (<a href="../references.html#ref-lay-2015" role="doc-biblioref">2015</a>)</span>. It will be helpful, but not necessary, to have a more advanced perspective as covered in <span class="citation" data-cites="axler-2024">Axler (<a href="../references.html#ref-axler-2024" role="doc-biblioref">2024</a>)</span> or even <span class="citation" data-cites="lax-2007">Lax (<a href="../references.html#ref-lax-2007" role="doc-biblioref">2007</a>)</span>. Even for readers well-versed with linear algebra, we suggest skimming this chapter, as some ideas (quasimatrices, the framework of canonical forms) are not always standard in first (or even second) linear algebra courses.</p>
<p>While our treatment will be fairly abstract, we try to keep things concrete by regularly giving examples in Julia. Readers unfamiliar with Julia may want to review <a href="01-Julia.html" class="quarto-xref"><span>Chapter 2</span></a>; it is also possible to simply skim past the code examples.</p>
<p>We do not assume a prior course in functional analysis. This will not prevent us from sneaking a little functional analysis into our discussion, or treating some linear algebra concepts from a functional analysis perspective.</p>
<section id="vector-spaces" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="vector-spaces"><span class="header-section-number">4.1</span> Vector spaces</h2>
<p>A vector space (or linear space) over a field <span class="math inline">\(\mathbb{F}\)</span> is a set with elements (vectors) that can be added or scaled in a sensible way – that is, addition is associative and commutative and scaling (by elements of the field) is distributive. We will always take <span class="math inline">\(\mathbb{F}\)</span> to be <span class="math inline">\(\mathbb{R}\)</span> or <span class="math inline">\(\mathbb{C}\)</span>. We generally denote vector spaces by script letters (e.g.&nbsp;<span class="math inline">\(\mathcal{V}, \mathcal{W}\)</span>), vectors by lower case Roman letters (e.g.&nbsp;<span class="math inline">\(v, w\)</span>), and scalars by lower case Greek letters (e.g.&nbsp;<span class="math inline">\(\alpha, \beta\)</span>). But we feel free to violate these conventions according to the dictates of our conscience or in deference to other conflicting conventions.</p>
<p>There are many types of vector spaces. Apart from the ubiquitous concrete vector spaces <span class="math inline">\(\mathbb{R}^n\)</span> and <span class="math inline">\(\mathbb{C}^n\)</span>, the most common vector spaces in applied mathematics are different types of function spaces. These include <span class="math display">\[\begin{aligned}
  \mathcal{P}_d &amp;=
  \{ \mbox{polynomials of degree at most $d$} \}; \\
  L(\mathcal{V}, \mathcal{W}) &amp;=
  \{ \mbox{linear maps $\mathcal{V}\rightarrow \mathcal{W}$} \}; \\
  \mathcal{C}^k(\Omega) &amp;=
  \{\mbox{ $k$-times differentiable functions on a set $\Omega$} \}; \\
  \ell^1 &amp;= \{ \mbox{absolutely summable sequences } x_1, x_2, \ldots \} \\
  \ell^2 &amp;= \{ \mbox{absolutely square-summable sequences } x_1, x_2, \ldots \} \\
  \ell^\infty &amp;= \{ \mbox{bounded sequences } x_1, x_2, \ldots \}
\end{aligned}\]</span> and many more. A <em>finite-dimensional</em> vector space can be put into 1-1 correspondence with some concrete vector space <span class="math inline">\(\mathbb{F}^n\)</span> (using a <em>basis</em>). In this case, <span class="math inline">\(n\)</span> is the <em>dimension</em> of the space. Vector spaces that are not finite-dimensional are <em>infinite-dimensional</em>.</p>
<section id="polynomials" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="polynomials"><span class="header-section-number">4.1.1</span> Polynomials</h3>
<p>We compute with vectors in <span class="math inline">\(\mathbb{F}^n\)</span> (<span class="math inline">\(\mathbb{R}^n\)</span> and <span class="math inline">\(\mathbb{C}^n\)</span>), which we represent concretely by tuples of numbers in memory, usually stored in sequence. To keep a broader perspective, we will also frequently describe examples involving the polynomial spaces <span class="math inline">\(\mathcal{P}_d\)</span>.</p>
<p>The Julia <a href="https://juliamath.github.io/Polynomials.jl/"><code>Polynomials.jl</code></a> package provides a variety of representations of and operations on polynomials.</p>
<div id="ed79d77a" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Polynomials</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, we can construct a polynomial in standard form from its coefficients in the monomial basis or from its roots, or we can keep it in factored form internally.</p>
<div id="442ae944" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Polynomial</span>([<span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
2 - 3∙x + x<sup>2</sup>
</div>
</div>
<div id="aca1b743" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fromroots</span>([<span class="fl">1</span>, <span class="fl">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
2 - 3∙x + x<sup>2</sup>
</div>
</div>
<div id="f6c52ed2" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fromroots</span>(FactoredPolynomial, [<span class="fl">1</span>, <span class="fl">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
(x - 2) * (x - 1)
</div>
</div>
<p>The fact that there are several natural representations for polynomials is part of what makes them a good example of an abstract vector space.</p>
</section>
<section id="dual-spaces" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="dual-spaces"><span class="header-section-number">4.1.2</span> Dual spaces</h3>
<p>A vector space in isolation is a lonely thing<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Fortunately, every vector space has an associated <em>dual</em> space of linear functionals<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, that is <span class="math display">\[
  \mathcal{V}^* =
  \{ \mbox{linear functions $\mathcal{V} \rightarrow \mathbb{F}$} \}.
\]</span> Dual pairs are everywhere in applied mathematics. The relation between random variables and probability densities, the theory of Lagrange multipliers, and the notion of generalized functions are all examples. It is also sometimes convenient to recast equations in terms of linear functionals, e.g.&nbsp;using the fact that <span class="math inline">\(v = 0\)</span> iff <span class="math inline">\(\forall w^* \in \mathcal{V}^*,
w^* v = 0\)</span>.</p>
<p>In matrix terms, we usually associate vectors with columns and dual vectors with columns (ordinary vectors) and rows (dual vectors). In Julia, we construct a dual vector by taking the conjugate transpose of a column, e.g.</p>
<div id="c1f8f15d" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>([<span class="fl">1.0</span>; <span class="fl">2.0</span>; <span class="fl">3.0</span>])   <span class="co"># Column vector in R^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div class="ansi-escaped-output">
<pre>Vector{Float64}<span class="ansi-bright-black-fg"> (alias for </span><span class="ansi-bright-black-fg">Array{Float64, 1}</span><span class="ansi-bright-black-fg">)</span></pre>
</div>
</div>
</div>
<div id="aa9a08c2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>([<span class="fl">0.0</span>; <span class="fl">1.0</span>; <span class="fl">0.0</span>]<span class="ch">')  # Row vector in R^3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Adjoint{Float64, Vector{Float64}}</code></pre>
</div>
</div>
<p>Applying a linear functional is concretely just “row times column”:</p>
<div id="d1ec1563" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> [<span class="fl">1.0</span>; <span class="fl">2.0</span>; <span class="fl">3.0</span>]   <span class="co"># Column vector in R^3</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> [<span class="fl">0.0</span>; <span class="fl">1.0</span>; <span class="fl">0.0</span>]<span class="ch">'  # Row vector in R^3</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    w<span class="op">*</span>v</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>2.0</code></pre>
</div>
</div>
<p>In order to try to keep the syntax uniform between concrete vectors and operations on abstract polynomial spaces, we will define a <code>DualVector</code> type representing a (linear) functional</p>
<div id="3128d2a1" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> DualVector</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    f <span class="op">::</span><span class="dt"> Function</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We overload the function evaluation and multiplication syntax so that we can write application of a dual vector <span class="math inline">\(w^*\)</span> to a vector <span class="math inline">\(v\)</span> as <code>w(v)</code> or as <code>w*v</code>.</p>
<div id="4acd0c00" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(w <span class="op">::</span><span class="dt"> DualVector</span>)(v) <span class="op">=</span> w.<span class="fu">f</span>(v)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">*</span>(w <span class="op">::</span><span class="dt"> DualVector</span>, v) <span class="op">=</span> <span class="fu">w</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because dual vectors still make up a vector space, we would like to be able to add and scale them:</p>
<div id="f70d675f" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">+</span>(w1 <span class="op">::</span><span class="dt"> DualVector</span>, w2 <span class="op">::</span><span class="dt"> DualVector</span>) <span class="op">=</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DualVector</span>(v <span class="op">-&gt;</span> <span class="fu">w1</span>(v) <span class="op">+</span> <span class="fu">w2</span>(v))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">-</span>(w1 <span class="op">::</span><span class="dt"> DualVector</span>, w2 <span class="op">::</span><span class="dt"> DualVector</span>) <span class="op">=</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DualVector</span>(v <span class="op">-&gt;</span> <span class="fu">w1</span>(v) <span class="op">-</span> <span class="fu">w2</span>(v))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">-</span>(w <span class="op">::</span><span class="dt"> DualVector</span>) <span class="op">=</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DualVector</span>(v <span class="op">-&gt;</span> <span class="fu">-w</span>(v))</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">*</span>(c <span class="op">::</span><span class="dt"> Number</span>, w <span class="op">::</span><span class="dt"> DualVector</span>) <span class="op">=</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DualVector</span>(v <span class="op">-&gt;</span> <span class="fu">c*w</span>(v))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">*</span>(w <span class="op">::</span><span class="dt"> DualVector</span>, c <span class="op">::</span><span class="dt"> Number</span>) <span class="op">=</span> c<span class="op">*</span>w</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:/</span>(w <span class="op">::</span><span class="dt"> DualVector</span>, c <span class="op">::</span><span class="dt"> Number</span>) <span class="op">=</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DualVector</span>(v <span class="op">-&gt;</span> <span class="fu">w</span>(v)<span class="op">/</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Evaluating a polynomial at a point is one example of a functional in <span class="math inline">\(\mathcal{P}_d^*\)</span>; another example is a definite integral operation:</p>
<div id="a316c234" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">2.0</span>; <span class="op">-</span><span class="fl">3.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    w1 <span class="op">=</span> <span class="fu">DualVector</span>(p <span class="op">-&gt;</span> <span class="fu">p</span>(<span class="fl">0.0</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    w2 <span class="op">=</span> <span class="fu">DualVector</span>(p <span class="op">-&gt;</span> <span class="fu">integrate</span>(p, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    w1<span class="op">*</span>p, w2<span class="op">*</span>p</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(2.0, 4.666666666666666)</code></pre>
</div>
</div>
</section>
<section id="subspaces" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="subspaces"><span class="header-section-number">4.1.3</span> Subspaces</h3>
<p>Given a vector space <span class="math inline">\(\mathcal{V}\)</span>, a (nonempty<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>) subset <span class="math inline">\(\mathcal{U}\subset \mathcal{V}\)</span> is a <em>subspace</em> if it is closed under the vector space operations (addition and scalar multiplication). We usually take <span class="math inline">\(\mathcal{U}\)</span> to inherit any applicable structure from <span class="math inline">\(\mathcal{V}\)</span>, such as a norm or inner product. Many concepts in numerical linear algebra and approximation theory are best thought of in terms of subspaces, whether that is nested subspaces used in approximation theory, subspaces that are invariant under some linear map, or subspaces and their orthogonal complements.</p>
<p>There are a few standard operations involving subspaces:</p>
<ul>
<li><p>The <em>span</em> of a subset <span class="math inline">\(S \subset \mathcal{V}\)</span> is the smallest subspace that contains <span class="math inline">\(S\)</span>, i.e.&nbsp;the set of all finite linear combinations <span class="math inline">\(\sum_i c_i s_i\)</span> where each <span class="math inline">\(s_i \in S\)</span> and <span class="math inline">\(c_i \in \mathbb{F}\)</span>.</p></li>
<li><p>Given a collection of subspaces <span class="math inline">\(\mathcal{U}_i\)</span>, their <em>sum</em> is the subspace <span class="math inline">\(\mathcal{U}\)</span> consisting of all sums of elements <span class="math inline">\(\sum_i u_i\)</span> where only finitely many <span class="math inline">\(u_i \in \mathcal{U}_i\)</span> are nonzero. We say the sum is a <em>direct sum</em> if the decomposition into vectors <span class="math inline">\(u_i \in \mathcal{U}_i\)</span> is unique.</p></li>
<li><p>The <em>annihilator</em> for a subspace <span class="math inline">\(\mathcal{U}\subset \mathcal{V}\)</span> is the set of linear functionals that are zero on <span class="math inline">\(\mathcal{U}\)</span>. That is: <span class="math display">\[
  \mathcal{U}^\perp = \{ w^* \in \mathcal{V}^* : \forall u \in \mathcal{U}, w^* u = 0 \}.
\]</span> In inner product spaces, the annihilator of a subspace is identified with the <em>orthogonal complement</em> (<a href="#sec-la-bg-inner-product" class="quarto-xref"><span>Section 4.1.7</span></a>).</p></li>
<li><p>Given a subspace <span class="math inline">\(\mathcal{U}\subset \mathcal{V}\)</span>, the <em>quotient space</em> <span class="math inline">\(\mathcal{V}
/ \mathcal{U}\)</span> is a vector space whose elements are equivalence classes under the relation <span class="math inline">\(v_1 \sim v_2\)</span> if <span class="math inline">\(v_1-v_2 \in \mathcal{U}\)</span>. We can always find a “complementary” subspace <span class="math inline">\(\mathcal{U}^c \subset \mathcal{V}\)</span> isomorphic to <span class="math inline">\(\mathcal{V}/ \mathcal{U}\)</span> such that each equivalence class in <span class="math inline">\(\mathcal{V}/ \mathcal{U}\)</span> contains a unique representative from <span class="math inline">\(\mathcal{U}^c\)</span>. Indeed, we can generally find many such spaces! For any complementary subspace <span class="math inline">\(\mathcal{U}^c\)</span>, <span class="math inline">\(\mathcal{V}\)</span> is a direct sum <span class="math inline">\(\mathcal{U}
\oplus \mathcal{U}^c\)</span>.</p></li>
<li><p>In the infinite-dimensional setting, the <em>closure</em> of a subspace consists of all limit points in the subspace. This only makes sense in <em>topological</em> vector spaces where we have enough structure that we can take limits. We will always consider the even stronger structure of <em>normed</em> vector spaces.</p></li>
</ul>
</section>
<section id="quasimatrices" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="quasimatrices"><span class="header-section-number">4.1.4</span> Quasimatrices</h3>
<p>Matrix notation is convenient for expressing linear algebra over concrete vector spaces like <span class="math inline">\(\mathbb{R}^n\)</span> and <span class="math inline">\(\mathbb{C}^n\)</span>. To get that same convenience for abstract vector spaces, we introduce the more general notion of <em>quasimatrices</em>, matrix-like objects that involve more than just ordinary numbers. This includes letting columns or rows belong to an abstract vector space instead of a concrete space like <span class="math inline">\(\mathbb{R}^m\)</span> or <span class="math inline">\(\mathbb{R}^n\)</span>, or using linear maps between subspaces as the “entries” of a matrix.</p>
<section id="column-quasimatrices" class="level4" data-number="4.1.4.1">
<h4 data-number="4.1.4.1" class="anchored" data-anchor-id="column-quasimatrices"><span class="header-section-number">4.1.4.1</span> Column quasimatrices</h4>
<p>A (column) <em>quasimatrix</em> is a list of vectors in some space <span class="math inline">\(\mathcal{V}\)</span> interpreted as columns of a matrix-like object, i.e. <span class="math display">\[
  U = \begin{bmatrix} u_1 &amp; u_2 &amp; \ldots &amp; u_n \end{bmatrix}.
\]</span> We write a linear combination of the columns of <span class="math inline">\(U\)</span> as <span class="math display">\[
  Uc = \sum_{i=1}^n u_i c_i
\]</span> for some coefficient vector <span class="math inline">\(c \in \mathbb{F}^n\)</span>. The <em>range space</em> <span class="math inline">\(\mathcal{R}(U) = \{ Uc : c \in \mathbb{F}^n \}\)</span> (or <em>column space</em>) is the set of all possible linear combinations of the columns; this is the same as the <em>span</em> of the set of column vectors. The key advantages of column quasimatrices over sets of vectors is that we assign indices to name the vectors and we allow for the possibility of duplicates.</p>
<p>When <span class="math inline">\(\mathcal{V}\)</span> is a concrete vector space like <span class="math inline">\(\mathbb{R}^m\)</span> or <span class="math inline">\(\mathbb{C}^m\)</span>, the notion of a quasimatrix coincides with the idea of an ordinary matrix, and taking a linear combination of columns corresponds to ordinary matrix-vector multiplication. We will typically use the word “quasimatrix” when the columns correspond to vectors in an abstract vector space like <span class="math inline">\(\mathcal{P}_d\)</span>.</p>
<p>We can represent a quasimatrix with columns in <span class="math inline">\(\mathcal{P}_d\)</span> by an ordinary Julia array of <code>Polynomial</code>s, e.g.</p>
<div id="152208cf" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Udemo <span class="op">=</span> <span class="kw">let</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">1.0</span>])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    p3 <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">2.0</span>, <span class="op">-</span><span class="fl">3.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transpose</span>([p1; p2; p3])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>1×3 transpose(::Vector{Polynomial{Float64, :x}}) with eltype Polynomial{Float64, :x}:
 Polynomial(1.0)  Polynomial(-1.0 + 1.0*x)  Polynomial(2.0 - 3.0*x + 1.0*x^2)</code></pre>
</div>
</div>
<p>We can use these together with standard matrix operations involving concrete vectors, e.g.</p>
<div id="616f187d" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Udemo<span class="op">*</span>[<span class="fl">1.0</span> <span class="fl">1.0</span>; <span class="fl">1.0</span> <span class="fl">1.0</span>; <span class="fl">1.0</span> <span class="fl">0.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>1×2 transpose(::Vector{Polynomial{Float64, :x}}) with eltype Polynomial{Float64, :x}:
 Polynomial(2.0 - 2.0*x + 1.0*x^2)  Polynomial(1.0*x)</code></pre>
</div>
</div>
<p>We also want to be able to multiply a dual vector by a quasimatrix to get a concrete row vector:</p>
<div id="a5dc0373" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Base</span>.<span class="op">:</span><span class="fu">*</span>(w <span class="op">::</span><span class="dt"> DualVector</span>, U <span class="op">::</span><span class="dt"> AbstractMatrix</span>) <span class="op">=</span> <span class="fu">map</span>(w, U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example,</p>
<div id="a2e7ee1b" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DualVector</span>(<span class="fu">p-&gt;p</span>(<span class="fl">0.0</span>)) <span class="op">*</span> Udemo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>1×3 transpose(::Vector{Float64}) with eltype Float64:
 1.0  -1.0  2.0</code></pre>
</div>
</div>
<p>We sometimes want to refer to a subset of the columns. In mathematical writing, we will use notation similar to that in Julia or MATLAB: <span class="math display">\[
  U_{:,p:q} = \begin{bmatrix} u_p &amp; u_{p+1} &amp; \ldots &amp; u_q \end{bmatrix}.
\]</span> We will also sometimes (horizontally) <em>concatenate</em> two quasimatrices with columns in the same <span class="math inline">\(\mathcal{V}\)</span>, e.g. <span class="math display">\[
  U = \begin{bmatrix} U_{:,1:p} &amp; U_{:,p+1:n} \end{bmatrix}.
\]</span> The range of the horizontal concatenation of two quasimatrices is the same as the sum of the ranges, i.e. <span class="math display">\[
  \mathcal{R}(U) = \mathcal{R}(U_{:,1:p}) + \mathcal{R}(U_{:,p+1:n}).
\]</span></p>
</section>
<section id="row-quasimatrices" class="level4" data-number="4.1.4.2">
<h4 data-number="4.1.4.2" class="anchored" data-anchor-id="row-quasimatrices"><span class="header-section-number">4.1.4.2</span> Row quasimatrices</h4>
<p>Every vector space <span class="math inline">\(\mathcal{V}\)</span> over a field <span class="math inline">\(\mathbb{F}\)</span> has a natural dual space <span class="math inline">\(\mathcal{V}^*\)</span> of linear functions from <span class="math inline">\(\mathcal{V}\)</span> to <span class="math inline">\(\mathbb{F}\)</span> (aka linear functionals). A <em>row</em> quasimatrix is a list of vectors in a dual space <span class="math inline">\(\mathcal{V}^*\)</span> interpreted as the rows of a matrix-like object, i.e. <span class="math display">\[
  W^* = \begin{bmatrix} w_1^* \\ w_2^* \\ \vdots \\ w_m^* \end{bmatrix}.
\]</span> We write linear combinations of rows as <span class="math display">\[
  c^* W^* = \sum_{i=1}^m \bar{c}_i w_i^*;
\]</span> the set of all such linear combinations is the <em>row space</em> of the quasimatrix. We can refer to a subset of rows with colon notation as in Julia or MATLAB: <span class="math display">\[
  (W^*)_{p:q,:} = \begin{bmatrix} w_p^* \\ w_{p+1}^* \\ \vdots \\ w_q^* \end{bmatrix}.
\]</span> We can also combine row quasimatrices via horizontal concatenation, e.g. <span class="math display">\[
  W^* = \begin{bmatrix} (W^*)_{1:p,:} \\ (W^*)_{p+1:m,:} \end{bmatrix} .
\]</span></p>
<p>In Julia, analogous to the column quasimatrices over spaces <span class="math inline">\(\mathcal{P}_d\)</span>, we can define a structure representing row quasimatrices over spaces <span class="math inline">\(\mathcal{P}_d^*\)</span>.</p>
<div id="3b10a682" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Wdemo <span class="op">=</span> <span class="fu">DualVector</span>.(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    [p <span class="op">-&gt;</span> <span class="fu">p</span>(<span class="fl">0.0</span>);</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     p <span class="op">-&gt;</span> <span class="fu">p</span>(<span class="fl">1.0</span>);</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>     p <span class="op">-&gt;</span> <span class="fu">integrate</span>(p, <span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>3-element Vector{DualVector}:
 DualVector(var"#27#30"())
 DualVector(var"#28#31"())
 DualVector(var"#29#32"())</code></pre>
</div>
</div>
</section>
<section id="duality-relations" class="level4" data-number="4.1.4.3">
<h4 data-number="4.1.4.3" class="anchored" data-anchor-id="duality-relations"><span class="header-section-number">4.1.4.3</span> Duality relations</h4>
<p>For a column quasimatrix <span class="math inline">\(U\)</span> with columns in <span class="math inline">\(\mathcal{V}\)</span>, the map <span class="math inline">\(c \mapsto Uc\)</span> takes a concrete vector <span class="math inline">\(c \in \mathbb{F}^n\)</span> to an abstract vector <span class="math inline">\(\mathcal{V}\)</span>. Alternately, if <span class="math inline">\(w^* \in \mathcal{V}^*\)</span> is a linear functional, we have <span class="math display">\[
  d^* = w^* U =
  \begin{bmatrix} w^* u_1 &amp; w^* u_2 &amp; \ldots &amp; w^* u_n \end{bmatrix},
\]</span> representing a concrete row vector such that <span class="math inline">\(d^* c = w^* (Uc)\)</span>. So <span class="math inline">\(U\)</span> can be associated either with a linear map from a concrete vector space <span class="math inline">\(\mathbb{F}^n\)</span> to an abstract vector space <span class="math inline">\(\mathcal{V}\)</span>, or with a linear map from the abstract dual space <span class="math inline">\(\mathcal{V}^*\)</span> to a concrete (row) vector space associated with linear functionals on <span class="math inline">\(\mathbb{F}^n\)</span>.</p>
<div id="9c51de32" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: map concrete [1; 1; 1] to a Polynomial</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Udemo<span class="op">*</span>[<span class="fl">1</span>; <span class="fl">1</span>; <span class="fl">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
2.0 - 2.0∙x + 1.0∙x<sup>2</sup>
</div>
</div>
<div id="285d5910" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: map DualVector to a concrete row</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DualVector</span>(<span class="fu">p-&gt;p</span>(<span class="fl">0</span>))<span class="op">*</span>Udemo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>1×3 transpose(::Vector{Float64}) with eltype Float64:
 1.0  -1.0  2.0</code></pre>
</div>
</div>
<p>Similarly, a row quasimatrix <span class="math inline">\(W^*\)</span> can be interpreted as a map from a concrete row vector to an abstract dual vector in <span class="math inline">\(\mathcal{V}^*\)</span>, or as a map from an abstract vector in <span class="math inline">\(\mathcal{V}\)</span> to a concrete vector in <span class="math inline">\(\mathbb{F}^m\)</span>.</p>
<div id="827877c3" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: map concrete row to an abstract dual vector</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>([<span class="fl">1.0</span>; <span class="fl">1.0</span>; <span class="fl">1.0</span>]<span class="ch">'*Wdemo)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>DualVector</code></pre>
</div>
</div>
<div id="81f932e1" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: map Polynomial to a concrete vector</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Wdemo<span class="op">.*</span><span class="fu">Polynomial</span>([<span class="fl">2.0</span>, <span class="op">-</span><span class="fl">3.0</span>, <span class="fl">1.0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>3-element Vector{Float64}:
 2.0
 0.0
 4.666666666666666</code></pre>
</div>
</div>
<p>Composing the actions of a row quasimatrix with a column quasimatrix gives us an ordinary matrix representing a mapping between two abstract vector spaces: <span class="math display">\[
  W^* U =
  \begin{bmatrix}
  w_1^* u_1 &amp; \ldots &amp; w_1^* u_n \\
  \vdots &amp;  &amp; \vdots \\
  w_m^* u_1 &amp; \ldots &amp; w_m^* u_n
  \end{bmatrix}
\]</span> For example,</p>
<div id="74bdf4bd" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Wdemo<span class="op">*</span>Udemo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>3×3 Matrix{Float64}:
 1.0  -1.0  2.0
 1.0   0.0  0.0
 2.0  -2.0  4.66667</code></pre>
</div>
</div>
<p>Conversely, composing the actions of a column quasimatrix with a row quasimatrix (assuming <span class="math inline">\(m = n\)</span>) gives us an operator mapping <span class="math inline">\(\mathcal{V}\)</span> to <span class="math inline">\(\mathcal{V}\)</span>: <span class="math display">\[
  U W^* = \sum_{k=1}^n u_k w_k^*.
\]</span> In Julia, we can write this mapping as</p>
<div id="8c705ee1" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">UWdemo</span>(p) <span class="op">=</span> <span class="fu">Udemo*</span>(Wdemo<span class="op">.*</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>UWdemo (generic function with 1 method)</code></pre>
</div>
</div>
<p>These two compositions correspond respectively to the <em>inner product</em> and <em>outer product</em> interpretations of matrix-matrix multiplication.</p>
</section>
<section id="infinite-quasimatrices" class="level4" data-number="4.1.4.4">
<h4 data-number="4.1.4.4" class="anchored" data-anchor-id="infinite-quasimatrices"><span class="header-section-number">4.1.4.4</span> Infinite quasimatrices</h4>
<p>We may (rarely) discuss “infinite” quasimatrices with a countable number of columns. We will be analysts about it instead of algebraists. In the case of column quasimatrices:</p>
<ul>
<li><p>We assume the columns lie in some complete vector space.</p></li>
<li><p>When we take a linear combination <span class="math inline">\(Uc\)</span>, we assume the sequence <span class="math inline">\(c\)</span> is restricted to make sense of <span class="math display">\[
  Uc = \lim_{n\rightarrow \infty} U_{:,1:n} c_{1:n}.
\]</span> Usually, this will mean <span class="math inline">\(c\)</span> is bounded (<span class="math inline">\(\ell^\infty\)</span>), absolutely summable (<span class="math inline">\(\ell^1\)</span>), or absolutely square summable (<span class="math inline">\(\ell^2\)</span>).</p></li>
<li><p>We take the “range” of such a quasimatrix to be the set of allowed limits of linear combinations.</p></li>
</ul>
<p>We can similarly define infinite versions of row-wise quasimatrices.</p>
</section>
</section>
<section id="bases" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="bases"><span class="header-section-number">4.1.5</span> Bases</h3>
<p>A <em>basis set</em> for a finite-dimensional vector space <span class="math inline">\(\mathcal{V}\)</span> is a finite set <span class="math inline">\(S \subset \mathcal{V}\)</span> that spans <span class="math inline">\(\mathcal{V}\)</span> and whose elements are linearly independent — that is, no nonzero linear combination of entries of <span class="math inline">\(S\)</span> is equal to zero. We can equivalently define a <em>basis quasimatrix</em> <span class="math inline">\(U\)</span> such that <span class="math inline">\(\mathcal{R}(U) = \mathcal{V}\)</span> and the mapping <span class="math inline">\(c
\mapsto Uc\)</span> is one-to-one. That is, we think of a basis quasimatrix as an invertible linear mapping from a concrete vector space <span class="math inline">\(\mathbb{F}^n\)</span> to an abstract space <span class="math inline">\(\mathcal{V}\)</span>. While we may refer to either the set or the quasimatrix as “a basis” when terminology is unambiguous, by default we use quasimatrices.</p>
<p>Thinking of dual spaces as consisting of rows, we generally represent the basis of <span class="math inline">\(\mathcal{V}^*\)</span> by a row quasimatrix <span class="math inline">\(W^*\)</span>. The map <span class="math inline">\(d^* \mapsto d^* W^*\)</span> is then an invertible linear map from the set of concrete row vectors wo <span class="math inline">\(\mathcal{V}^*\)</span>. If <span class="math inline">\(U\)</span> and <span class="math inline">\(W^*\)</span> are bases of <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{V}^*\)</span>, the matrix <span class="math inline">\(X = W^* U\)</span> represents the composition of two invertible maps (from <span class="math inline">\(\mathbb{F}^n\)</span> to <span class="math inline">\(\mathcal{V}\)</span> and back via the two bases), and so is invertible. The map <span class="math inline">\(U^{-1} =
X^{-1} W^*\)</span> is the dual basis associated with <span class="math inline">\(U\)</span>, which satisfies that <span class="math inline">\(U^{-1} U\)</span> is the <span class="math inline">\(n\)</span>-by-<span class="math inline">\(n\)</span> identity matrix and <span class="math inline">\(U
U^{-1}\)</span> is the identity map on <span class="math inline">\(\mathcal{V}\)</span>.</p>
<p>If <span class="math inline">\(U\)</span> and <span class="math inline">\(\hat{U} = UX\)</span> are two bases for <span class="math inline">\(\mathcal{V}\)</span>, a vector can be written as <span class="math inline">\(v = Uc\)</span> or <span class="math inline">\(v = \hat{U} \hat{c}\)</span> where <span class="math inline">\(\hat{c} =
X^{-1} c\)</span>. Because we use <span class="math inline">\(X\)</span> to change from the <span class="math inline">\(U\)</span> basis to the <span class="math inline">\(\hat{U}\)</span> basis and use <span class="math inline">\(X^{-1}\)</span> to change from the <span class="math inline">\(c\)</span> coefficients to the <span class="math inline">\(\hat{c}\)</span> coefficients, we say the coefficient vector is <em>contravariant</em> (it changes in contrast to the basis). In contrast, an abstract dual vector <span class="math inline">\(w^* \in \mathcal{V}^*\)</span> can be written in terms of the <span class="math inline">\(U\)</span> and <span class="math inline">\(\hat{U}\)</span> vectors with the concrete row vectors <span class="math inline">\(d^* = w^*
U\)</span> or <span class="math inline">\(\hat{d}^* = w^* \hat{U} = d^* X\)</span>. Because the transformations from <span class="math inline">\(U\)</span> to <span class="math inline">\(\hat{U}\)</span> and from <span class="math inline">\(d^*\)</span> to <span class="math inline">\(\hat{d}^*\)</span> both involve the same operation with <span class="math inline">\(X\)</span>, we say these coefficient vector is <em>covariant</em> (it changes together with the basis).</p>
<section id="component-conventions" class="level4" data-number="4.1.5.1">
<h4 data-number="4.1.5.1" class="anchored" data-anchor-id="component-conventions"><span class="header-section-number">4.1.5.1</span> Component conventions</h4>
<p>We will generally follow the convention common in many areas of numerical analysis: a vector <span class="math inline">\(v \in \mathcal{V}\)</span> is associated with a column, a dual vector <span class="math inline">\(w^* \in \mathcal{V}^*\)</span> is associated with a row, and writing a dual vector followed by a vector (<span class="math inline">\(w^* v\)</span>) indicates evaluation. However, there are some shortcomings to this convention, such as situations where we want to apply a dual vector to a vector but some other notational convention prevents us from writing the two symbols adjacent to each other. This issue becomes particularly obvious in multilinear algebra (tensor algebra), as we will see in <a href="#sec-tensor-bg-sec" class="quarto-xref"><span>Section 4.5</span></a>.</p>
<p>An alternate convention that addresses some of these issues is frequently used in areas of physics where tensors are particularly common. In this convention (“Einstein notation”), vectors with respect to a basis <span class="math display">\[
  V = \begin{bmatrix} \mathbf{v}_1 &amp; \ldots &amp; \mathbf{v}_n \end{bmatrix}
\]</span> are written as <span class="math display">\[
  \mathbf{v} = \mathbf{v}_i c^i
\]</span> where the <em>summation convention</em> is in effect, i.e.&nbsp;there is an implicit summation over repeated indices. Dual vectors are written with respect to the basis <span class="math display">\[
  V^{-1} = \begin{bmatrix} \mathbf{w}^1 \\ \vdots \\ \mathbf{w}^n \end{bmatrix}
\]</span> as <span class="math display">\[
  \mathbf{w}^* = d_i \mathbf{w}^i.
\]</span> Therefore <span class="math display">\[
  \mathbf{w}^* \mathbf{v} = d_i c^i.
\]</span> Note that ordering of the symbols in the product makes no difference in this notation: <span class="math inline">\(d_i c^i\)</span> and <span class="math inline">\(c^i d_i\)</span> indicate the same scalar value.</p>
<p>The convention of using subscripts to denote vector coefficients (contravariant coefficients) and superscripts to denote dual coefficients (covariant coefficients) gives us a mechanism for “type checking” expressions: summation over a repeated index should involve one superscript (a covariant index) and one subscript (a contravariant index). At the same time, many authors who follow the summation convention only use subscript indices in order to save the superscript space for other purposes. <em>Caveat lector</em>!<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>Indices are useful for matching functions (dual vectors) and arguments (vectors) without explicit reference to position in an expression. At the same time, indicial notation presumes a basis, with particularly basis-centric authors sometimes writing statements like “a vector is an array that transforms like a vector.” While we usually use bases in our computation, we prefer a basis-independent perspective for mathematical arguments when possible. With this said, we will revert to indicial notation when the situation merits it.</p>
</section>
<section id="polynomial-bases" class="level4" data-number="4.1.5.2">
<h4 data-number="4.1.5.2" class="anchored" data-anchor-id="polynomial-bases"><span class="header-section-number">4.1.5.2</span> Polynomial bases</h4>
<p>As an example of different choices of bases, we consider the polynomial spaces <span class="math inline">\(\mathcal{P}_d\)</span>. A common choice of basis for <span class="math inline">\(\mathcal{P}_d\)</span> is the <em>power basis</em> <span class="math display">\[
  X_{0:d} = \begin{bmatrix} 1 &amp; x &amp; x^2 &amp; \ldots &amp; x^d \end{bmatrix}.
\]</span> That is, we write polynomials <span class="math inline">\(p \in \mathcal{P}_d\)</span> in terms of the basis as <span class="math display">\[
  p = X_{0:d} c = \sum_{j=0}^d c_j x^j.
\]</span> A common basis for <span class="math inline">\(\mathcal{P}_d^*\)</span> is a basis of point evaluation functionals, i.e. <span class="math display">\[
  Y^* p = \begin{bmatrix} p(x_0) \\ p(x_1) \\ \vdots \\ p(x_d) \end{bmatrix}
\]</span> for distinct points <span class="math inline">\(x_0, x_1, \ldots, x_d\)</span>. The matrix <span class="math inline">\(Y^* X_{0:d}\)</span> is the <a href="https://en.wikipedia.org/wiki/Vandermonde_matrix"><em>Vandermonde</em> matrix</a> <span class="math display">\[
  V = \begin{bmatrix}
  1 &amp; x_0 &amp; x_0^2 &amp; \ldots &amp; x_0^d \\
  1 &amp; x_1 &amp; x_1^2 &amp; \ldots &amp; x_1^d \\
  1 &amp; x_2 &amp; x_2^2 &amp; \ldots &amp; x_2^d \\
  \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  1 &amp; x_d &amp; x_d^2 &amp; \ldots &amp; x_d^d
  \end{bmatrix}.
\]</span> The basis <span class="math inline">\(V^{-1} W^*\)</span> is the dual basis associated with the monomial basis. For example, for quartic polynomials with equally spaced polynomials on <span class="math inline">\([-1, 1]\)</span>, we can write</p>
<div id="d64be003" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">1.0</span>; <span class="fl">2.0</span>; <span class="fl">3.0</span>; <span class="fl">4.0</span>; <span class="fl">5.0</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, length<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> [xi<span class="op">^</span>j for xi <span class="kw">in</span> X, j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span>]</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="fu">V\p</span>.(X)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>5-element Vector{Float64}:
 1.0
 2.0
 3.0
 4.0
 5.0</code></pre>
</div>
</div>
<p>That is, if <span class="math inline">\(p(x) = c_0 + c_1 x + c_2 x^2 + c_3 x^3 + c_4 x^4\)</span>, and let <span class="math inline">\(p_X\)</span> denote the vector of samples <span class="math inline">\(p(-1), p(-0.5), p(0), p(0.5),
p(1)\)</span>, then <span class="math inline">\(c = V^{-1} p_X\)</span>. This is, alas, not a particularly good numerical approach to recovering a polynomial from point values, a topic that we will return to in <a href="../01-Fund1d/03-Approximation.html" class="quarto-xref"><span>Chapter 10</span></a>.</p>
<p>The power basis is not the only basis for <span class="math inline">\(\mathcal{P}_d\)</span>. Other common choices include Newton or Lagrange polynomials with respect to a set of points. Along with Vandermonde matrices, we will discuss these topics in <a href="../01-Fund1d/03-Approximation.html" class="quarto-xref"><span>Chapter 10</span></a>. We will sometimes use the (first kind) Chebyshev<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> polynomial basis <span class="math inline">\(T_{0:d}\)</span> with columns <span class="math inline">\(T_0(x), \ldots, T_d(x)\)</span> given by the recurrence <span class="math display">\[\begin{aligned}
  T_0(x) &amp;= 1 \\
  T_1(x) &amp;= x \\
  T_{j+1}(x) &amp;= 2 x T_{j}(x) - T_{j-1}(x), \quad j \geq 1.
\end{aligned}\]</span> The Chebyshev polynomials can also be written on <span class="math inline">\([-1, 1]\)</span> in terms of trigonometric functions: <span class="math display">\[
  T_m(\cos(\theta)) = \cos(m \theta).
\]</span> This connection between Chebyshev polynomials and trigonometric functions is part of their utility, and allows us to use transform methods for working with Chebyshev polynomials (<a href="../02-NLA/04-Signals.html" class="quarto-xref"><span>Chapter 19</span></a>).</p>
<p>The related second kind Chebyshev polynomial basis <span class="math inline">\(U_{0:d}\)</span> satisfies <span class="math display">\[\begin{aligned}
U_0(x) &amp;= 1 \\
U_1(x) &amp;= 2x \\
U_{j+1}(x) &amp;= 2x U_j(x) - U_{j-1}(x), \quad j \geq 1.
\end{aligned}\]</span> These polynomials satisfy <span class="math display">\[
  U_m(\cos(\theta)) \sin(\theta) = \sin(m \theta).
\]</span> These polynomials are useful in part because of the derivative relationship <span class="math inline">\(T_m'(x) = m U_{m-1}(x)\)</span>.</p>
<p>In matrix terms, we can write the relationship between the Chebyshev polynomials and the power basis as <span class="math inline">\(T_{0:d} = X_{0:d} M\)</span> where the matrix <span class="math inline">\(M\)</span> is computed via the three-term recurrence:</p>
<div id="6a9a845a" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">chebyshev_power_coeffs</span>(d, kind<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">max</span>(d<span class="op">+</span><span class="fl">1</span>, <span class="fl">2</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="fu">zeros</span>(n, n)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    M[<span class="fl">1</span>,<span class="fl">1</span>] <span class="op">=</span> <span class="fl">1</span>                          <span class="co"># p0(x) = 1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    M[<span class="fl">2</span>,<span class="fl">2</span>] <span class="op">=</span> kind                       <span class="co"># p1(x) = kind*x</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">2</span><span class="op">:</span>d                         <span class="co"># p_{j+1}(x) =</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        M[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,j<span class="op">+</span><span class="fl">1</span>] <span class="op">.=</span> <span class="fl">2</span><span class="op">*</span>M[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>,j]  <span class="co">#   2x p_j(x)</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        M[<span class="op">:</span>,j<span class="op">+</span><span class="fl">1</span>] <span class="op">.-=</span> M[<span class="op">:</span>,j<span class="op">-</span><span class="fl">1</span>]           <span class="co">#   -p_{j-1}(x)</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">UpperTriangular</span>(M[<span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>])</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>chebyshev_power_coeffs (generic function with 2 methods)</code></pre>
</div>
</div>
<p>For example, for the quadratic case, we have</p>
<div id="9df44f05" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chebyshev_power_coeffs</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>3×3 UpperTriangular{Float64, Matrix{Float64}}:
 1.0  0.0  -1.0
  ⋅   1.0   0.0
  ⋅    ⋅    2.0</code></pre>
</div>
</div>
<p>and the coefficient vectors <span class="math inline">\(d\)</span> and <span class="math inline">\(c\)</span> with respect to the Chebyshev and power bases are such that <span class="math inline">\(p = T_{0:d} d = X_{0:d} Md = X_{0:d} c\)</span>, so <span class="math inline">\(Md = c\)</span>. For example, to write the polynomial <span class="math inline">\(p(x) = 2 - 3x + x^2\)</span> in the Chebyshev basis, we solve the triangular linear system:</p>
<div id="34e6d6b0" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chebyshev_power_coeffs</span>(<span class="fl">2</span>) <span class="op">\</span> [<span class="fl">2.0</span>; <span class="op">-</span><span class="fl">3.0</span>; <span class="fl">1.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>3-element Vector{Float64}:
  2.5
 -3.0
  0.5</code></pre>
</div>
</div>
<p>If we would like to form a representation of the Chebyshev basis, we could use the power basis expansion</p>
<div id="2b559605" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">chebyshev_basis</span>(d, kind<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="fu">chebyshev_power_coeffs</span>(d, kind)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transpose</span>([<span class="fu">Polynomial</span>(M[<span class="fl">1</span><span class="op">:</span>j,j]) for j<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>])</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chebyshev_basis</span>(<span class="fl">2</span>)           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>1×3 transpose(::Vector{Polynomial{Float64, :x}}) with eltype Polynomial{Float64, :x}:
 Polynomial(1.0)  Polynomial(1.0*x)  Polynomial(-1.0 + 2.0*x^2)</code></pre>
</div>
</div>
<p>However, the Chebyshev polynomials are natively supported in the <code>Polynomials.jl</code> package, and we can explicitly write polynomials in terms of Chebyshev polynomials. For example,</p>
<div id="0d8172c0" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ChebyshevT</span>([<span class="fl">2.5</span>, <span class="op">-</span><span class="fl">3.0</span>, <span class="fl">0.5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
2.5⋅T_0(x) - 3.0⋅T_1(x) + 0.5⋅T_2(x)
</div>
</div>
<div id="e806a65f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">convert</span>(Polynomial, <span class="fu">ChebyshevT</span>([<span class="fl">2.5</span>, <span class="op">-</span><span class="fl">3.0</span>, <span class="fl">0.5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
2.0 - 3.0∙x + 1.0∙x<sup>2</sup>
</div>
</div>
<p>The coefficients satisfy exactly the equations from above.</p>
<p>The bases <span class="math inline">\(T_{0:d}\)</span> and <span class="math inline">\(U_{0:d}\)</span> are also both bases for <span class="math inline">\(\mathcal{P}_d\)</span>, so there must be a change of basis matrix that converts between the two. We can look up or derive that <span class="math display">\[
  T_n(x) = \frac{1}{2} \left( U_n(x) - U_{n-2}(x) \right),
\]</span> or, in terms of a matrix representation of the change of basis, <span class="math display">\[
  T_{0:d} = U_{0:d} B
\]</span> where <span class="math inline">\(B\)</span> is the upper triangular matrix <span class="math display">\[
  B =
  \begin{bmatrix}
  1 &amp;             &amp; -\frac{1}{2} \\
    &amp; \frac{1}{2} &amp;              &amp; -\frac{1}{2} \\
    &amp;             &amp; \frac{1}{2}  &amp;              &amp; \ddots \\
    &amp;             &amp;              &amp; \frac{1}{2}  &amp; \ddots &amp; -\frac{1}{2} \\
    &amp;             &amp;              &amp;              &amp; \ddots &amp; \\
    &amp;             &amp;              &amp;              &amp;        &amp; \frac{1}{2}
  \end{bmatrix}.
\]</span> Alternately, in code we have</p>
<div id="31c14f30" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">change_U_to_T</span>(d)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> <span class="fu">Matrix</span>(<span class="fl">0.5</span><span class="op">*</span>I, d<span class="op">+</span><span class="fl">1</span>, d<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    B[<span class="fl">1</span>,<span class="fl">1</span>] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">3</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        B[j<span class="op">-</span><span class="fl">2</span>,j] <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    B</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>change_U_to_T (generic function with 1 method)</code></pre>
</div>
</div>
<p>That is, we should have</p>
<div id="8085e244" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chebyshev_basis</span>(<span class="fl">5</span>) <span class="op">==</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chebyshev_basis</span>(<span class="fl">5</span>,<span class="fl">2</span>) <span class="op">*</span> <span class="fu">change_U_to_T</span>(<span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>true</code></pre>
</div>
</div>
<p>In addition to the Chebyshev polynomials, we will sometimes want the Legendre polynomial basis <span class="math inline">\(P_{0:d}(x)\)</span> with columns <span class="math inline">\(P_j(x)\)</span> given by the recurrence <span class="math display">\[\begin{aligned}
  P_0(x) &amp;= 1 \\
  P_1(x) &amp;= x \\
  (j+1) P_{j+1}(x) &amp;= (2j+1) x P_j(x) - j P_{j-1}(x).
\end{aligned}\]</span> As with the Chebyshev polynomials, we can define an upper triangular matrix whose columns are coefficients for the Legendre polynomials in the power basis:</p>
<div id="ef8e4de9" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">legendre_power_coeffs</span>(d)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">max</span>(d<span class="op">+</span><span class="fl">1</span>, <span class="fl">2</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="fu">zeros</span>(n, n)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    M[<span class="fl">1</span>,<span class="fl">1</span>] <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    M[<span class="fl">2</span>,<span class="fl">2</span>] <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">2</span><span class="op">:</span>d</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>        M[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>,j<span class="op">+</span><span class="fl">1</span>] <span class="op">.=</span> (<span class="fl">2</span><span class="op">*</span>j<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>M[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>,j]</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        M[<span class="op">:</span>,j<span class="op">+</span><span class="fl">1</span>] <span class="op">.-=</span> (j<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>M[<span class="op">:</span>,j<span class="op">-</span><span class="fl">1</span>]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        M[<span class="op">:</span>,j<span class="op">+</span><span class="fl">1</span>] <span class="op">./=</span> j</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">UpperTriangular</span>(M[<span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>])</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>legendre_power_coeffs (generic function with 1 method)</code></pre>
</div>
</div>
<p>If we want a representation in terms of a list of <code>Polynomial</code> objects (representing the basis polynomials), we can simply convert the columns:</p>
<div id="ceb09dfb" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">legendre_basis</span>(d)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="fu">legendre_power_coeffs</span>(d)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transpose</span>([<span class="fu">Polynomial</span>(M[<span class="fl">1</span><span class="op">:</span>j,j]) for j<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>])</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legendre_basis</span>(<span class="fl">2</span>)           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>1×3 transpose(::Vector{Polynomial{Float64, :x}}) with eltype Polynomial{Float64, :x}:
 Polynomial(1.0)  Polynomial(1.0*x)  Polynomial(-0.5 + 1.5*x^2)</code></pre>
</div>
</div>
<p>Each basis we have discussed has a different use case. Sometimes the “obvious” choice of basis (e.g.&nbsp;the standard basis in <span class="math inline">\(\mathbb{R}^n\)</span> or the power basis in <span class="math inline">\(\mathcal{P}_d\)</span>) is not the best choice for numerical computations.</p>
</section>
<section id="block-bases" class="level4" data-number="4.1.5.3">
<h4 data-number="4.1.5.3" class="anchored" data-anchor-id="block-bases"><span class="header-section-number">4.1.5.3</span> Block bases</h4>
<p>Consider the direct sum <span class="math display">\[
  \mathcal{V}= \mathcal{U}_1 \oplus \mathcal{U}_2 \oplus \ldots \oplus \mathcal{U}_p.
\]</span> Given basis quasimatrices <span class="math inline">\(U_j\)</span> for the spaces <span class="math inline">\(\mathcal{U}_j\)</span>, there is an associated basis quasimatrix <span class="math inline">\(V\)</span> for <span class="math inline">\(\mathcal{V}\)</span> defined by horizontal concatenation: <span class="math display">\[
  V = \begin{bmatrix} U_1 &amp; U_2 &amp; \ldots &amp; U_p \end{bmatrix}.
\]</span> Conversely, we can think of partitioning the columns of a basis <span class="math inline">\(V\)</span> for <span class="math inline">\(\mathcal{V}\)</span> into disjoint subsets; then each subset is itself a basis for some subspace, and <span class="math inline">\(\mathcal{V}\)</span> is a direct sum of those subspaces. This sort of “block thinking” will generally be useful in our treatment of numerical linear algebra.</p>
</section>
<section id="infinite-bases" class="level4" data-number="4.1.5.4">
<h4 data-number="4.1.5.4" class="anchored" data-anchor-id="infinite-bases"><span class="header-section-number">4.1.5.4</span> Infinite bases</h4>
<p>The notion of a basis can be generalized to the case of an infinite-dimensional space <span class="math inline">\(\mathcal{V}\)</span> in two ways. The algebraists version (the <em>Hamel basis</em>) is a set of linearly independent vectors such that any vector is a <em>finite</em> linear combination of basis vectors. Such a basis always exists if we assume the axiom of choice, but is not particularly useful for our purposes. More useful for topics such as approximation theory and probability is the analyst’s notion of a basis: an infinite quasimatrix that represents a map between some sequence space (e.g.&nbsp;<span class="math inline">\(\ell^1\)</span>, <span class="math inline">\(\ell^2\)</span>, or <span class="math inline">\(\ell^\infty\)</span>) and an abstract vector space.</p>
</section>
</section>
<section id="vector-norms" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" class="anchored" data-anchor-id="vector-norms"><span class="header-section-number">4.1.6</span> Vector norms</h3>
<p>A <em>norm</em> <span class="math inline">\(\|\cdot\|\)</span> measures vector lengths. It is positive definite, (absolutely) homogeneous, and sub-additive: <span class="math display">\[\begin{aligned}
  \|v\| &amp; \geq 0 \mbox{ and } \|v\| = 0 \mbox{ iff } v = 0 \\
  \|\alpha v\| &amp;= |\alpha| \|v\| \\
  \|u+v\| &amp; \leq \|u\| + \|v\|.
\end{aligned}\]</span> The three most common vector norms we work with in <span class="math inline">\(\mathbb{R}^n\)</span> are the Euclidean norm (aka the 2-norm), the <span class="math inline">\(\infty\)</span>-norm (or max norm), and the <span class="math inline">\(1\)</span>-norm: <span class="math display">\[\begin{aligned}
  \|v\|_2 &amp;= \sqrt{\sum_j |v_j|^2} \\
  \|v\|_\infty &amp;= \max_j |v_j| \\
  \|v\|_1 &amp;= \sum_j |v_j|
\end{aligned}\]</span> These are all available via Julia’s <code>norm</code> function:</p>
<div id="29af43da" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="fl">3.0</span>; <span class="fl">4.0</span>]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(x),      <span class="co"># Euclidean norm (also written norm(x,2))</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(x,<span class="cn">Inf</span>),  <span class="co"># Max norm</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(x,<span class="fl">1</span>)     <span class="co"># 1-norm</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(5.0, 4.0, 7.0)</code></pre>
</div>
</div>
<p>Many other norms can be related to one of these three norms. In particular, a “natural” norm in an abstract vector space will often look strange in the corresponding concrete representation with respect to some basis function. For example, consider the vector space of polynomials with degree at most 2 on <span class="math inline">\([-1,1]\)</span>. This space also has a natural Euclidean norm, max norm, and <span class="math inline">\(1\)</span>-norm; for a given polynomial <span class="math inline">\(p(x)\)</span> these are <span class="math display">\[\begin{aligned}
  \|p\|_2 &amp;= \sqrt{ \int_{-1}^1 |p(x)|^2 \, dx } \\
  \|p\|_\infty &amp;= \max_{x \in [-1,1]} |p(x)| \\
  \|p\|_1 &amp;= \int_{-1}^1 |p(x)| \, dx.
\end{aligned}\]</span> These norms are not built into the <code>Polynomials</code> package, but they are not difficult to compute for real polynomials:</p>
<div id="0dce16aa" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">real_roots</span>(p) <span class="op">=</span> <span class="fu">sort</span>(<span class="fu">real</span>(<span class="fu">filter</span>(isreal, <span class="fu">roots</span>(p))))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">real_roots</span>(p, a, b) <span class="op">=</span> <span class="fu">filter</span>(x <span class="op">-&gt;</span> (a <span class="op">&lt;=</span> x <span class="op">&lt;=</span> b),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">real_roots</span>(p))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">normL2</span>(p) <span class="op">=</span> <span class="fu">sqrt</span>(<span class="fu">integrate</span>(p<span class="op">*</span>p, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">normL∞</span>(p)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> [<span class="op">-</span><span class="fl">1.0</span>; <span class="fu">real_roots</span>(<span class="fu">derivative</span>(p), <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>); <span class="fl">1.0</span>]</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maximum</span>(<span class="fu">abs</span>.(<span class="fu">p</span>.(nodes)))</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">normL1</span>(p)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> [<span class="op">-</span><span class="fl">1.0</span>; <span class="fu">real_roots</span>(p, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>); <span class="fl">1.0</span>]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">integrate</span>(p, nodes[j], nodes[j<span class="op">+</span><span class="fl">1</span>]))</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(nodes)<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">normL2</span>(p),</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">normL∞</span>(p),</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">normL1</span>(p)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(0.483045891539648, 0.5, 0.60947570824873)</code></pre>
</div>
</div>
<p>The same norms can also be approximated from samples using the midpoint rule (<span class="quarto-unresolved-ref">?sec-quad-diff-ch</span>):</p>
<div id="63bf0186" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">1.0</span>, <span class="fl">1.0</span>, length<span class="op">=</span>n<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> (X[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>] <span class="op">+</span> X[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>])<span class="op">/</span><span class="fl">2</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    pX <span class="op">=</span> <span class="fu">p</span>.(X)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(pX)<span class="fu">*sqrt</span>(<span class="fl">2</span><span class="op">/</span>n),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(pX, <span class="cn">Inf</span>),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">norm</span>(pX, <span class="fl">1</span>)<span class="op">*</span><span class="fl">2</span><span class="op">/</span>n</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(0.48297688971626773, 0.4999, 0.6093599999999999)</code></pre>
</div>
</div>
<p>Of course, when we write <span class="math inline">\(p(x)\)</span> in terms of the coefficient vector with respect to the power basis (for example), the max norm of the polynomial is not the same as the max norm of the coefficient vector.</p>
<p>In a finite-dimensional vector space, all norms are <em>equivalent</em>: that is, if <span class="math inline">\(\|\cdot\|\)</span> and <span class="math inline">\({\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert \cdot
    \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}\)</span> are two norms on the same finite-dimensional vector space, then there exist constants <span class="math inline">\(c\)</span> and <span class="math inline">\(C\)</span> such that for any <span class="math inline">\(v\)</span> in the space, <span class="math display">\[
  c \|v\| \leq {\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert v
    \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert} \leq C \|v\|.
\]</span> Of course, there is no guarantee that the constants are small! In infinite-dimensional spaces, not all norms are equivalent.</p>
<p>A normed vector space is a metric space, and so we can use it to define things like Cauchy sequences and limits. In a finite-dimensional normed space, any Cauchy sequence <span class="math inline">\(\{v_k\}_{k=1^\infty}\)</span> in a finite-dimensional vector space <span class="math inline">\(\mathcal{V}\)</span> converges to a limit <span class="math inline">\(v_* \in \mathcal{V}\)</span>. A normed infinite-dimensional vector space where Cauchy sequences converge (i.e.&nbsp;a space that is complete under the norm) is called a <em>Banach space</em>.</p>
<p>For any Banach space <span class="math inline">\(\mathcal{V}\)</span>, we can define the <em>dual norm</em> for continuous functionals <span class="math inline">\(w^*\)</span> in the dual space <span class="math inline">\(\mathcal{V}^*\)</span> by <span class="math display">\[
  \|w^*\| = \sup_{v \neq 0} \frac{w^* v}{\|v\|} = \sup_{\|v\| = 1} w^* v.
\]</span> In the finite-dimensional case, the supremum is always achieved, i.e. for any <span class="math inline">\(w^*\)</span> there exists a <span class="math inline">\(v\)</span> of unit norm (<span class="math inline">\(\|v\|=1\)</span>) such that <span class="math inline">\(w^* v =
\|w^*\|\)</span>. Conversely, for any <span class="math inline">\(v\)</span> there exists a <span class="math inline">\(w^*\)</span> of unit norm such that <span class="math inline">\(w^* v = \|v\|\)</span>. The <span class="math inline">\(\infty\)</span>-norm and the <span class="math inline">\(1\)</span>-norm are dual norms of each other, and the Euclidean norm is its own dual.</p>
</section>
<section id="sec-la-bg-inner-product" class="level3" data-number="4.1.7">
<h3 data-number="4.1.7" class="anchored" data-anchor-id="sec-la-bg-inner-product"><span class="header-section-number">4.1.7</span> Inner products</h3>
<p>An <em>inner product</em> <span class="math inline">\(\langle \cdot, \cdot \rangle\)</span> is a function from two vectors into the real numbers (or complex numbers for an complex vector space). It is positive definite, linear in the first slot, and symmetric (or Hermitian in the case of complex vectors); that is: <span class="math display">\[\begin{aligned}
  \langle v, v \rangle &amp; \geq 0 \mbox{ and }
  \langle v, v \rangle = 0 \mbox{ iff } v = 0 \\
  \langle \alpha u, w \rangle &amp;= \alpha \langle u, w \rangle
  \mbox{ and }
  \langle u+v, w \rangle = \langle u, w \rangle + \langle v, w \rangle \\
  \langle u, v \rangle &amp;= \overline{\langle v, u \rangle},
\end{aligned}\]</span> where the overbar in the latter case corresponds to complex conjugation. The <em>standard inner product</em> on <span class="math inline">\(\mathbb{C}^n\)</span> is <span class="math display">\[
  x \cdot y = y^* x = \sum_{j=1}^n \bar{y}_j x_j.
\]</span> A vector space with an inner product is sometimes called an <em>inner product space</em> or a <em>Euclidean space</em>.</p>
<section id="the-riesz-map" class="level4" data-number="4.1.7.1">
<h4 data-number="4.1.7.1" class="anchored" data-anchor-id="the-riesz-map"><span class="header-section-number">4.1.7.1</span> The Riesz map</h4>
<p>The inner product defines an (anti)linear map (the <em>Riesz map</em>) from vectors <span class="math inline">\(v\)</span> to dual vectors <span class="math inline">\(v^*\)</span> via <span class="math inline">\(v^* u = \langle u, v \rangle\)</span>. In terms of the Julia code in this chapter,</p>
<div id="cd4aaeca" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">riesz</span>(dot) <span class="op">=</span> v <span class="op">-&gt;</span> <span class="fu">DualVector</span>(u <span class="op">-&gt;</span> <span class="fu">dot</span>(u, v))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>According to the <em>Riesz representation theorem</em>, in finite-dimensional spaces, this defines a 1-1 correspondence between vectors and dual vectors. For <span class="math inline">\(\mathbb{R}^n\)</span> or <span class="math inline">\(\mathbb{C}^n\)</span> under the standard inner product, the Riesz map is simply the (conjugate) transpose: <span class="math display">\[
  \begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n \end{bmatrix} \mapsto
  \begin{bmatrix} \bar{c}_1 &amp; \bar{c}_2 &amp; \ldots &amp; \bar{c}_n \end{bmatrix}.
\]</span> Going beyond single vectors at a time, we can think of the Riesz map as inducing a mapping from colum quasimatrices to row quasimatrices.</p>
<p>In infinite-dimensional inner product spaces, we have a 1-1 correspondence between vectors and <em>continuous</em> dual vectors (which is all dual vectors for a <em>complete</em> inner product space). A (not-necessarily finite-dimensional) Euclidean space that is complete under the Euclidean norm is called a <em>Hilbert space</em>.</p>
</section>
<section id="the-gram-matrix" class="level4" data-number="4.1.7.2">
<h4 data-number="4.1.7.2" class="anchored" data-anchor-id="the-gram-matrix"><span class="header-section-number">4.1.7.2</span> The Gram matrix</h4>
<p>Suppose <span class="math inline">\(\mathcal{V}\)</span> is an arbitrary space with an inner product and <span class="math inline">\(V\)</span> is a basis for that space. Then for vectors expressed in that basis, the inner product is <span class="math display">\[\begin{aligned}
  \langle Vc, Vd \rangle
  &amp;= \left\langle \sum_j v_j c_j, \sum_i v_i d_i \right\rangle \\
  &amp;= \sum_{i,j} \bar{d}_i c_j \langle v_j, v_i \rangle \\
  &amp;= d^* M c = \langle c, d \rangle_M,
\end{aligned}\]</span> where <span class="math inline">\(M = V^* V\)</span> is the <em>Gram matrix</em> whose entries are inner products of basis elements. In Julia code, we have</p>
<div id="21a300c9" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram</span>(dot, V) <span class="op">=</span> <span class="fu">Symmetric</span>([<span class="fu">dot</span>(vj, vi) for vi <span class="kw">in</span> V[<span class="op">:</span>], vj <span class="kw">in</span> V[<span class="op">:</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Gram matrix is Hermitian and (because <span class="math inline">\(V\)</span> is a basis) positive definite. We call the expression <span class="math inline">\(d^* M c\)</span> the <span class="math inline">\(M\)</span>-inner product between the concrete vectors <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>.</p>
<p>We can also write the Riesz map in terms of <span class="math inline">\(V\)</span> and <span class="math inline">\(M\)</span>. Given <span class="math inline">\(w^* \in \mathcal{V}^*\)</span>, the Riesz map is <span class="math inline">\(w = V M^{-1} (w^* V)^*\)</span>; we can verify this based on the expression of the <span class="math inline">\(\mathcal{V}\)</span>-inner product as an <span class="math inline">\(M\)</span>-inner product over coefficient vectors: <span class="math display">\[
  \langle u, w \rangle =
  \langle V^{-1} u, M^{-1} (w^* V)^* \rangle =
  w^* V M^{-*} M V^{-1} u = w^* u.
\]</span></p>
</section>
<section id="euclidean-norms" class="level4" data-number="4.1.7.3">
<h4 data-number="4.1.7.3" class="anchored" data-anchor-id="euclidean-norms"><span class="header-section-number">4.1.7.3</span> Euclidean norms</h4>
<p>Every inner product defines a corresponding norm <span class="math display">\[
  \|v\| = \sqrt{ \langle v, v \rangle}.
\]</span> The inner product can also be recovered from the norm. In general, we can expand <span class="math display">\[\begin{aligned}
  \|u+v\|^2
  &amp;= \langle u + v, u + v \rangle \\
  &amp;= \langle u, u \rangle + \langle v, u \rangle + \langle u, v \rangle
     + \langle v, v \rangle \\
  &amp;= \|u\|^2 + 2 \Re \langle u, v \rangle + \|v\|^2
\end{aligned}\]</span> Therefore <span class="math display">\[\begin{aligned}
  \Re \langle u, v \rangle
  &amp;= \frac{1}{2} \left( \|u+v\|^2 - \|u\|^2 - \|v\|^2 \right) \\
  \Im \langle u, v \rangle = \Re \langle u, iv \rangle
  &amp;= \frac{1}{2} \left( \|u+iv\|^2 - \|u\|^2 - \|v\|^2 \right).
\end{aligned}\]</span> Of course, for real vector spaces only the first equation is needed.</p>
</section>
<section id="angles-and-orthogonality" class="level4" data-number="4.1.7.4">
<h4 data-number="4.1.7.4" class="anchored" data-anchor-id="angles-and-orthogonality"><span class="header-section-number">4.1.7.4</span> Angles and orthogonality</h4>
<p>The inner product and the associated norm satisfy the <em>Cauchy-Schwarz</em> inequality <span class="math display">\[
  |\langle u, v \rangle| \leq \|u\| \|v\|.
\]</span> We define the cosine of the angle between nonzero real vectors <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> to be <span class="math display">\[
  \cos \theta = \frac{\langle v, w \rangle}{\|v\| \|w\|}.
\]</span> Because of the Cauchy-Schwarz inequality, the cosine is always at most one in absolute value. For a real inner product space, the expansion of <span class="math inline">\(\|u+v\|^2\)</span> and the definition of the cosine gives us the <em>law of cosines</em>: for any nonzero <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, <span class="math display">\[
  \|u+v\|^2 = \|u\|^2 + 2 \|u\| \|v\| \cos(\theta) + \|v\|^2.
\]</span> We say two vectors <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are <em>orthogonal</em> with respect to an inner product if <span class="math inline">\(\langle u, v \rangle = 0\)</span>. If <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are orthogonal, we have the <em>Pythagorean theorem</em>: <span class="math display">\[
  \|u+v\|^2 = \|u\|^2 + \|v\|^2.
\]</span></p>
<p>If <span class="math inline">\(\mathcal{U}\)</span> is any subspace of an inner product space <span class="math inline">\(\mathcal{V}\)</span>, we can define the <em>orthogonal complement</em> <span class="math inline">\(\mathcal{U}^\perp\)</span>: <span class="math display">\[
  \mathcal{U}^\perp =
  \{ v \in \mathcal{V}: \forall u \in \mathcal{U}, \langle u, v \rangle = 0 \}.
\]</span> We can always write <span class="math inline">\(\mathcal{V}\)</span> as the direct sum <span class="math inline">\(\mathcal{U}\oplus \mathcal{U}^\perp\)</span>. In other words, the orthogonal complement is isomorphic to the quotient space <span class="math inline">\(\mathcal{V}/ \mathcal{U}\)</span>, and in inner product spaces these two are often identified with each other.</p>
<p>Vectors that are mutually orthogonal and have unit length in the Euclidean norm are said to be <em>orthonormal</em>. A basis <span class="math inline">\(V\)</span> for an <span class="math inline">\(n\)</span>-dimensional space <span class="math inline">\(\mathcal{V}\)</span> is an <em>orthonormal basis</em> if all its columns are orthonormal. In this case, <span class="math inline">\(V^* V\)</span> is the <span class="math inline">\(n\)</span>-by-<span class="math inline">\(n\)</span> identity matrix and <span class="math inline">\(V V^*\)</span> is the identity map on <span class="math inline">\(\mathcal{V}\)</span>. That is, for an orthonormal basis quasimatrix, the Riesz map and the dual basis are the same, i.e.&nbsp;<span class="math inline">\(U^* = U^{-1}\)</span>.</p>
</section>
<section id="einstein-notation" class="level4" data-number="4.1.7.5">
<h4 data-number="4.1.7.5" class="anchored" data-anchor-id="einstein-notation"><span class="header-section-number">4.1.7.5</span> Einstein notation</h4>
<p>For physicists working with Einstein notation on real vector spaces, the Gram matrix (aka the <em>metric tensor</em>) is sometimes written in terms of the components <span class="math inline">\(g_{ij} = \langle \mathbf{v}_j, \mathbf{v}_i \rangle\)</span>; the inverse of the Gram matrix is written with components <span class="math inline">\(g^{ij}\)</span>. In this convention, the Riesz map from <span class="math inline">\(\mathcal{V}^*\)</span> to <span class="math inline">\(\mathcal{V}\)</span> is associated with using the metric tensor to “raise an index”: <span class="math display">\[
  v^i = g^{ij} w_j.
\]</span> Conversely, the inverse Riesz map from <span class="math inline">\(\mathcal{V}\)</span> to <span class="math inline">\(\mathcal{V}^*\)</span> is associated with using the metric tensor to “lower an index”: <span class="math display">\[
  w_i = g_{ij} v^j.
\]</span> And the Euclidean norm is written as <span class="math display">\[
  \|\mathbf{v}\|^2 = g_{ij} v^i v^j
\]</span> When an orthonormal basis is used, the Gram matrix is just the identity, and raising or lowering indices appears to be a purely formal matter.</p>
</section>
<section id="the-l2-inner-product" class="level4" data-number="4.1.7.6">
<h4 data-number="4.1.7.6" class="anchored" data-anchor-id="the-l2-inner-product"><span class="header-section-number">4.1.7.6</span> The <span class="math inline">\(L^2\)</span> inner product</h4>
<p>Returning to our example of a vector space of polynomials, the standard <span class="math inline">\(L^2([-1,1])\)</span> inner product is <span class="math display">\[
  \langle p, q \rangle_{L^2([-1,1])} = \int_{-1}^1 p(x) \bar{q}(x) \, dx.
\]</span> In Julia code, we can write this as</p>
<div id="d5e1758b" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dotL2</span>(p, q) <span class="op">=</span> <span class="fu">integrate</span>(<span class="fu">p*conj</span>(q), <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Gram matrix for this inner product with the power basis (using zero-based indexing) is <span class="math display">\[
  a_{ij} = \int_{-1}^1 x^{i-1} x^{j-1} \, dx =
  \begin{cases}
   2/(i+j+1), &amp; i+j \mbox{ even} \\
   0, &amp; \mbox{ otherwise}
  \end{cases}
\]</span> which we can implement in Julia as</p>
<div id="6598ab50" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram_L2_power</span>(d) <span class="op">=</span> [(i<span class="op">+</span>j)<span class="op">%</span><span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span> ? <span class="fl">2.0</span><span class="op">/</span>(i<span class="op">+</span>j<span class="op">+</span><span class="fl">1</span>) <span class="op">:</span> <span class="fl">0.0</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                    for i<span class="op">=</span><span class="fl">0</span><span class="op">:</span>d, j<span class="op">=</span><span class="fl">0</span><span class="op">:</span>d]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example, for quadratics we have</p>
<div id="e0c38854" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram_L2_power</span>(<span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>3×3 Matrix{Float64}:
 2.0       0.0       0.666667
 0.0       0.666667  0.0
 0.666667  0.0       0.4</code></pre>
</div>
</div>
<p>Hence we can compute <span class="math inline">\(\langle 1 + x + x^2, 2 -3x + x^2 \rangle\)</span> either via</p>
<div id="a9320eba" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">1.0</span>; <span class="fl">1.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">2.0</span>; <span class="op">-</span><span class="fl">3.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dotL2</span>(p, q)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>4.4</code></pre>
</div>
</div>
<p>or via</p>
<div id="338e1847" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>[<span class="fl">1.0</span>; <span class="fl">1.0</span>; <span class="fl">1.0</span>]<span class="ch">'*gram_L2_power(2)*[2.0; -3.0; 1.0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>4.3999999999999995</code></pre>
</div>
</div>
<p>For the Chebyshev basis, the Gram matrix has entries <span class="math display">\[
  \int_{-1}^1 T_{i}(x) T_j(x) \, dx.
\]</span> This can also be computed using the relations <span class="math display">\[\begin{aligned}
T_m(x) T_n(x) &amp;= \frac{1}{2} \left( T_{m+n}(x) + T_{|m-n|}(x) \right) \\
\int_{-1}^1 T_n(x) \, dx &amp;=
\begin{cases}
  \frac{2}{1-n^2}, &amp; n \mbox{ even} \\
  0, &amp; n \mbox{ odd}.
\end{cases}
\end{aligned}\]</span></p>
<div id="4fa74445" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">gram_L2_chebyshev</span>(d)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tint</span>(j) <span class="op">=</span> j<span class="op">%</span><span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span> ? <span class="fl">2.0</span><span class="op">/</span>(<span class="fl">1</span><span class="op">-</span>j<span class="op">^</span><span class="fl">2</span>) <span class="op">:</span> <span class="fl">0.0</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">m</span>(i,j) <span class="op">=</span> (<span class="fu">tint</span>(i<span class="op">+</span>j) <span class="op">+</span> <span class="fu">tint</span>(<span class="fu">abs</span>(i<span class="op">-</span>j)))<span class="op">/</span><span class="fl">2.0</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    [<span class="fu">m</span>(i,j) for i<span class="op">=</span><span class="fl">0</span><span class="op">:</span>d, j<span class="op">=</span><span class="fl">0</span><span class="op">:</span>d]</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>gram_L2_chebyshev (generic function with 1 method)</code></pre>
</div>
</div>
<p>For example, the Gram matrix for <span class="math inline">\(T_{0:4}\)</span> is</p>
<div id="1d50525a" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram_L2_chebyshev</span>(<span class="fl">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>5×5 Matrix{Float64}:
  2.0        0.0       -0.666667   0.0       -0.133333
  0.0        0.666667   0.0       -0.4        0.0
 -0.666667   0.0        0.933333   0.0       -0.361905
  0.0       -0.4        0.0        0.971429   0.0
 -0.133333   0.0       -0.361905   0.0        0.984127</code></pre>
</div>
</div>
<p>We can sanity check our integration by comparing to another routine:</p>
<div id="e81ef45d" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram_L2_chebyshev</span>(<span class="fl">4</span>) <span class="op">≈</span> <span class="fu">gram</span>(dotL2, <span class="fu">chebyshev_basis</span>(<span class="fl">4</span>)[<span class="op">:</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>true</code></pre>
</div>
</div>
<p>For the Legendre basis, the Gram matrix is</p>
<div id="9013595a" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gram</span>(dotL2, <span class="fu">legendre_basis</span>(<span class="fl">4</span>)[<span class="op">:</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>5×5 Symmetric{Float64, Matrix{Float64}}:
 2.0  0.0       0.0  0.0       0.0
 0.0  0.666667  0.0  0.0       0.0
 0.0  0.0       0.4  0.0       0.0
 0.0  0.0       0.0  0.285714  0.0
 0.0  0.0       0.0  0.0       0.222222</code></pre>
</div>
</div>
<p>That is, the Gram matrix for the Legendre basis is diagonal, with diagonal entries <span class="math inline">\(2/1, 2/3, 2/5, 2/7, 2/9, \ldots\)</span>. In other words, the Legendre basis vectors are orthogonal with respect to the <span class="math inline">\(L^2([-1,1])\)</span> inner product. The <em>normalized</em> Legendre polynomials are <span class="math display">\[
  \sqrt{\frac{2j+1}{2}} P_j,
\]</span> or, in code</p>
<div id="afbe099b" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normalized_legendre_basis</span>(d) <span class="op">=</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transpose</span>([<span class="fu">sqrt</span>((<span class="fl">2</span>j<span class="op">+</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">2</span>)<span class="op">*</span>Pj</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>               for (Pj,j) <span class="op">=</span> <span class="fu">zip</span>(<span class="fu">legendre_basis</span>(d), <span class="fl">0</span><span class="op">:</span>d)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>normalized_legendre_basis (generic function with 1 method)</code></pre>
</div>
</div>
<p>and these form an orthonormal basis for the <span class="math inline">\(\mathcal{P}_d\)</span> spaces under the <span class="math inline">\(L^2([-1,1])\)</span> inner product. Hence, the Gram matrix for a normalized Legendre basis (using the <span class="math inline">\(L^2([-1,1])\)</span> inner product) is just the identity:</p>
<div id="3a5024f0" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    P̄ <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(<span class="fl">3</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gram</span>(dotL2, P̄)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>4×4 Symmetric{Float64, Matrix{Float64}}:
 1.0  0.0  0.0  0.0
 0.0  1.0  0.0  0.0
 0.0  0.0  1.0  0.0
 0.0  0.0  0.0  1.0</code></pre>
</div>
</div>
<p>Using an orthonormal basis <span class="math inline">\(U\)</span> makes it straightforward to evaluate the Riesz map. For a given functional <span class="math inline">\(w^* \in \mathcal{V}^*\)</span> the associated <span class="math inline">\(w \in \mathcal{V}\)</span> under the Riesz map is <span class="math display">\[
  w = U (w^* U)^*,
\]</span> where <span class="math inline">\((w^* U)^*\)</span> represents the ordinary conjugate transpose of the concrete row vector <span class="math inline">\(w^* U\)</span>. Then taking the inner produce with <span class="math inline">\(w\)</span> is equivalent to evaluating <span class="math inline">\(w^*\)</span>, since <span class="math display">\[
  \langle Uc, w \rangle =
  \langle Uc, U (w^* U)^* \rangle =
  (w^* U) c = w^* (Uc).
\]</span> In the case of the normalized Legendre polynomials, for example, this gives us a way of computing a vector <span class="math inline">\(\delta_x\)</span> associated with the evaluation functional <span class="math inline">\(\delta_x^*\)</span> such that <span class="math inline">\(\delta_x^* p =
p(x)\)</span>:</p>
<div id="df5ad50f" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dualL2_δx</span>(x, d)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    P̄ <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(d)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> [<span class="fu">P̄j</span>(x) for P̄j <span class="kw">in</span> P̄]<span class="ch">'</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    P̄<span class="op">*</span>c[<span class="op">:</span>]</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>dualL2_δx (generic function with 1 method)</code></pre>
</div>
</div>
<p>For example, evaluating <span class="math inline">\(2 -3x + x^2\)</span> at <span class="math inline">\(x = 0.5\)</span> gives <span class="math inline">\(p(0.5) =
\langle p, \delta_{0.5} \rangle = 0.75\)</span>; in code, we have</p>
<div id="81261ca2" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">2.0</span>; <span class="op">-</span><span class="fl">3.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    δhalf <span class="op">=</span> <span class="fu">dualL2_δx</span>(<span class="fl">0.5</span>, <span class="fl">2</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">p</span>(<span class="fl">0.5</span>) <span class="op">≈</span> <span class="fu">dotL2</span>(p, δhalf)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>true</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="maps-and-forms" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="maps-and-forms"><span class="header-section-number">4.2</span> Maps and forms</h2>
<p>A central object in linear algebra is a linear map between two spaces. If <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> are two vector spaces, we denote the vector space of linear maps<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> between them by <span class="math inline">\(L(\mathcal{V}, \mathcal{U})\)</span>.</p>
<p>Closely associated with linear maps <em>between</em> two vector spaces are certain maps <em>from</em> two vector spaces. A <em>bilinear form</em> is a map <span class="math inline">\(a : \mathcal{U}\times \mathcal{V}\rightarrow \mathbb{F}\)</span> which is linear in both arguments. Such a form can be identified with a linear map from <span class="math inline">\(\mathcal{V}\)</span> to <span class="math inline">\(\mathcal{U}^*\)</span> by partial evaluation: <span class="math inline">\(v \mapsto a(\cdot, v)\)</span>. A <em>sesquilinear form</em> is linear in one argument and antilinear (conjugate linear) in the second argument, and can be identified with an antilinear map from <span class="math inline">\(\mathcal{V}\)</span> to <span class="math inline">\(\mathcal{U}^*\)</span>. We are generally interested in bilinear forms over real spaces and sesquilinear forms over complex spaces. When we want to talk about real bilinear forms and complex sesquilinear forms at the same time, we will usually just say “sesquilinear forms.”</p>
<p>On inner product spaces, each sesquilinear form <span class="math inline">\(a : \mathcal{V}\times \mathcal{W}
\rightarrow \mathbb{F}\)</span> is associated with a unique linear map <span class="math inline">\(L \in
L(\mathcal{V}, \mathcal{W})\)</span> such that <span class="math display">\[
  a(v, w) = \langle Lv, w \rangle_{\mathcal{U}}.
\]</span> That is, sesquilinear forms can be identified with linear maps and vice-versa, and so we will address them together.</p>
<p>A linear map from a space to itself is called a linear operator. Linear operators have enough additional structure that we will deal with them separately.</p>
<section id="dual-and-adjoint-maps" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="dual-and-adjoint-maps"><span class="header-section-number">4.2.1</span> Dual and adjoint maps</h3>
<p>Any linear map <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> comes with an associated dual map in <span class="math inline">\(L(\mathcal{U}^*, \mathcal{V}^*)\)</span> with the action <span class="math inline">\(u^* \mapsto u^* L\)</span>. If both spaces have inner products, then we compose the dual map with the Riesz map on both sides to get the <em>adjoint</em> <span class="math inline">\(L^* \in
L(\mathcal{U}, \mathcal{V})\)</span> with the action <span class="math inline">\(u \mapsto (u^* L)^*\)</span>. Equivalently, the adjoint map has the property that <span class="math display">\[
  \langle Lv, u \rangle_{\mathcal{U}} = \langle v, L^* u \rangle_{\mathcal{V}}.
\]</span> In concrete spaces with the standard inner product, the adjoint map is represented by the conjugate transpose of the matrix of the original map.</p>
</section>
<section id="matrices" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="matrices"><span class="header-section-number">4.2.2</span> Matrices</h3>
<section id="matrices-for-maps" class="level4" data-number="4.2.2.1">
<h4 data-number="4.2.2.1" class="anchored" data-anchor-id="matrices-for-maps"><span class="header-section-number">4.2.2.1</span> Matrices for maps</h4>
<p>The usual representation of a linear map <span class="math inline">\(L \in L(\mathbb{F}^n, \mathbb{F}^m)\)</span> is via an <span class="math inline">\(m\)</span>-by-<span class="math inline">\(n\)</span> matrix <span class="math inline">\(A \in \mathbb{F}^{m \times n}\)</span>. Applying the function <span class="math inline">\(y = Lx\)</span> is equivalent to the matrix multiplication <span class="math inline">\(y = Ax\)</span>: <span class="math display">\[
  y_i = \sum_{j=1}^n a_{ij} x_j.
\]</span></p>
<p>More generally, if <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> and <span class="math inline">\(V\)</span> and <span class="math inline">\(U\)</span> are bases for <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span>, then there is an associated matrix representation <span class="math display">\[
  A = U^{-1} L V.
\]</span> The action of the matrix <span class="math inline">\(A\)</span> comes from converting from <span class="math inline">\(\mathbb{F}^n\)</span> to <span class="math inline">\(\mathcal{V}\)</span> (via <span class="math inline">\(V\)</span>), applying <span class="math inline">\(L\)</span> to get a vector in <span class="math inline">\(\mathcal{U}\)</span>, and mapping from <span class="math inline">\(\mathcal{U}\)</span> back to the concrete space <span class="math inline">\(\mathbb{F}^m\)</span>. Equivalently, we can write the abstract operator as <span class="math display">\[
  L = U A V^{-1},
\]</span> i.e.&nbsp;we map from <span class="math inline">\(\mathcal{V}\)</span> to a concrete vector in <span class="math inline">\(\mathbb{F}^n\)</span>, map that to a concrete vector in <span class="math inline">\(\mathbb{F}^m\)</span> by matrix multiplication with <span class="math inline">\(A\)</span>, and map <span class="math inline">\(\mathbb{F}^m\)</span> to <span class="math inline">\(\mathcal{U}\)</span> via the <span class="math inline">\(U\)</span> basis.</p>
<p>If we consider the case where <span class="math inline">\(V'\)</span> and <span class="math inline">\(U'\)</span> are alternate bases for <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span>, there is an associated matrix representation <span class="math display">\[
  A' = U'^{-1} L V' = (U'^{-1} U) A (V^{-1} V')
\]</span> Here the (invertible) matrix <span class="math inline">\(V^{-1} V'\)</span> represents a <em>change of basis</em>: if <span class="math inline">\(v = V'c\)</span> is a representation in the <span class="math inline">\(V'\)</span> basis and <span class="math inline">\(v = Vd\)</span> is a representation in the <span class="math inline">\(V\)</span> basis, then <span class="math inline">\(d = V^{-1} V' c\)</span>. Similarly, the matrix <span class="math inline">\(U'^{-1} U\)</span> converts the coefficients in the <span class="math inline">\(U\)</span> basis to coefficients in the <span class="math inline">\(U'\)</span> basis.</p>
</section>
<section id="matrices-for-sesquilinear-forms" class="level4" data-number="4.2.2.2">
<h4 data-number="4.2.2.2" class="anchored" data-anchor-id="matrices-for-sesquilinear-forms"><span class="header-section-number">4.2.2.2</span> Matrices for sesquilinear forms</h4>
<p>Suppose <span class="math inline">\(a : \mathcal{V}\times \mathcal{W}\rightarrow \mathbb{F}\)</span> is a sesquilinear form and <span class="math inline">\(V\)</span> and <span class="math inline">\(W\)</span> are bases for <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{W}\)</span>. Then <span class="math display">\[
  a(Vx, Wy) = \sum_{j,i} x_j \bar y_i a(v_j, w_i) = y^* A x
\]</span> where <span class="math inline">\(A\)</span> is the matrix with entries <span class="math inline">\(a_{ij} = a(v_j, w_i)\)</span>. In an inner product space where we can write <span class="math inline">\(a\)</span> in terms of a linear operator <span class="math inline">\(L\)</span>, we have <span class="math display">\[
  a(Vx, Wy) = \langle L Vx, Wy \rangle_{\mathcal{W}}
            = y^* W^* L V x,
\]</span> i.e.&nbsp;we can also think of <span class="math inline">\(A\)</span> as <span class="math inline">\(W^* L V\)</span>.</p>
<p>We note that the matrix representation of the sesquilinear form is <em>not</em> identical to the matrix representation of <span class="math inline">\(L\)</span> as a linear map, except in the special case where we constrain <span class="math inline">\(V\)</span> and <span class="math inline">\(W\)</span> to be orthonormal bases. For more general matrices, the expression <span class="math inline">\(W^* L
V\)</span> involves both the matrix for the linear map (<span class="math inline">\(W^{-1} L V\)</span>) and the Gram matrix (<span class="math inline">\(M = W^* W)\)</span>; that is, we can also write <span class="math display">\[
  y^* W^* L V x
  = y^* (W^* W) W^{-1} L V x
  = \langle W^{-1} L V x, y \rangle_M.
\]</span></p>
</section>
<section id="representing-derivatives" class="level4" data-number="4.2.2.3">
<h4 data-number="4.2.2.3" class="anchored" data-anchor-id="representing-derivatives"><span class="header-section-number">4.2.2.3</span> Representing derivatives</h4>
<p>As a concrete example of matrix representations, we consider the derivative operator <span class="math inline">\(D : \mathcal{P}_d \rightarrow \mathcal{P}_{d-1}\)</span>. With respect to the power basis for both <span class="math inline">\(\mathcal{P}_d\)</span> and <span class="math inline">\(\mathcal{P}_{d-1}\)</span>, we write the relation <span class="math display">\[
  \frac{d}{dx} x^n = n x^{n-1}
\]</span> as <span class="math display">\[
  D X_{0:d} = X_{0:d-1} A
\]</span> where <span class="math display">\[
  A = \begin{bmatrix}
  0 &amp; 1 \\
    &amp; &amp; 2 \\
    &amp; &amp; &amp; 3 \\
    &amp; &amp; &amp; &amp; \ddots \\
    &amp; &amp; &amp; &amp; &amp; d
  \end{bmatrix}.
\]</span> In code, we have</p>
<div id="cf111922" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">derivative_power</span>(d)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> <span class="fu">zeros</span>(d,d<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>        A[i,i<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> i</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    A</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>derivative_power (generic function with 1 method)</code></pre>
</div>
</div>
<p>Alternately, we can write <span class="math inline">\(D = X_{0:d-1} A X_{0:d}^{-1}\)</span> or <span class="math inline">\(A = X_{0:d-1}^{-1} D X_{0:d}\)</span>.</p>
<p>A similar relationship holds for the first and second kind Chebyshev polynomials: <span class="math display">\[
  \frac{d}{dx} T_n(x) = n U_{n-1}(x),
\]</span> and so if we use the first-kind polynomial basis <span class="math inline">\(T_{0:d}\)</span> for <span class="math inline">\(\mathcal{P}_d\)</span> and the second-kind polynomial basis <span class="math inline">\(U_{0:d-1}\)</span> for <span class="math inline">\(\mathcal{P}_{d-1}\)</span>, we have <span class="math display">\[
  D T_{0:d} = U_{0:d-1} A
\]</span> where <span class="math inline">\(A\)</span> is the same matrix as before. Using the change of basis, we have <span class="math display">\[
  D T_{0:d} = T_{0:d-1} B^{-1} A.
\]</span> In code, the matrix representation <span class="math inline">\(T_{0:d-1}^{-1} D T_{0:d} = B^{-1} A\)</span> can be computed by</p>
<div id="5af6bcca" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">derivative_chebyshevT</span>(d) <span class="op">=</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">change_U_to_T</span>(d<span class="op">-</span><span class="fl">1</span>)<span class="fu">\derivative_power</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>derivative_chebyshevT (generic function with 1 method)</code></pre>
</div>
</div>
<p>It is always useful to compare against another implementation of the same computation, e.g.</p>
<div id="74bf66d2" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    Dmatrix <span class="op">=</span> <span class="fu">zeros</span>(<span class="fl">5</span>,<span class="fl">6</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    DT <span class="op">=</span> <span class="fu">derivative</span>.(<span class="fu">chebyshev_basis</span>(<span class="fl">5</span>))</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(DT)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> ci <span class="op">=</span> <span class="fu">collect</span>(<span class="fu">pairs</span>(<span class="fu">convert</span>(ChebyshevT, DT[j])))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>            Dmatrix[ci[<span class="fl">1</span>]<span class="op">+</span><span class="fl">1</span>,j] <span class="op">=</span> ci[<span class="fl">2</span>]</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    Dmatrix <span class="op">≈</span> <span class="fu">derivative_chebyshevT</span>(<span class="fl">5</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>true</code></pre>
</div>
</div>
<p>Now consider a sesquilinear form on <span class="math inline">\(\mathcal{P}_d \times \mathcal{P}_{d-1}\)</span> given by <span class="math display">\[
  a(u, w) = \int_{-1}^1 \bar{w}(x) u'(x) \, dx.
\]</span> If we use the Chebyshev basis for both arguments, we have <span class="math display">\[\begin{aligned}
  a(T_{0:d} x, T_{0:d-1} y)
  &amp;= y^* T_{0:d-1}^* D T_{0:d} x \\
  &amp;= y^* T_{0:d-1}^* T_{0:d-1} B^{-1} A x,
\end{aligned}\]</span> that is, the matrix is <span class="math inline">\(T_{0:d-1}^* T_{0:d-1} B^{-1} A\)</span>. In terms of codes we have written, we have (for <span class="math inline">\(d = 5\)</span>)</p>
<div id="0895ac18" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">derivative_chebyshevT_bilinear</span>(d) <span class="op">=</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gram_L2_chebyshev</span>(d<span class="op">-</span><span class="fl">1</span>)<span class="fu">*derivative_chebyshevT</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>derivative_chebyshevT_bilinear (generic function with 1 method)</code></pre>
</div>
</div>
<p>As before, we can sanity check against an alternate computation</p>
<div id="14888f42" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="fu">chebyshev_basis</span>(<span class="fl">5</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">a</span>(p, q) <span class="op">=</span> <span class="fu">dotL2</span>(<span class="fu">derivative</span>(p), q)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">derivative_chebyshevT_bilinear</span>(<span class="fl">5</span>) <span class="op">≈</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>        [<span class="fu">a</span>(T[j<span class="op">+</span><span class="fl">1</span>], T[i<span class="op">+</span><span class="fl">1</span>]) for i<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, j<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>]</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>true</code></pre>
</div>
</div>
<p>With respect to the Legendre basis, one can differentiate the Bonnet recurrence relation for <span class="math inline">\(P_n\)</span> and rearrange to get a recurrence relation for the derivatives: <span class="math display">\[
  P_{n+1}'(x) = (2n+1) P_n(x) + P_{n-1}'(x).
\]</span> Together with the initial conditions <span class="math inline">\(P_0'(x) = 0\)</span> and <span class="math inline">\(P_1'(x) = P_0(x)\)</span>, we have the following expression of <span class="math inline">\(D\)</span> with respect to the Legendre bases for <span class="math inline">\(\mathcal{P}_d\)</span> and <span class="math inline">\(\mathcal{P}_{d-1}\)</span>, i.e. <span class="math inline">\(D P_{0:d} = P_{0:d-1} C\)</span>:</p>
<div id="06b77593" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">derivative_legendre</span>(d)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    DP <span class="op">=</span> <span class="fu">zeros</span>(d,d<span class="op">+</span><span class="fl">1</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> d <span class="op">&gt;</span> <span class="fl">0</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>        DP[<span class="fl">1</span>,<span class="fl">2</span>] <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>d<span class="op">-</span><span class="fl">1</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>        DP[<span class="op">:</span>,  j<span class="op">+</span><span class="fl">2</span>] <span class="op">=</span> DP[<span class="op">:</span>,j]</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>        DP[j<span class="op">+</span><span class="fl">1</span>,j<span class="op">+</span><span class="fl">2</span>] <span class="op">=</span> <span class="fl">2</span>j<span class="op">+</span><span class="fl">1</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    DP</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>derivative_legendre (generic function with 1 method)</code></pre>
</div>
</div>
<p>As usual, we sanity check our computation:</p>
<div id="8c3bbb95" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">derivative</span>.(<span class="fu">legendre_basis</span>(<span class="fl">3</span>)) <span class="op">==</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">legendre_basis</span>(<span class="fl">2</span>)<span class="fu">*derivative_legendre</span>(<span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>true</code></pre>
</div>
</div>
<p>If we want the derivative for the normalized Legendre polynomials, it is convenient to write them as <span class="math inline">\(P_{0:d} S_d\)</span> where <span class="math inline">\(S_d\)</span> is the diagonal matrix with elements <span class="math inline">\(\sqrt{(2j+1)/2}\)</span> for <span class="math inline">\(j=0\)</span> to <span class="math inline">\(d\)</span>. Then <span class="math display">\[
  D P_{0:d} S_d = P_{0:d-1} S_{d-1} (S_{d-1}^{-1} C S_d).
\]</span> In code, we have</p>
<div id="1845b5e6" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">derivative_nlegendre</span>(d) <span class="op">=</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>.(<span class="fl">2.0</span><span class="op">./</span>(<span class="fl">2</span><span class="fu">*</span>(<span class="fl">0</span><span class="op">:</span>d<span class="op">-</span><span class="fl">1</span>)<span class="op">.+</span><span class="fl">1</span>)) <span class="op">.*</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">derivative_legendre</span>(d) <span class="op">.*</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>.((<span class="fl">2</span><span class="fu">*</span>(<span class="fl">0</span><span class="op">:</span>d)<span class="op">.+</span><span class="fl">1</span>)<span class="op">/</span><span class="fl">2</span>)<span class="ch">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>derivative_nlegendre (generic function with 1 method)</code></pre>
</div>
</div>
<p>Unlike some of our earlier computations, there is a little difference between different approaches to computing the normalized Legendre polynomials, so we check whether the results are close rather than exactly the same:</p>
<div id="7e8fbcf2" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    err <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(<span class="fl">2</span>)<span class="fu">*derivative_nlegendre</span>(<span class="fl">3</span>) <span class="op">-</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">derivative</span>.(<span class="fu">normalized_legendre_basis</span>(<span class="fl">3</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">all</span>(<span class="fu">iszero</span>.(<span class="fu">truncate</span>.(err, atol<span class="op">=</span><span class="fl">1e-12</span>)))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>true</code></pre>
</div>
</div>
</section>
</section>
<section id="block-matrices" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="block-matrices"><span class="header-section-number">4.2.3</span> Block matrices</h3>
<p>Sometimes we are interested in <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> where the two spaces are direct sums: <span class="math display">\[\begin{aligned}
  \mathcal{V}&amp;= \mathcal{V}_1 \oplus \mathcal{V}_2 \oplus \ldots \oplus \mathcal{V}_n \\
  \mathcal{U}&amp;= \mathcal{U}_1 \oplus \mathcal{U}_2 \oplus \ldots \oplus \mathcal{U}_m.
\end{aligned}\]</span> In this case, we can write <span class="math inline">\(u = Lv\)</span> with the subspace decompositions <span class="math inline">\(u = u_1 + \ldots + u_m\)</span> and <span class="math inline">\(v = v_1 + \ldots + v_n\)</span> as <span class="math display">\[
  u_i = \sum_{j=1}^n L_{ij} v_j
\]</span> where <span class="math inline">\(L_{ij} \in L(\mathcal{V}_j, \mathcal{U}_i)\)</span>. We can write this in <em>block quasimatrix</em> notation as <span class="math display">\[
  \begin{bmatrix} u_1 \\ \vdots \\ u_m \end{bmatrix} =
  \begin{bmatrix}
  L_{11} &amp; \ldots &amp; L_{1n} \\
  \vdots &amp; &amp; \vdots \\
  L_{m1} &amp; \ldots &amp; L_{mn}
  \end{bmatrix}
  \begin{bmatrix} v_1 \\ \vdots \\ v_n \end{bmatrix}.
\]</span> Now suppose we have associated partitioned <em>bases</em> <span class="math display">\[\begin{aligned}
  V &amp;= \begin{bmatrix} V_1 &amp; V_2 &amp; \ldots &amp; V_n \end{bmatrix} \\
  U &amp;= \begin{bmatrix} U_1 &amp; U_2 &amp; \ldots &amp; U_m \end{bmatrix}.
\end{aligned}\]</span> Then the matrix <span class="math inline">\(A = U^{-1} L V\)</span> can be thought of as a <em>block matrix</em> with blocks <span class="math inline">\(A_{ij} = U_i^{-1} L_{ij} V_j\)</span> associated with each of the <span class="math inline">\(L_{ij}\)</span>. Concretely, if <span class="math inline">\(w_i = U_i d_i\)</span> and <span class="math inline">\(v_j = V_j c_j\)</span> for appropriately-sized concrete vectors <span class="math inline">\(d_i\)</span> and <span class="math inline">\(c_i\)</span>, we have <span class="math display">\[
  \begin{bmatrix} d_1 \\ \vdots \\ d_m \end{bmatrix} =
  \begin{bmatrix}
  A_{11} &amp; \ldots &amp; A_{1n} \\
  \vdots &amp; &amp; \vdots \\
  A_{m1} &amp; \ldots &amp; A_{mn}
  \end{bmatrix}
  \begin{bmatrix} c_1 \\ \vdots \\ c_n \end{bmatrix}.
\]</span></p>
</section>
<section id="canonical-forms" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="canonical-forms"><span class="header-section-number">4.2.4</span> Canonical forms</h3>
<p>A <em>canonical form</em> for a map <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> is a “simple as possible” matrix representation associated with a particular choice of bases. This also makes sense when <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> are concrete vector spaces, in which case the canonical form is a sort of matrix decomposition.</p>
<p>In general, we will consider two types of canonical forms: those associated with <em>general</em> choices of bases and those associated with <em>orthonormal</em> bases (when <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> are inner product spaces). The canonical forms are essentially the same whether we are working with linear maps or sesquilinear forms; we will focus on the linear map case.</p>
<section id="block-decomposition" class="level4" data-number="4.2.4.1">
<h4 data-number="4.2.4.1" class="anchored" data-anchor-id="block-decomposition"><span class="header-section-number">4.2.4.1</span> Block decomposition</h4>
<p>The first step to the canonical forms for a general linear map is to decompose <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> into special direct sums. For <span class="math inline">\(\mathcal{V}\)</span>, we decompose into the kernel (or null space) of <span class="math inline">\(L\)</span>, i.e.&nbsp;<span class="math inline">\(\mathcal{N}(L) =
\{v \in \mathcal{V}: Lv = 0\}\)</span>, along with any complementary space: <span class="math display">\[
  \mathcal{V}= \mathcal{V}_1 \oplus \mathcal{V}_2, \quad \mathcal{V}_2 = \mathcal{N}(L).
\]</span> For <span class="math inline">\(\mathcal{U}\)</span>, we decompose into the range space <span class="math inline">\(\mathcal{R}(L) = \{Lv : v \in \mathcal{V}\}\)</span> and any complementary space: <span class="math display">\[
  \mathcal{U}= \mathcal{U}_1 \oplus \mathcal{U}_2, \quad \mathcal{U}_1 = \mathcal{R}(L).
\]</span> The null space <span class="math inline">\(\mathcal{N}(L)\)</span> and the range <span class="math inline">\(\mathcal{R}(L)\)</span> are sometimes also known as the kernel and the image of <span class="math inline">\(L\)</span>. The space <span class="math inline">\(\mathcal{U}_2\)</span> is isomorphic to <span class="math inline">\(\mathcal{U}/ \mathcal{R}(L)\)</span>, sometimes called the <em>cokernel</em>, while the space <span class="math inline">\(\mathcal{V}_1\)</span> is isomorphic to <span class="math inline">\(\mathcal{V}/ \mathcal{N}(L)\)</span>, sometimes called the <em>coimage</em>. These four spaces (the kernel, cokernel, range, and corange) play a key role in linear algebra. The rank <span class="math inline">\(r\)</span> is thus the both the dimension of the range and the dimension of the coimage.</p>
<p>With respect to such a decomposition, we have the block quasimatrix <span class="math display">\[
  L = \begin{bmatrix} L_{11} &amp; 0_{r \times (n-r)} \\ 0_{(m-r)\times r}
  &amp; 0_{(m-r)\times(n-r)} \end{bmatrix}.
\]</span> We have indicated the dimensions of the zero blocks here for clarity. The structure of this quasimatrix comes directly from the definition of the null space (which guarantees that the second block column should be zero) and the range space (which guarantees that the second block row should be zero). The block <span class="math inline">\(L_{11} \in L(\mathcal{V}_1, \mathcal{U}_1)\)</span> is one-to-one (because all null vectors of <span class="math inline">\(L\)</span> are in the <span class="math inline">\(\mathcal{V}_2\)</span> space) and onto (because <span class="math inline">\(\mathcal{U}_1\)</span> is the range space). Therefore, <span class="math inline">\(L_{11}\)</span> is invertible.</p>
<p>The block decomposition of a map is closely connected to the <em>Fredholm alternative</em> theorem. Consider the equations <span class="math inline">\(Lx = b\)</span>, and suppose we decompose our spaces in terms of kernel, cokernel, range, and corange as above to get the quasimatrix equation <span class="math display">\[
  \begin{bmatrix} L_{11} &amp; 0_{r \times (n-r)} \\ 0_{(m-r)\times r}
  &amp; 0_{(m-r)\times(n-r)} \end{bmatrix}
  \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} =
  \begin{bmatrix} b_1 \\ b_2 \end{bmatrix}.
\]</span> Then one of two conditions must hold; the system is either</p>
<ul>
<li><em>Consistent</em> (<span class="math inline">\(b_2 = 0\)</span>): There is a solution to the system. In fact, if <span class="math inline">\(x_*\)</span> is any solution (a <em>particular</em> solution), then the set of all possible solutions is <span class="math inline">\(\{ x_* + v : Lv = 0 \}\)</span>. more generally, an <span class="math inline">\((n-r)\)</span>-dimensional set of solutions</li>
<li><em>Inconsistent</em> (<span class="math inline">\(b_2 \neq 0\)</span>): There is not a solution to the system (<span class="math inline">\(b_2 \neq 0\)</span>), but there does exist <span class="math inline">\(y^* \in \mathcal{U}^*\)</span> such that <span class="math inline">\(y^* L = 0\)</span> and <span class="math inline">\(y^* b \neq 0\)</span>.</li>
</ul>
<p>Without the decomposition of <span class="math inline">\(\mathcal{U}\)</span> and <span class="math inline">\(\mathcal{V}\)</span>, the statement of the Fredholm alternative (for finite dimensional spaces) is a little mysterious. With the decomposition, it is almost a matter of inspection.</p>
<p>The decomposition of a map based on range and cokernel (for <span class="math inline">\(\mathcal{U}\)</span>) and kernel and coimage (for <span class="math inline">\(\mathcal{V}\)</span>) works equally well in the infinite-dimensional setting. Of course, in this setting some of the block dimensions will be infinite! But in some cases when the kernel and cokernel are finite-dimensional, we can define the <em>index</em> of <span class="math inline">\(L\)</span> to be the difference between the dimension of the kernel and the dimension of the cokernel (or the codimension of the range space, which is the same thing). In the finite-dimensional picture, this is <span class="math display">\[
  \dim(\mathcal{V}_2) - \dim(\mathcal{U}_2) = (m-r)-(n-r) = m-n.
\]</span> In other words, the index generalizes the notion of “how many more equations than variables” there are.</p>
</section>
<section id="general-bases" class="level4" data-number="4.2.4.2">
<h4 data-number="4.2.4.2" class="anchored" data-anchor-id="general-bases"><span class="header-section-number">4.2.4.2</span> General bases</h4>
<p>Let <span class="math inline">\(\mathcal{V}= \mathcal{V}_1 \oplus \mathcal{V}_2\)</span> and let <span class="math inline">\(\mathcal{U}_1 \oplus \mathcal{U}_2\)</span> as above (i.e.&nbsp;<span class="math inline">\(\mathcal{U}_1\)</span> is the range space and <span class="math inline">\(\mathcal{V}_2\)</span> is the null space). For any basis <span class="math inline">\(V_1\)</span> for <span class="math inline">\(\mathcal{V}_1\)</span>, the quasimatrix <span class="math inline">\(U_1 =
LV_1\)</span> is a basis for <span class="math inline">\(\mathcal{U}_1\)</span>. Concatenating any bases <span class="math inline">\(V_2\)</span> and <span class="math inline">\(U_2\)</span> for <span class="math inline">\(\mathcal{V}_2\)</span> and <span class="math inline">\(\mathcal{U}_2\)</span>, we have bases <span class="math inline">\(V = \begin{bmatrix} V_1 &amp; V_2 \end{bmatrix}\)</span> for <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(U = \begin{bmatrix} U_1 &amp; U_2 \end{bmatrix}\)</span> for <span class="math inline">\(\mathcal{U}\)</span>. With respect to these bases, we have the matrix representation <span class="math display">\[
  U^{-1} L V = \begin{bmatrix} I_{r \times r} &amp; 0 \\ 0 &amp; 0 \end{bmatrix}.
\]</span> This matrix representation is completely characterized by the dimensions of <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> and the rank <span class="math inline">\(r\)</span>.</p>
</section>
<section id="orthonormal-bases" class="level4" data-number="4.2.4.3">
<h4 data-number="4.2.4.3" class="anchored" data-anchor-id="orthonormal-bases"><span class="header-section-number">4.2.4.3</span> Orthonormal bases</h4>
<p>In a general vector space, we can use any complementary subspaces to the range and null space of <span class="math inline">\(L\)</span>. But in an inner product space, we prefer to use the <em>orthogonal</em> complements: <span class="math display">\[\begin{aligned}
  \mathcal{V}_1 &amp;= \mathcal{N}(L)^\perp &amp; \mbox{coimage} \\
  \mathcal{V}_2 &amp;= \mathcal{N}(L) &amp; \mbox{kernel / null space} \\
  \mathcal{U}_1 &amp;= \mathcal{R}(L) &amp; \mbox{range / image} \\
  \mathcal{U}_2 &amp;= \mathcal{R}(L)^\perp &amp; \mbox{cokernel}
\end{aligned}\]</span> These are sometimes referred to as the “four fundamental subspaces” for a linear map<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> (see <span class="citation" data-cites="strang-2023">Strang (<a href="../references.html#ref-strang-2023" role="doc-biblioref">2023</a>)</span>).</p>
<p>Our canonical form in this setting involves a special choice for the bases <span class="math inline">\(V_1\)</span> and <span class="math inline">\(U_1\)</span>. Specifically, we choose unit-length vectors <span class="math inline">\(v_1, \ldots, v_r\)</span> by maximizing <span class="math inline">\(\|Lv_j\|\)</span> over all vectors in <span class="math inline">\(\mathcal{V}\)</span> orthogonal to <span class="math inline">\(v_1, \ldots, v_{j-1}\)</span>. As we will discuss in <a href="../02-NLA/03-Eigenvalues.html" class="quarto-xref"><span>Chapter 18</span></a>, the vectors <span class="math inline">\(Lv_1, \ldots, Lv_r\)</span> themselves are then (nonzero) orthogonal vectors. The vectors <span class="math inline">\(v_j\)</span> are the <em>right</em> singular vectors, the norms <span class="math inline">\(\sigma_j = \|Lv_j\|\)</span> are the <em>singular values</em>, and the vectors <span class="math inline">\(u_j = Lv_j/\sigma_j\)</span> are the <em>left</em> singular vectors. Concatenating the orthonormal bases <span class="math inline">\(V_1 = \begin{bmatrix} v_1 &amp; \ldots &amp; v_r \end{bmatrix}\)</span> and <span class="math inline">\(U_1 = \begin{bmatrix} u_1 &amp; \ldots &amp; u_r \end{bmatrix}\)</span> with orthonormal bases <span class="math inline">\(V_2\)</span> and <span class="math inline">\(U_2\)</span> for the orthogonal complements, we have the canonical form <span class="math display">\[
  U^* L V = \Sigma = \begin{bmatrix} \Sigma_{11} &amp; 0 \\ 0 &amp; 0 \end{bmatrix}
\]</span> where <span class="math inline">\(\Sigma_{11}\)</span> is the diagonal matrix with the singular values <span class="math inline">\(\sigma_1, \ldots, \sigma_r\)</span> on the diagonal. By construction, these singular values are nonzero and are listed in descending order. Frequently, we write this canonical form as the <em>singular value decomposition</em> (SVD) of <span class="math inline">\(L\)</span>: <span class="math display">\[
  L = U \Sigma V^* = U_1 \Sigma_{11} V_1^*.
\]</span></p>
</section>
<section id="decomposed-derivatives" class="level4" data-number="4.2.4.4">
<h4 data-number="4.2.4.4" class="anchored" data-anchor-id="decomposed-derivatives"><span class="header-section-number">4.2.4.4</span> Decomposed derivatives</h4>
<p>We return again to our example of the derivative mapping from <span class="math inline">\(\mathcal{P}_d\)</span> to <span class="math inline">\(\mathcal{P}_{d-1}\)</span>. For this example, the range space is all of <span class="math inline">\(\mathcal{P}_{d-1}\)</span> and the null space is the constant vectors. Decomposing with respect to the <span class="math inline">\(L^2([-1,1])\)</span> inner product, the cokernel and coimage are the empty set and the mean zero vectors. Therefore, we can find general bases in which the matrix is <span class="math display">\[
  \begin{bmatrix} I_{d \times d} &amp; 0_{d \times 1} \end{bmatrix}.
\]</span></p>
<p>More interesting is the singular value decomposition in the <span class="math inline">\(L^2([-1,1])\)</span> inner product. Here it is easiest to compute using the matrix representation of the derivative with respect to orthonormal bases like the normalized Legendre polynomials <span class="math inline">\(\bar{P}_{0:d}\)</span>. Then taking <span class="math inline">\(C = U \Sigma V^T\)</span> as the singular value decomposition of the matrix representing the derivative, the singular value decomposition of the derivative map is <span class="math display">\[
  D = (\bar{P}_{0:d-1} U) \Sigma (\bar{P}_{0:d} V)^T.
\]</span> That is, the orthonormal basis vectors that diagonalize <span class="math inline">\(D\)</span> are given by <span class="math inline">\(\hat{U} = \bar{P}_{0:d-1} U\)</span> and <span class="math inline">\(\bar{P}_{0:d} V\)</span>.</p>
<p>The singular values of the derivative mapping from <span class="math inline">\(\mathcal{P}_d\)</span> to <span class="math inline">\(\mathcal{P}_{d-1}\)</span> depend on the dimension <span class="math inline">\(d\)</span> of the space. It is illuminating to look at the behavior of these values in ascending order:</p>
<div id="d5ce552f" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    dmax <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the singular values for each degree d</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    σs <span class="op">=</span> <span class="fu">zeros</span>(dmax,dmax)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> d <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>dmax</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>        F <span class="op">=</span> <span class="fu">svd</span>(<span class="fu">derivative_nlegendre</span>(d))</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>        σs[<span class="fl">1</span><span class="op">:</span>d,d] <span class="op">.=</span> F.S[<span class="kw">end</span><span class="op">:-</span><span class="fl">1</span><span class="op">:</span><span class="fl">1</span>]</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Draw one line for the ith smallest singular value as a function of d</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">1</span><span class="op">:</span>dmax, σs[<span class="fl">1</span>,<span class="op">:</span>], legend<span class="op">=:</span><span class="cn">false</span>, marker<span class="op">=:</span>star, xlabel<span class="op">=</span><span class="st">"d"</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="op">=</span> <span class="fl">2</span><span class="op">:</span>dmax</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot!</span>(i<span class="op">:</span>dmax, σs[i,i<span class="op">:</span>dmax], marker<span class="op">=:</span>star)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip450">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip450)" d="M0 1920 L2688 1920 L2688 -4.26326e-14 L0 -4.26326e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip451">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip450)" d="M144.733 1734.12 L2640.76 1734.12 L2640.76 47.2441 L144.733 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip452">
    <rect x="144" y="47" width="2497" height="1688"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="477.013,1734.12 477.013,47.2441 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1000.29,1734.12 1000.29,47.2441 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1523.56,1734.12 1523.56,47.2441 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2046.84,1734.12 2046.84,47.2441 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2570.11,1734.12 2570.11,47.2441 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="477.013,1734.12 477.013,1715.22 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1000.29,1734.12 1000.29,1715.22 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1523.56,1734.12 1523.56,1715.22 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2046.84,1734.12 2046.84,1715.22 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2570.11,1734.12 2570.11,1715.22 "></polyline>
<path clip-path="url(#clip450)" d="M471.666 1794.89 L487.985 1794.89 L487.985 1798.82 L466.041 1798.82 L466.041 1794.89 Q468.703 1792.13 473.286 1787.5 Q477.892 1782.85 479.073 1781.51 Q481.318 1778.98 482.198 1777.25 Q483.101 1775.49 483.101 1773.8 Q483.101 1771.04 481.156 1769.31 Q479.235 1767.57 476.133 1767.57 Q473.934 1767.57 471.48 1768.34 Q469.05 1769.1 466.272 1770.65 L466.272 1765.93 Q469.096 1764.79 471.55 1764.21 Q474.003 1763.64 476.041 1763.64 Q481.411 1763.64 484.605 1766.32 Q487.8 1769.01 487.8 1773.5 Q487.8 1775.63 486.99 1777.55 Q486.202 1779.45 484.096 1782.04 Q483.517 1782.71 480.415 1785.93 Q477.314 1789.12 471.666 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M1003.3 1768.34 L991.492 1786.78 L1003.3 1786.78 L1003.3 1768.34 M1002.07 1764.26 L1007.95 1764.26 L1007.95 1786.78 L1012.88 1786.78 L1012.88 1790.67 L1007.95 1790.67 L1007.95 1798.82 L1003.3 1798.82 L1003.3 1790.67 L987.695 1790.67 L987.695 1786.16 L1002.07 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M1523.97 1779.68 Q1520.82 1779.68 1518.97 1781.83 Q1517.14 1783.98 1517.14 1787.73 Q1517.14 1791.46 1518.97 1793.64 Q1520.82 1795.79 1523.97 1795.79 Q1527.12 1795.79 1528.95 1793.64 Q1530.8 1791.46 1530.8 1787.73 Q1530.8 1783.98 1528.95 1781.83 Q1527.12 1779.68 1523.97 1779.68 M1533.25 1765.02 L1533.25 1769.28 Q1531.49 1768.45 1529.69 1768.01 Q1527.9 1767.57 1526.14 1767.57 Q1521.51 1767.57 1519.06 1770.7 Q1516.63 1773.82 1516.28 1780.14 Q1517.65 1778.13 1519.71 1777.06 Q1521.77 1775.97 1524.25 1775.97 Q1529.45 1775.97 1532.46 1779.15 Q1535.5 1782.29 1535.5 1787.73 Q1535.5 1793.06 1532.35 1796.27 Q1529.2 1799.49 1523.97 1799.49 Q1517.97 1799.49 1514.8 1794.91 Q1511.63 1790.3 1511.63 1781.58 Q1511.63 1773.38 1515.52 1768.52 Q1519.41 1763.64 1525.96 1763.64 Q1527.72 1763.64 1529.5 1763.98 Q1531.31 1764.33 1533.25 1765.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M2046.84 1782.41 Q2043.51 1782.41 2041.58 1784.19 Q2039.69 1785.97 2039.69 1789.1 Q2039.69 1792.22 2041.58 1794.01 Q2043.51 1795.79 2046.84 1795.79 Q2050.17 1795.79 2052.09 1794.01 Q2054.01 1792.2 2054.01 1789.1 Q2054.01 1785.97 2052.09 1784.19 Q2050.19 1782.41 2046.84 1782.41 M2042.16 1780.42 Q2039.15 1779.68 2037.46 1777.62 Q2035.8 1775.56 2035.8 1772.59 Q2035.8 1768.45 2038.74 1766.04 Q2041.7 1763.64 2046.84 1763.64 Q2052 1763.64 2054.94 1766.04 Q2057.88 1768.45 2057.88 1772.59 Q2057.88 1775.56 2056.19 1777.62 Q2054.52 1779.68 2051.54 1780.42 Q2054.92 1781.21 2056.79 1783.5 Q2058.69 1785.79 2058.69 1789.1 Q2058.69 1794.12 2055.61 1796.81 Q2052.56 1799.49 2046.84 1799.49 Q2041.12 1799.49 2038.04 1796.81 Q2034.99 1794.12 2034.99 1789.1 Q2034.99 1785.79 2036.88 1783.5 Q2038.78 1781.21 2042.16 1780.42 M2040.45 1773.03 Q2040.45 1775.72 2042.12 1777.22 Q2043.81 1778.73 2046.84 1778.73 Q2049.85 1778.73 2051.54 1777.22 Q2053.25 1775.72 2053.25 1773.03 Q2053.25 1770.35 2051.54 1768.84 Q2049.85 1767.34 2046.84 1767.34 Q2043.81 1767.34 2042.12 1768.84 Q2040.45 1770.35 2040.45 1773.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M2544.8 1794.89 L2552.44 1794.89 L2552.44 1768.52 L2544.13 1770.19 L2544.13 1765.93 L2552.39 1764.26 L2557.07 1764.26 L2557.07 1794.89 L2564.71 1794.89 L2564.71 1798.82 L2544.8 1798.82 L2544.8 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M2584.15 1767.34 Q2580.54 1767.34 2578.71 1770.9 Q2576.91 1774.45 2576.91 1781.58 Q2576.91 1788.68 2578.71 1792.25 Q2580.54 1795.79 2584.15 1795.79 Q2587.79 1795.79 2589.59 1792.25 Q2591.42 1788.68 2591.42 1781.58 Q2591.42 1774.45 2589.59 1770.9 Q2587.79 1767.34 2584.15 1767.34 M2584.15 1763.64 Q2589.96 1763.64 2593.02 1768.24 Q2596.1 1772.83 2596.1 1781.58 Q2596.1 1790.3 2593.02 1794.91 Q2589.96 1799.49 2584.15 1799.49 Q2578.34 1799.49 2575.26 1794.91 Q2572.21 1790.3 2572.21 1781.58 Q2572.21 1772.83 2575.26 1768.24 Q2578.34 1763.64 2584.15 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M1402.82 1853.06 L1402.82 1833.78 L1408.67 1833.78 L1408.67 1883.3 L1402.82 1883.3 L1402.82 1877.95 Q1400.97 1881.14 1398.14 1882.7 Q1395.34 1884.22 1391.39 1884.22 Q1384.93 1884.22 1380.86 1879.07 Q1376.81 1873.91 1376.81 1865.51 Q1376.81 1857.11 1380.86 1851.95 Q1384.93 1846.79 1391.39 1846.79 Q1395.34 1846.79 1398.14 1848.35 Q1400.97 1849.88 1402.82 1853.06 M1382.86 1865.51 Q1382.86 1871.97 1385.5 1875.66 Q1388.18 1879.32 1392.82 1879.32 Q1397.47 1879.32 1400.14 1875.66 Q1402.82 1871.97 1402.82 1865.51 Q1402.82 1859.05 1400.14 1855.39 Q1397.47 1851.7 1392.82 1851.7 Q1388.18 1851.7 1385.5 1855.39 Q1382.86 1859.05 1382.86 1865.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.733,1356.77 2640.76,1356.77 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.733,965.743 2640.76,965.743 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.733,574.716 2640.76,574.716 "></polyline>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.733,183.689 2640.76,183.689 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,1734.12 144.733,47.2441 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,1356.77 163.631,1356.77 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,965.743 163.631,965.743 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,574.716 163.631,574.716 "></polyline>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.733,183.689 163.631,183.689 "></polyline>
<path clip-path="url(#clip450)" d="M53.1169 1370.12 L60.7558 1370.12 L60.7558 1343.75 L52.4456 1345.42 L52.4456 1341.16 L60.7095 1339.49 L65.3854 1339.49 L65.3854 1370.12 L73.0242 1370.12 L73.0242 1374.05 L53.1169 1374.05 L53.1169 1370.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M92.4686 1342.57 Q88.8575 1342.57 87.0288 1346.13 Q85.2232 1349.68 85.2232 1356.81 Q85.2232 1363.91 87.0288 1367.48 Q88.8575 1371.02 92.4686 1371.02 Q96.1028 1371.02 97.9083 1367.48 Q99.737 1363.91 99.737 1356.81 Q99.737 1349.68 97.9083 1346.13 Q96.1028 1342.57 92.4686 1342.57 M92.4686 1338.87 Q98.2787 1338.87 101.334 1343.47 Q104.413 1348.06 104.413 1356.81 Q104.413 1365.53 101.334 1370.14 Q98.2787 1374.72 92.4686 1374.72 Q86.6584 1374.72 83.5797 1370.14 Q80.5242 1365.53 80.5242 1356.81 Q80.5242 1348.06 83.5797 1343.47 Q86.6584 1338.87 92.4686 1338.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M56.3345 979.088 L72.6539 979.088 L72.6539 983.023 L50.7095 983.023 L50.7095 979.088 Q53.3715 976.334 57.9549 971.704 Q62.5613 967.051 63.7419 965.709 Q65.9872 963.185 66.8668 961.449 Q67.7696 959.69 67.7696 958 Q67.7696 955.246 65.8252 953.51 Q63.9039 951.773 60.8021 951.773 Q58.603 951.773 56.1493 952.537 Q53.7188 953.301 50.941 954.852 L50.941 950.13 Q53.7651 948.996 56.2188 948.417 Q58.6724 947.838 60.7095 947.838 Q66.0798 947.838 69.2742 950.523 Q72.4687 953.209 72.4687 957.699 Q72.4687 959.829 71.6585 961.75 Q70.8715 963.648 68.765 966.241 Q68.1863 966.912 65.0845 970.13 Q61.9826 973.324 56.3345 979.088 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M92.4686 951.542 Q88.8575 951.542 87.0288 955.107 Q85.2232 958.648 85.2232 965.778 Q85.2232 972.884 87.0288 976.449 Q88.8575 979.991 92.4686 979.991 Q96.1028 979.991 97.9083 976.449 Q99.737 972.884 99.737 965.778 Q99.737 958.648 97.9083 955.107 Q96.1028 951.542 92.4686 951.542 M92.4686 947.838 Q98.2787 947.838 101.334 952.445 Q104.413 957.028 104.413 965.778 Q104.413 974.505 101.334 979.111 Q98.2787 983.695 92.4686 983.695 Q86.6584 983.695 83.5797 979.111 Q80.5242 974.505 80.5242 965.778 Q80.5242 957.028 83.5797 952.445 Q86.6584 947.838 92.4686 947.838 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M66.4733 573.362 Q69.8298 574.079 71.7048 576.348 Q73.6029 578.617 73.6029 581.95 Q73.6029 587.066 70.0844 589.866 Q66.5659 592.667 60.0845 592.667 Q57.9086 592.667 55.5938 592.228 Q53.3021 591.811 50.8484 590.954 L50.8484 586.441 Q52.7928 587.575 55.1077 588.153 Q57.4225 588.732 59.9456 588.732 Q64.3437 588.732 66.6354 586.996 Q68.9502 585.26 68.9502 581.95 Q68.9502 578.894 66.7974 577.181 Q64.6678 575.445 60.8484 575.445 L56.8206 575.445 L56.8206 571.603 L61.0335 571.603 Q64.4826 571.603 66.3113 570.237 Q68.14 568.848 68.14 566.255 Q68.14 563.593 66.2419 562.181 Q64.3669 560.746 60.8484 560.746 Q58.9271 560.746 56.728 561.163 Q54.529 561.58 51.8901 562.459 L51.8901 558.293 Q54.5521 557.552 56.8669 557.181 Q59.2049 556.811 61.265 556.811 Q66.5891 556.811 69.6909 559.242 Q72.7927 561.649 72.7927 565.769 Q72.7927 568.64 71.1492 570.63 Q69.5057 572.598 66.4733 573.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M92.4686 560.515 Q88.8575 560.515 87.0288 564.08 Q85.2232 567.621 85.2232 574.751 Q85.2232 581.857 87.0288 585.422 Q88.8575 588.964 92.4686 588.964 Q96.1028 588.964 97.9083 585.422 Q99.737 581.857 99.737 574.751 Q99.737 567.621 97.9083 564.08 Q96.1028 560.515 92.4686 560.515 M92.4686 556.811 Q98.2787 556.811 101.334 561.418 Q104.413 566.001 104.413 574.751 Q104.413 583.478 101.334 588.084 Q98.2787 592.667 92.4686 592.667 Q86.6584 592.667 83.5797 588.084 Q80.5242 583.478 80.5242 574.751 Q80.5242 566.001 83.5797 561.418 Q86.6584 556.811 92.4686 556.811 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M65.1539 170.483 L53.3484 188.932 L65.1539 188.932 L65.1539 170.483 M63.927 166.409 L69.8066 166.409 L69.8066 188.932 L74.7372 188.932 L74.7372 192.821 L69.8066 192.821 L69.8066 200.969 L65.1539 200.969 L65.1539 192.821 L49.5521 192.821 L49.5521 188.307 L63.927 166.409 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip450)" d="M92.4686 169.488 Q88.8575 169.488 87.0288 173.052 Q85.2232 176.594 85.2232 183.724 Q85.2232 190.83 87.0288 194.395 Q88.8575 197.936 92.4686 197.936 Q96.1028 197.936 97.9083 194.395 Q99.737 190.83 99.737 183.724 Q99.737 176.594 97.9083 173.052 Q96.1028 169.488 92.4686 169.488 M92.4686 165.784 Q98.2787 165.784 101.334 170.39 Q104.413 174.974 104.413 183.724 Q104.413 192.45 101.334 197.057 Q98.2787 201.64 92.4686 201.64 Q86.6584 201.64 83.5797 197.057 Q80.5242 192.45 80.5242 183.724 Q80.5242 174.974 83.5797 170.39 Q86.6584 165.784 92.4686 165.784 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip452)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="215.375,1680.07 477.013,1680.07 738.65,1686.36 1000.29,1686.36 1261.93,1686.38 1523.56,1686.38 1785.2,1686.38 2046.84,1686.38 2308.48,1686.38 2570.11,1686.38 "></polyline>
<path clip-path="url(#clip452)" d="M215.375 1664.07 L211.615 1674.89 L200.159 1675.13 L209.295 1682.05 L205.967 1693.01 L215.375 1686.47 L224.783 1693.01 L221.455 1682.05 L230.591 1675.13 L219.135 1674.89 L215.375 1664.07 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M477.013 1664.07 L473.253 1674.89 L461.797 1675.13 L470.933 1682.05 L467.605 1693.01 L477.013 1686.47 L486.421 1693.01 L483.093 1682.05 L492.229 1675.13 L480.773 1674.89 L477.013 1664.07 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M738.65 1670.36 L734.89 1681.17 L723.434 1681.41 L732.57 1688.34 L729.242 1699.3 L738.65 1692.76 L748.058 1699.3 L744.73 1688.34 L753.866 1681.41 L742.41 1681.17 L738.65 1670.36 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1000.29 1670.36 L996.528 1681.17 L985.072 1681.41 L994.208 1688.34 L990.88 1699.3 L1000.29 1692.76 L1009.7 1699.3 L1006.37 1688.34 L1015.5 1681.41 L1004.05 1681.17 L1000.29 1670.36 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1261.93 1670.38 L1258.17 1681.19 L1246.71 1681.43 L1255.85 1688.36 L1252.52 1699.32 L1261.93 1692.78 L1271.33 1699.32 L1268.01 1688.36 L1277.14 1681.43 L1265.69 1681.19 L1261.93 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1523.56 1670.38 L1519.8 1681.19 L1508.35 1681.43 L1517.48 1688.36 L1514.16 1699.32 L1523.56 1692.78 L1532.97 1699.32 L1529.64 1688.36 L1538.78 1681.43 L1527.32 1681.19 L1523.56 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1670.38 L1781.44 1681.19 L1769.98 1681.43 L1779.12 1688.36 L1775.79 1699.32 L1785.2 1692.78 L1794.61 1699.32 L1791.28 1688.36 L1800.42 1681.43 L1788.96 1681.19 L1785.2 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1670.38 L2043.08 1681.19 L2031.62 1681.43 L2040.76 1688.36 L2037.43 1699.32 L2046.84 1692.78 L2056.25 1699.32 L2052.92 1688.36 L2062.05 1681.43 L2050.6 1681.19 L2046.84 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1670.38 L2304.72 1681.19 L2293.26 1681.43 L2302.4 1688.36 L2299.07 1699.32 L2308.48 1692.78 L2317.88 1699.32 L2314.56 1688.36 L2323.69 1681.43 L2312.24 1681.19 L2308.48 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1670.38 L2566.35 1681.19 L2554.9 1681.43 L2564.03 1688.36 L2560.71 1699.32 L2570.11 1692.78 L2579.52 1699.32 L2576.19 1688.36 L2585.33 1681.43 L2573.87 1681.19 L2570.11 1670.38 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="477.013,1596.35 738.65,1596.35 1000.29,1624.51 1261.93,1624.51 1523.56,1624.95 1785.2,1624.95 2046.84,1624.95 2308.48,1624.95 2570.11,1624.95 "></polyline>
<path clip-path="url(#clip452)" d="M477.013 1580.35 L473.253 1591.17 L461.797 1591.41 L470.933 1598.34 L467.605 1609.3 L477.013 1602.75 L486.421 1609.3 L483.093 1598.34 L492.229 1591.41 L480.773 1591.17 L477.013 1580.35 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M738.65 1580.35 L734.89 1591.17 L723.434 1591.41 L732.57 1598.34 L729.242 1609.3 L738.65 1602.75 L748.058 1609.3 L744.73 1598.34 L753.866 1591.41 L742.41 1591.17 L738.65 1580.35 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1000.29 1608.51 L996.528 1619.32 L985.072 1619.56 L994.208 1626.49 L990.88 1637.45 L1000.29 1630.91 L1009.7 1637.45 L1006.37 1626.49 L1015.5 1619.56 L1004.05 1619.32 L1000.29 1608.51 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1261.93 1608.51 L1258.17 1619.32 L1246.71 1619.56 L1255.85 1626.49 L1252.52 1637.45 L1261.93 1630.91 L1271.33 1637.45 L1268.01 1626.49 L1277.14 1619.56 L1265.69 1619.32 L1261.93 1608.51 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1523.56 1608.95 L1519.8 1619.77 L1508.35 1620.01 L1517.48 1626.93 L1514.16 1637.89 L1523.56 1631.35 L1532.97 1637.89 L1529.64 1626.93 L1538.78 1620.01 L1527.32 1619.77 L1523.56 1608.95 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1608.95 L1781.44 1619.77 L1769.98 1620.01 L1779.12 1626.93 L1775.79 1637.89 L1785.2 1631.35 L1794.61 1637.89 L1791.28 1626.93 L1800.42 1620.01 L1788.96 1619.77 L1785.2 1608.95 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1608.95 L2043.08 1619.77 L2031.62 1620.01 L2040.76 1626.94 L2037.43 1637.9 L2046.84 1631.35 L2056.25 1637.9 L2052.92 1626.94 L2062.05 1620.01 L2050.6 1619.77 L2046.84 1608.95 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1608.95 L2304.72 1619.77 L2293.26 1620.01 L2302.4 1626.94 L2299.07 1637.9 L2308.48 1631.35 L2317.88 1637.9 L2314.56 1626.94 L2323.69 1620.01 L2312.24 1619.77 L2308.48 1608.95 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1608.95 L2566.35 1619.77 L2554.9 1620.01 L2564.03 1626.94 L2560.71 1637.9 L2570.11 1631.35 L2579.52 1637.9 L2576.19 1626.94 L2585.33 1620.01 L2573.87 1619.77 L2570.11 1608.95 Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="738.65,1492.79 1000.29,1492.79 1261.93,1561.06 1523.56,1561.06 1785.2,1563.49 2046.84,1563.49 2308.48,1563.53 2570.11,1563.53 "></polyline>
<path clip-path="url(#clip452)" d="M738.65 1476.79 L734.89 1487.6 L723.434 1487.84 L732.57 1494.77 L729.242 1505.73 L738.65 1499.19 L748.058 1505.73 L744.73 1494.77 L753.866 1487.84 L742.41 1487.6 L738.65 1476.79 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1000.29 1476.79 L996.528 1487.6 L985.072 1487.84 L994.208 1494.77 L990.88 1505.73 L1000.29 1499.19 L1009.7 1505.73 L1006.37 1494.77 L1015.5 1487.84 L1004.05 1487.6 L1000.29 1476.79 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1261.93 1545.06 L1258.17 1555.87 L1246.71 1556.11 L1255.85 1563.04 L1252.52 1574 L1261.93 1567.46 L1271.33 1574 L1268.01 1563.04 L1277.14 1556.11 L1265.69 1555.87 L1261.93 1545.06 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1523.56 1545.06 L1519.8 1555.87 L1508.35 1556.11 L1517.48 1563.04 L1514.16 1574 L1523.56 1567.46 L1532.97 1574 L1529.64 1563.04 L1538.78 1556.11 L1527.32 1555.87 L1523.56 1545.06 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1547.49 L1781.44 1558.31 L1769.98 1558.55 L1779.12 1565.48 L1775.79 1576.44 L1785.2 1569.89 L1794.61 1576.44 L1791.28 1565.48 L1800.42 1558.55 L1788.96 1558.31 L1785.2 1547.49 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1547.49 L2043.08 1558.31 L2031.62 1558.55 L2040.76 1565.48 L2037.43 1576.44 L2046.84 1569.89 L2056.25 1576.44 L2052.92 1565.48 L2062.05 1558.55 L2050.6 1558.31 L2046.84 1547.49 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1547.53 L2304.72 1558.35 L2293.26 1558.59 L2302.4 1565.51 L2299.07 1576.47 L2308.48 1569.93 L2317.88 1576.47 L2314.56 1565.51 L2323.69 1558.59 L2312.24 1558.35 L2308.48 1547.53 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1547.53 L2566.35 1558.35 L2554.9 1558.59 L2564.03 1565.51 L2560.71 1576.47 L2570.11 1569.93 L2579.52 1576.47 L2576.19 1565.51 L2585.33 1558.59 L2573.87 1558.35 L2570.11 1547.53 Z" fill="#3da44d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1000.29,1366.55 1261.93,1366.55 1523.56,1494.45 1785.2,1494.45 2046.84,1501.84 2308.48,1501.84 2570.11,1502.1 "></polyline>
<path clip-path="url(#clip452)" d="M1000.29 1350.55 L996.528 1361.37 L985.072 1361.61 L994.208 1368.54 L990.88 1379.5 L1000.29 1372.95 L1009.7 1379.5 L1006.37 1368.54 L1015.5 1361.61 L1004.05 1361.37 L1000.29 1350.55 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1261.93 1350.55 L1258.17 1361.37 L1246.71 1361.61 L1255.85 1368.54 L1252.52 1379.5 L1261.93 1372.95 L1271.33 1379.5 L1268.01 1368.54 L1277.14 1361.61 L1265.69 1361.37 L1261.93 1350.55 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1523.56 1478.45 L1519.8 1489.26 L1508.35 1489.5 L1517.48 1496.43 L1514.16 1507.39 L1523.56 1500.85 L1532.97 1507.39 L1529.64 1496.43 L1538.78 1489.5 L1527.32 1489.26 L1523.56 1478.45 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1478.45 L1781.44 1489.26 L1769.98 1489.5 L1779.12 1496.43 L1775.79 1507.39 L1785.2 1500.85 L1794.61 1507.39 L1791.28 1496.43 L1800.42 1489.5 L1788.96 1489.26 L1785.2 1478.45 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1485.84 L2043.08 1496.66 L2031.62 1496.9 L2040.76 1503.83 L2037.43 1514.79 L2046.84 1508.24 L2056.25 1514.79 L2052.92 1503.83 L2062.05 1496.9 L2050.6 1496.66 L2046.84 1485.84 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1485.84 L2304.72 1496.66 L2293.26 1496.9 L2302.4 1503.83 L2299.07 1514.79 L2308.48 1508.24 L2317.88 1514.79 L2314.56 1503.83 L2323.69 1496.9 L2312.24 1496.66 L2308.48 1485.84 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1486.1 L2566.35 1496.92 L2554.9 1497.16 L2564.03 1504.09 L2560.71 1515.05 L2570.11 1508.5 L2579.52 1515.05 L2576.19 1504.09 L2585.33 1497.16 L2573.87 1496.92 L2570.11 1486.1 Z" fill="#c271d2" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#ac8d18; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1261.93,1216.34 1523.56,1216.34 1785.2,1423.12 2046.84,1423.12 2308.48,1439.63 2570.11,1439.63 "></polyline>
<path clip-path="url(#clip452)" d="M1261.93 1200.34 L1258.17 1211.15 L1246.71 1211.39 L1255.85 1218.32 L1252.52 1229.28 L1261.93 1222.74 L1271.33 1229.28 L1268.01 1218.32 L1277.14 1211.39 L1265.69 1211.15 L1261.93 1200.34 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1523.56 1200.34 L1519.8 1211.15 L1508.35 1211.39 L1517.48 1218.32 L1514.16 1229.28 L1523.56 1222.74 L1532.97 1229.28 L1529.64 1218.32 L1538.78 1211.39 L1527.32 1211.15 L1523.56 1200.34 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1407.12 L1781.44 1417.94 L1769.98 1418.18 L1779.12 1425.11 L1775.79 1436.07 L1785.2 1429.52 L1794.61 1436.07 L1791.28 1425.11 L1800.42 1418.18 L1788.96 1417.94 L1785.2 1407.12 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1407.12 L2043.08 1417.94 L2031.62 1418.18 L2040.76 1425.11 L2037.43 1436.07 L2046.84 1429.52 L2056.25 1436.07 L2052.92 1425.11 L2062.05 1418.18 L2050.6 1417.94 L2046.84 1407.12 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1423.63 L2304.72 1434.44 L2293.26 1434.68 L2302.4 1441.61 L2299.07 1452.57 L2308.48 1446.03 L2317.88 1452.57 L2314.56 1441.61 L2323.69 1434.68 L2312.24 1434.44 L2308.48 1423.63 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1423.63 L2566.35 1434.44 L2554.9 1434.68 L2564.03 1441.61 L2560.71 1452.57 L2570.11 1446.03 L2579.52 1452.57 L2576.19 1441.61 L2585.33 1434.68 L2573.87 1434.44 L2570.11 1423.63 Z" fill="#ac8d18" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#00a9ad; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1523.56,1041.62 1785.2,1041.62 2046.84,1345.77 2308.48,1345.77 2570.11,1376.23 "></polyline>
<path clip-path="url(#clip452)" d="M1523.56 1025.62 L1519.8 1036.43 L1508.35 1036.67 L1517.48 1043.6 L1514.16 1054.56 L1523.56 1048.02 L1532.97 1054.56 L1529.64 1043.6 L1538.78 1036.67 L1527.32 1036.43 L1523.56 1025.62 Z" fill="#00a9ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M1785.2 1025.62 L1781.44 1036.43 L1769.98 1036.67 L1779.12 1043.6 L1775.79 1054.56 L1785.2 1048.02 L1794.61 1054.56 L1791.28 1043.6 L1800.42 1036.67 L1788.96 1036.43 L1785.2 1025.62 Z" fill="#00a9ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 1329.77 L2043.08 1340.59 L2031.62 1340.83 L2040.76 1347.75 L2037.43 1358.71 L2046.84 1352.17 L2056.25 1358.71 L2052.92 1347.75 L2062.05 1340.83 L2050.6 1340.59 L2046.84 1329.77 Z" fill="#00a9ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1329.77 L2304.72 1340.59 L2293.26 1340.83 L2302.4 1347.75 L2299.07 1358.71 L2308.48 1352.17 L2317.88 1358.71 L2314.56 1347.75 L2323.69 1340.83 L2312.24 1340.59 L2308.48 1329.77 Z" fill="#00a9ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1360.23 L2566.35 1371.05 L2554.9 1371.29 L2564.03 1378.21 L2560.71 1389.17 L2570.11 1382.63 L2579.52 1389.17 L2576.19 1378.21 L2585.33 1371.29 L2573.87 1371.05 L2570.11 1360.23 Z" fill="#00a9ad" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#ed5d92; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1785.2,842.188 2046.84,842.188 2308.48,1261.43 2570.11,1261.43 "></polyline>
<path clip-path="url(#clip452)" d="M1785.2 826.188 L1781.44 837.004 L1769.98 837.244 L1779.12 844.172 L1775.79 855.132 L1785.2 848.588 L1794.61 855.132 L1791.28 844.172 L1800.42 837.244 L1788.96 837.004 L1785.2 826.188 Z" fill="#ed5d92" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2046.84 826.188 L2043.08 837.004 L2031.62 837.244 L2040.76 844.172 L2037.43 855.132 L2046.84 848.588 L2056.25 855.132 L2052.92 844.172 L2062.05 837.244 L2050.6 837.004 L2046.84 826.188 Z" fill="#ed5d92" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 1245.43 L2304.72 1256.24 L2293.26 1256.48 L2302.4 1263.41 L2299.07 1274.37 L2308.48 1267.83 L2317.88 1274.37 L2314.56 1263.41 L2323.69 1256.48 L2312.24 1256.24 L2308.48 1245.43 Z" fill="#ed5d92" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1245.43 L2566.35 1256.24 L2554.9 1256.48 L2564.03 1263.41 L2560.71 1274.37 L2570.11 1267.83 L2579.52 1274.37 L2576.19 1263.41 L2585.33 1256.48 L2573.87 1256.24 L2570.11 1245.43 Z" fill="#ed5d92" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#c68125; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2046.84,617.965 2308.48,617.965 2570.11,1169.48 "></polyline>
<path clip-path="url(#clip452)" d="M2046.84 601.965 L2043.08 612.781 L2031.62 613.021 L2040.76 619.949 L2037.43 630.909 L2046.84 624.365 L2056.25 630.909 L2052.92 619.949 L2062.05 613.021 L2050.6 612.781 L2046.84 601.965 Z" fill="#c68125" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2308.48 601.965 L2304.72 612.781 L2293.26 613.021 L2302.4 619.949 L2299.07 630.909 L2308.48 624.365 L2317.88 630.909 L2314.56 619.949 L2323.69 613.021 L2312.24 612.781 L2308.48 601.965 Z" fill="#c68125" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 1153.48 L2566.35 1164.3 L2554.9 1164.54 L2564.03 1171.47 L2560.71 1182.43 L2570.11 1175.88 L2579.52 1182.43 L2576.19 1171.47 L2585.33 1164.54 L2573.87 1164.3 L2570.11 1153.48 Z" fill="#c68125" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip452)" style="stroke:#00a98d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2308.48,368.905 2570.11,368.905 "></polyline>
<path clip-path="url(#clip452)" d="M2308.48 352.905 L2304.72 363.721 L2293.26 363.961 L2302.4 370.889 L2299.07 381.849 L2308.48 375.305 L2317.88 381.849 L2314.56 370.889 L2323.69 363.961 L2312.24 363.721 L2308.48 352.905 Z" fill="#00a98d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 352.905 L2566.35 363.721 L2554.9 363.961 L2564.03 370.889 L2560.71 381.849 L2570.11 375.305 L2579.52 381.849 L2576.19 370.889 L2585.33 363.961 L2573.87 363.721 L2570.11 352.905 Z" fill="#00a98d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip452)" d="M2570.11 78.9858 L2566.35 89.8018 L2554.9 90.0418 L2564.03 96.9698 L2560.71 107.93 L2570.11 101.386 L2579.52 107.93 L2576.19 96.9698 L2585.33 90.0418 L2573.87 89.8018 L2570.11 78.9858 Z" fill="#8e971d" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
</svg>
</div>
</div>
<p>As we increase <span class="math inline">\(d\)</span>, we get more singular values; but each singular value (ordered from smallest to biggest) appears to fairly quickly converge from above to a limiting value. Indeed, we can make sense of these limits.</p>
<p>As an example, consider the smallest singular value and the associated basis vectors for the derivative acting on <span class="math inline">\(\mathcal{P}_{10}\)</span> with the <span class="math inline">\(L^2([-1,1])\)</span> inner product. We expect that regardless of the degree, we should have <span class="math inline">\(Dv_{\min} = u_{\min} \sigma_{\min}\)</span> where <span class="math inline">\(\sigma_{\min}\)</span> is the smallest (nonzero) singular value and <span class="math inline">\(u_{\min}\)</span> and <span class="math inline">\(v_{\min}\)</span> are the associated singular vectors (columns in the <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> bases). By <span class="math inline">\(d = 10\)</span>, we also expect to be close to the limiting behavior: the smallest singular value should converge to <span class="math inline">\(\pi/2\)</span>, with associated singular vectors <span class="math inline">\(v_{\min}(x) \rightarrow \cos(x\pi/2)\)</span> and <span class="math inline">\(u_{\min}(x) \rightarrow \sin(x\pi/2)\)</span>. This anticipated behavior is borne out in numerical experiment:</p>
<div id="4be8a7fb" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the SVD of D acting on P_10</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">svd</span>(<span class="fu">derivative_nlegendre</span>(d))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(d<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>F.U</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(d)<span class="op">*</span>F.V</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>    σs <span class="op">=</span> F.S</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the singular triple associated with</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the smallest (nonzero) singular value</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>    σ, u, v <span class="op">=</span> σs[<span class="kw">end</span>], U[<span class="kw">end</span>], V[<span class="kw">end</span>]</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check various relations (use a mesh of 100 points)</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    xx <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="fu">sign</span>(<span class="fu">u</span>(<span class="fl">0</span>))</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"""</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="st">- |D*u-v*σ| = </span><span class="sc">$</span>(<span class="fu">norm</span>((<span class="fu">derivative</span>(v)<span class="op">-</span>u<span class="op">*</span>σ).(xx), <span class="cn">Inf</span>))</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="st">- |sin(π/2*x)-v| = </span><span class="sc">$</span>(<span class="fu">norm</span>(<span class="fu">s*sin</span>.(<span class="cn">π</span><span class="op">/</span><span class="fl">2</span><span class="op">*</span>xx)<span class="fu">-v</span>.(xx), <span class="cn">Inf</span>))</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="st">- |cos(π/2*x)-u| = </span><span class="sc">$</span>(<span class="fu">norm</span>(<span class="fu">s*cos</span>.(<span class="cn">π</span><span class="op">/</span><span class="fl">2</span><span class="op">*</span>xx)<span class="fu">-u</span>.(xx), <span class="cn">Inf</span>))</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a><span class="st">- |σmin-π/2| = </span><span class="sc">$</span>(<span class="fu">abs</span>(σ<span class="op">-</span><span class="cn">π</span><span class="op">/</span><span class="fl">2</span>))</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- |D*u-v*σ| = 5.076326047387471e-14
- |sin(π/2*x)-v| = 4.919919749379886e-9
- |cos(π/2*x)-u| = 1.3086657329447118e-7
- |σmin-π/2| = 3.552713678800501e-15
</code></pre>
</div>
</div>
<p>In general, the <span class="math inline">\(k\)</span>th smallest singular value converges to <span class="math inline">\(k\pi/2\)</span>, and the singular vectors converge to sines and cosines.</p>
</section>
</section>
<section id="pseudoinverses" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="pseudoinverses"><span class="header-section-number">4.2.5</span> (Pseudo)inverses</h3>
<p>Suppose <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> has a canonical form with respect to a general basis of <span class="math display">\[
  L = U \begin{bmatrix} I_{r \times r} &amp; 0_{r \times (n-r)} \\
  0_{(m-r) \times r} &amp; 0_{(m-r) \times (n-r)} \end{bmatrix}
  V^{-1}.
\]</span> If <span class="math inline">\(r \neq m\)</span> and <span class="math inline">\(r \neq n\)</span>, then <span class="math inline">\(L\)</span> does not have an inverse. However, we can define an associated <em>pseudoinverse</em> <span class="math inline">\(M \in L(\mathcal{V}, \mathcal{U})\)</span> by <span class="math display">\[
  M = V \begin{bmatrix} I_{r \times r} &amp; 0_{r \times (m-r)} \\
  0_{(n-r) \times r} &amp; 0_{(n-r) \times (m-r)} \end{bmatrix}
  U^{-1}.
\]</span> Let <span class="math inline">\(P_V = ML\)</span> and <span class="math inline">\(P_U = LM\)</span>. In terms of the bases, we have <span class="math display">\[
  P_V = V \begin{bmatrix} I_{r \times r} &amp; 0_{r \times (n-r)} \\
  0_{(n-r) \times r} &amp; 0_{(n-r) \times (n-r)} \end{bmatrix} V^{-1}
\]</span> and <span class="math display">\[
  P_U = U \begin{bmatrix} I_{r \times r} &amp; 0_{r \times (m-r)} \\
  0_{(m-r) \times r} &amp; 0_{(m-r) \times (m-r)} \end{bmatrix} U^{-1}.
\]</span> Both <span class="math inline">\(P_V\)</span> and <span class="math inline">\(P_U\)</span> are projectors, i.e.&nbsp;<span class="math inline">\(P_V^2 = P_V\)</span> and <span class="math inline">\(P_U^2 =
P_U\)</span>. The <span class="math inline">\(P_V\)</span> projector is the identity on the subspace <span class="math inline">\(\mathcal{V}_1\)</span> that is the complementary to the kernel, and the null space is <span class="math inline">\(\mathcal{V}_1\)</span>. The <span class="math inline">\(P_U\)</span> projector is the identity on the range space <span class="math inline">\(\mathcal{U}_1\)</span>, and the null space is <span class="math inline">\(\mathcal{U}_2\)</span>. If <span class="math inline">\(L\)</span> is one-to-one, <span class="math inline">\(P_V\)</span> is simply the identity; and if <span class="math inline">\(L\)</span> is onto, <span class="math inline">\(P_U\)</span> is the identity.</p>
<p>The pseudoinverse depends on the decompositions <span class="math inline">\(\mathcal{V}= \mathcal{V}_1
\oplus \mathcal{N}(L)\)</span> and <span class="math inline">\(\mathcal{U}= \mathcal{R}(L) \oplus \mathcal{U}_2\)</span>, though it is independent of the details of the bases chosen for the four subspaces. In an inner product space, we most often choose to decompose <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> into orthogonal complements. This gives the <em>Moore-Penrose pseudoinverse</em> (often just called “the pseudoinverse” when the context does not specify some other pseudoinverse). The Moore-Penrose pseudoinverse plays a central role in least squares and minimal norm problems, as we discuss in <a href="../02-NLA/02-Least-Squares.html" class="quarto-xref"><span>Chapter 17</span></a>. In terms of the singular value decomposition, the Moore-Penrose pseudoinverse is <span class="math display">\[
  L^\dagger =
  V \begin{bmatrix} \Sigma_{11}^{-1} &amp; 0 \\ 0 &amp; 0 \end{bmatrix} U^*.
\]</span> For the Moore-Penrose pseudoinverse, the associated projectors are <span class="math inline">\(P_V = V_1 V_1^*\)</span> and <span class="math inline">\(P_U = U_1 U_1^*\)</span>. These are <em>orthogonal</em> projectors, since their range spaces are orthogonal complements of their null spaces. Projectors that are not orthogonal are said to be <em>oblique</em> projectors.</p>
<p>As an example, the Moore-Penrose pseudoinverse of the derivative operator from <span class="math inline">\(\mathcal{P}_d\)</span> to <span class="math inline">\(\mathcal{P}_{d-1}\)</span> is the indefinite integral operator <span class="math inline">\(\mathcal{P}_{d-1}\)</span> to <span class="math inline">\(\mathcal{P}_d\)</span> where the constant is chosen to make the result have zero mean. The associated projector on <span class="math inline">\(\mathcal{P}_d\)</span> is <span class="math inline">\(q(x) \mapsto q(x) - \bar{q}\)</span> where <span class="math inline">\(\bar{q} = \frac{1}{2} \int_{-1}^1 q(x) \, dx\)</span>.</p>
</section>
<section id="norms" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="norms"><span class="header-section-number">4.2.6</span> Norms</h3>
<p>The space <span class="math inline">\(L(\mathcal{V}, \mathcal{U})\)</span> is a vector space; and, as with other vector spaces, it makes sense to talk about norms. In particular, we frequently want norms that are <em>consistent</em> with vector norms on the range and domain spaces; that is, for any <span class="math inline">\(w\)</span> and <span class="math inline">\(v\)</span>, we want <span class="math display">\[
  u = Lv \implies \|u\| \leq \|L\| \|v\|.
\]</span> Particularly useful are the norms <em>induced</em> by vector norms on <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span>: <span class="math display">\[
  \|A\| = \sup_{v \neq 0} \frac{\|Av\|}{\|v\|} = \sup_{\|v\|=1} \|Av\|.
\]</span> In a finite-dimensional space<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, the supremum is achieved, i.e.&nbsp;there exists a maximizing <span class="math inline">\(v\)</span>.</p>
<p>Suppose <span class="math inline">\(S \in L(\mathcal{U}, \mathcal{V})\)</span> and <span class="math inline">\(T \in L(\mathcal{V}, \mathcal{W})\)</span>, and we have consistent norms on the three vectors spaces <span class="math inline">\(\mathcal{U},
\mathcal{V}, \mathcal{W}\)</span> and the spaces of linear maps <span class="math inline">\(L(\mathcal{U}, \mathcal{V})\)</span> and <span class="math inline">\(L(\mathcal{V}, \mathcal{W})\)</span>. Then for all <span class="math inline">\(u \in \mathcal{U}\)</span>, consistency implies <span class="math display">\[
  \|TSu\| \leq \|T\| \|Su\| \leq \|T\| \|S\| \|u\|.
\]</span> Taking the supremum over <span class="math inline">\(\|u\| = 1\)</span> implies that the induced norm on <span class="math inline">\(L(\mathcal{U}, \mathcal{W})\)</span>, we have <span class="math display">\[
  \|TS\| \leq \|T\| \|S\|.
\]</span> This fact is most often used when the norms on <span class="math inline">\(L(\mathcal{U}, \mathcal{V})\)</span> and <span class="math inline">\(L(\mathcal{V}, \mathcal{W})\)</span> are also induced norms.</p>
<p>For inner product spaces, we can also define norms in terms of the singular value decomposition. Some examples include</p>
<ul>
<li>The spectral norm (the largest of the singular values)</li>
<li>The Frobenius norm (the two-norm of the singular values)</li>
<li>The nuclear norm (the sum of the singular values)</li>
</ul>
<p>All of these are also examples of <em>Ky Fan</em> norms (the Ky Fan <span class="math inline">\(k\)</span>-norm is the sum of the <span class="math inline">\(k\)</span> largest singular values) and <em>Schatten</em> norms (the Schatten norm is the <span class="math inline">\(p\)</span>-norm of the vector of singular values). The spectral norm is the norm induced by the Euclidean structure on the two spaces. All the other Ky Fan and Schatten norms are consistent, though they are not induced norms.</p>
<p>For concrete vector spaces, we can write the <em>Frobenius norm</em> as <span class="math display">\[
  \|A\|_F = \sqrt{ \sum_{i,j} |a_{ij}|^2 }.
\]</span> The induced norms corresponding to the vector 1-norm and <span class="math inline">\(\infty\)</span>-norm are <span class="math display">\[\begin{aligned}
  \|A\|_1 &amp;= \max_j \sum_i |a_{ij}| \quad \mbox{(max absolute column sum)}\\
  \|A\|_\infty &amp;= \max_i \sum_j |a_{ij}| \quad \mbox{(max absolute row sum)}
\end{aligned}\]</span> The norm induced by the standard Euclidean norm (the spectral norm) is harder to compute without appealing to the singular value decomposition.</p>
</section>
<section id="isometries" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="isometries"><span class="header-section-number">4.2.7</span> Isometries</h3>
<p>A linear map that preserves norms is called an isometry. Isometries are always one-to-one, since any null vector must have zero norm. If an isometry is also onto, it is sometimes called a <em>global</em> isometry. Global isometries are invertible, and the inverse is also an isometry.</p>
<p>For general norms, there are not always many interesting isometries. For example, the only isometries from <span class="math inline">\(\mathbb{R}^n\)</span> to itself preserving the 1-norm or the <span class="math inline">\(\infty\)</span>-norm are (signed) permutations. For inner product spaces, though, there is a much richer group of isometries, and we will focus on this case.</p>
<p>Isometries between inner product spaces necessarily preserve inner products, since the inner product can be recovered from the associated norm. For global isometries between inner product spaces, the adjoint and the inverse are the same. A global isometry from a space to itself is called an <em>orthogonal operator</em> in the real case, or a <em>unitary operator</em> in the complex case.</p>
<p>A unitary operator maps an orthonormal basis to another orthonormal basis. Therefore, if <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> and <span class="math inline">\(W\)</span> and <span class="math inline">\(Z\)</span> are unitary operator operators on <span class="math inline">\(\mathcal{U}\)</span> and <span class="math inline">\(\mathcal{V}\)</span>, respectively, then <span class="math inline">\(L\)</span> and <span class="math inline">\(W L Z\)</span> have the same singular values. This also means that any norms that can be defined in terms of singular values (including the spectral norm, the Frobenius norm, and the nuclear norm) are the same for <span class="math inline">\(L\)</span> and <span class="math inline">\(W L Z\)</span>. This properties is known as <em>unitary invariance</em> (or <em>orthogonal invariance</em> in the real case).</p>
</section>
<section id="volume-scaling" class="level3" data-number="4.2.8">
<h3 data-number="4.2.8" class="anchored" data-anchor-id="volume-scaling"><span class="header-section-number">4.2.8</span> Volume scaling</h3>
<p>In an inner product space, we usually say that a paralleliped associated with an orthonormal basis (i.e.&nbsp;a unit cube) has unit volume. A unitary operator between two spaces maps a unit cube in one space to a unit cube in another space, i.e.&nbsp;it preserves volume. More generally, if <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> and <span class="math inline">\(V\)</span> and <span class="math inline">\(U\)</span> are orthonormal bases associated with the singular value canonical form, then we can see <span class="math inline">\(L = U \Sigma V^*\)</span> as</p>
<ul>
<li><p>A volume-preserving transformation <span class="math inline">\(V^*\)</span> from <span class="math inline">\(\mathcal{V}\)</span> into <span class="math inline">\(\mathbb{R}^n\)</span> (or <span class="math inline">\(\mathbb{C}^n\)</span>).</p></li>
<li><p>A diagonal scaling operation on <span class="math inline">\(\mathbb{R}^n\)</span> that change each side length from <span class="math inline">\(1\)</span> to <span class="math inline">\(\sigma_j\)</span>. The volume of the scaled paralleliped in <span class="math inline">\(\mathbb{R}^n\)</span> is then <span class="math inline">\(\prod_{j=1}^n \sigma_j\)</span>.</p></li>
<li><p>A volume-preserving transformation <span class="math inline">\(U\)</span> from <span class="math inline">\(\mathbb{R}^n\)</span> into <span class="math inline">\(\mathcal{V}\)</span>.</p></li>
</ul>
<p>Therefore, if <span class="math inline">\(\Omega \subset \mathcal{V}\)</span> is a region with volume <span class="math inline">\(\operatorname{vol}(\Omega)\)</span>, then <span class="math display">\[
  \operatorname{vol}(L \Omega) =
  \left( \prod_{j=1}^n \sigma_j \right) \operatorname{vol}(\Omega).
\]</span> In other words, the product of the singular values gives the magnitude of the determinant of <span class="math inline">\(L\)</span>. We will discuss determinants and signed volumes in <a href="#sec-determinant-sec" class="quarto-xref"><span>Section 4.5.5</span></a>.</p>
</section>
</section>
<section id="operators" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="operators"><span class="header-section-number">4.3</span> Operators</h2>
<p>An operator is a map <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{V})\)</span>. Everything we know about general maps also works for operators, but we have a lot of additional structure coming from the fact that the space is mapped to itself.</p>
<p>Most of our discussion of operators focuses on three connected ideas:</p>
<ul>
<li><p>A key feature of an operator <span class="math inline">\(L\)</span> is its <em>invariant subspaces</em>, i.e subspaces <span class="math inline">\(\mathcal{U}\subset \mathcal{V}\)</span> such that <span class="math inline">\(L \mathcal{U}= \{ Lu : u \in
\mathcal{U}\}\)</span> lies within <span class="math inline">\(\mathcal{U}\)</span>. Given an invariant subspace, we can analyze the associated <em>restriction</em> <span class="math inline">\(L|_{\mathcal{U}}\)</span> of <span class="math inline">\(L\)</span> to <span class="math inline">\(\mathcal{U}\)</span>. One-dimensional invariant subspaces play a particular notable role, as they contain the <em>eigenvectors</em> of <span class="math inline">\(L\)</span>; the restrictions are the associated eigenvalues.</p></li>
<li><p>We can sensibly talk about polynomials in <span class="math inline">\(L\)</span>: if <span class="math inline">\(p(z) = \sum_{j=0}^d c_j z^j\)</span>, then <span class="math inline">\(p(L) = \sum_{j=0}^d c_j L^j\)</span>. Such polynomials are useful for designing and analyzing numerical methods (e.g.&nbsp;Krylov subspace methods for linear systems and eigenvalue problems). They are also useful as a more purely theoretical tool.</p></li>
</ul>
<p>In <a href="04-Calculus.html" class="quarto-xref"><span>Chapter 5</span></a>, we will also discuss an alternative approach to analyzing operators by applying the tools of complex analysis to the <em>resolvent</em> <span class="math inline">\(R(z) = (zI-L)^{-1}\)</span>, a rational function on <span class="math inline">\(\mathbb{C}\)</span> whose poles correspond to eigenvalues. This perspective is useful both for computation and theory. It is particularly useful if we want to generalize from the finite-dimensional to the infinite-dimensional setting.</p>
<section id="minimal-polynomial" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="minimal-polynomial"><span class="header-section-number">4.3.1</span> Minimal polynomial</h3>
<p>If <span class="math inline">\(\mathcal{V}\)</span> is an <span class="math inline">\(n\)</span>-dimensional space, then <span class="math inline">\(L(\mathcal{V}, \mathcal{V})\)</span> is an <span class="math inline">\(n^2\)</span>-dimensional space, and so there must be a linear dependency between the set of <span class="math inline">\(n^2+1\)</span> operators <span class="math inline">\(\{L^j\}_{j=0}^{n^2}\)</span>. Consequently, there must be an <em>annihilating polynomial</em> of degree at most <span class="math inline">\(n^2\)</span>, i.e.&nbsp;a polynomial <span class="math inline">\(p\)</span> such that <span class="math inline">\(p(L) = 0\)</span>. Among the annihilating polynomials for <span class="math inline">\(L\)</span>, there must be some monic<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> annihilating polynomial <span class="math inline">\(p_{\min}\)</span> of minimal degree <span class="math inline">\(m\)</span>. We call <span class="math inline">\(p_{\min}\)</span> the <em>minimal polynomial</em>.</p>
<p>If <span class="math inline">\(p\)</span> is any annihilating polynomial, polynomial division lets us write <span class="math display">\[
  p(z) = q(z) p_{\min}(z) + r(z), \quad \deg(r) &lt; m.
\]</span> Because <span class="math inline">\(p_{\min}(L) = 0\)</span>, we have <span class="math display">\[
  p(L) = q(L) p_{\min}(L) + r(L) = r(L),
\]</span> and therefore <span class="math inline">\(r = 0\)</span>; otherwise <span class="math inline">\(r\)</span> would be an annihilating polynomial of lower degree than <span class="math inline">\(m\)</span>, contradicting the minimality. Therefore any annihilating polynomial can be written as <span class="math inline">\(q(z)
p_{\min}(z)\)</span> for some other polynomial <span class="math inline">\(q(z)\)</span>. As a direct consequence, the minimal polynomial is unique. Also as a consequence, the minimal polynomial of <span class="math inline">\(L|_{\mathcal{U}}\)</span> for any subspace <span class="math inline">\(\mathcal{U}\)</span> divides <span class="math inline">\(p_{\min}\)</span> for <span class="math inline">\(L\)</span>, since <span class="math inline">\(p_{\min}\)</span> for <span class="math inline">\(L\)</span> is an annihilating polynomial for <span class="math inline">\(L|_{\mathcal{U}}\)</span>.</p>
<p>We can write the minimal polynomial in factored form (over <span class="math inline">\(\mathbb{C}\)</span>) as <span class="math display">\[
  p_{\min}(z) = \prod_{j=1}^s (z-\lambda_j)^{d_j}.
\]</span> Each term <span class="math inline">\(L-\lambda_j I\)</span> must be singular; otherwise, we would have <span class="math inline">\((L-\lambda_j I)^{-1} p_{\min}(L) = 0\)</span>, contradicting minimality.</p>
<p>The <span class="math inline">\(\lambda_j\)</span> are the eigenvalues of <span class="math inline">\(L\)</span>, and the null spaces of each <span class="math inline">\(L-\lambda_j I\)</span> are comprised of eigenvectors. If <span class="math inline">\(d_j = 1\)</span> for each eigenvalue, then there is a basis of eigenvectors; otherwise, we have to consider generalized eigenvectors as well to get a basis. In either case, the space <span class="math inline">\(\mathcal{V}\)</span> can be decomposed into a direct sum of invariant subspaces <span class="math inline">\(\mathcal{N}\left( (L-\lambda_j I)^{d_j} \right)\)</span>; these are the <em>maximal invariant subspaces</em> associated with the eigenvalues.</p>
<p>If we let <span class="math inline">\(m_j = \dim \mathcal{N}\left( (L-\lambda_j I)^{d_j} \right)\)</span>, we can also define the <em>characteristic polynomial</em> <span class="math display">\[
  p_{\mbox{char}}(z) = \prod_{j=1}^s (z-\lambda_j)^{m_j}.
\]</span> The dimension <span class="math inline">\(m_j\)</span> is the <em>algebraic multiplicity</em> of the eigenvalue <span class="math inline">\(\lambda_j\)</span>. The <em>geometric multiplicity</em> is the dimension of <span class="math inline">\(\mathcal{N}(L - \lambda_j I)\)</span>, i.e.&nbsp;the number of independent eigenvectors for <span class="math inline">\(\lambda_j\)</span>.</p>
<p>The characteristic polynomial is often also written as <span class="math display">\[
  p_{\mbox{char}}(z) = \det(zI-L),
\]</span> but writing the characteristic polynomial in terms of determinants has the disadvantage that we need an appropriate definition of determinants first!</p>
</section>
<section id="canonical-forms-1" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="canonical-forms-1"><span class="header-section-number">4.3.2</span> Canonical forms</h3>
<p>As in the case of maps between different spaces, we are interested in canonical matrix representations for operators <span class="math inline">\(L \in L(\mathcal{V},
\mathcal{V})\)</span>, i.e.&nbsp;choices of bases that make the matrix representation “as simple as possible.” We consider two such forms: one involving an arbitrary basis, and the other involving an orthonormal basis.</p>
<section id="jordan-form" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="jordan-form"><span class="header-section-number">4.3.2.1</span> Jordan form</h4>
<p>As we noted above, the space <span class="math inline">\(\mathcal{V}\)</span> can be written as <span class="math display">\[
  \mathcal{V}= \mathcal{V}_1 \oplus \mathcal{V}_2 \oplus \ldots \oplus \mathcal{V}_s,
\]</span> where <span class="math inline">\(\mathcal{V}_s\)</span> is the maximal invariant subspace associated with the eigenvalue <span class="math inline">\(\lambda_s\)</span>, i.e. <span class="math display">\[
  \mathcal{V}_j = \mathcal{N}((L-\lambda_j I)^{d_j}).
\]</span> With respect to this partitioning of <span class="math inline">\(\mathcal{V}\)</span>, we have the block diagonal quasimatrix representation <span class="math display">\[
  \begin{bmatrix}
    L_{11} \\ &amp; L_{22} \\ &amp; &amp; \ddots \\ &amp; &amp; &amp; L_{ss}
  \end{bmatrix}
\]</span> where <span class="math inline">\(L_{jj}\)</span> represents the restriction <span class="math inline">\(L|_{\mathcal{V}_j}\)</span>. With a choice of bases for each of the <span class="math inline">\(\mathcal{V}_j\)</span>, this leads to a block diagonal matrix representation.</p>
<p>When the minimal polynomial exponent <span class="math inline">\(d_j\)</span> is 1, we have that <span class="math inline">\(\mathcal{V}_j = \mathcal{N}(L-\lambda_j I)\)</span>, and so <span class="math display">\[
  L|_{\mathcal{V}_j} = \lambda_j I.
\]</span> Hence, if there are no repeated zeros of the minimal polynomial, we can choose bases <span class="math inline">\(V_j\)</span> for each subspace <span class="math inline">\(\mathcal{V}_j\)</span>, and each will satisfy <span class="math display">\[
  L V_{j} = V_j (\lambda_j I).
\]</span> Putting these together, we have the concatenated basis <span class="math display">\[
  V = \begin{bmatrix} V_1 &amp; V_2 &amp; \ldots &amp; V_s \end{bmatrix}
\]</span> satisfying the relationships <span class="math display">\[
  LV = V \Lambda
\]</span> where <span class="math inline">\(\Lambda\)</span> is a diagonal matrix in which each eigenvalue <span class="math inline">\(\lambda_j\)</span> appears <span class="math inline">\(\dim \mathcal{V}_j\)</span> times in a row. With respect to the eigenvector basis <span class="math inline">\(V\)</span>, we therefore have the canonical matrix representation <span class="math display">\[
  \Lambda = V^{-1} L V.
\]</span> Hence, such operators are <em>diagonalizable</em>.</p>
<p>When the minimal polynomial has zeros with multiplicity greater than one, the matrix is not diagonalizable. In this case, we cannot form a basis of eigenvectors, but we can form a basis if we include <em>generalized</em> eigenvectors. In the <em>Jordan canonical form</em>, we find bases consisting of <em>Jordan chains</em>, i.e.&nbsp;vectors satisfying <span class="math display">\[\begin{aligned}
  (L-\lambda_j I) u_1 &amp;= 0 \\
  (L-\lambda_j I) u_k &amp;= u_{k-1}, \quad 1 &lt; k \leq b.
\end{aligned}\]</span> Rewriting the second expression as <span class="math inline">\(L u_k = u_{k-1} + \lambda_j u_k\)</span> and defining the quasimatrix <span class="math inline">\(U = \begin{bmatrix} u_1 &amp; \ldots &amp; u_b \end{bmatrix}\)</span>, we can summarize with the matrix equation <span class="math display">\[
  L U = U J_{b\times b}(\lambda)
\]</span> where <span class="math display">\[
  J_{b \times b}(\lambda)
  \begin{bmatrix}
    \lambda_j &amp; 1 \\
    &amp; \lambda_j &amp; 1 \\
    &amp; &amp; \ddots &amp; \ddots \\
    &amp; &amp; &amp; \lambda_j &amp; 1 \\
    &amp; &amp; &amp; &amp; \lambda_j
  \end{bmatrix}
\]</span> is a <span class="math inline">\(b\)</span>-dimensional <em>Jordan block</em>. The maximum size of any Jordan block is equal to the multiplicity <span class="math inline">\(d_j\)</span> of <span class="math inline">\(\lambda_j\)</span> in the minimal polynomial; the number of Jordan blocks for <span class="math inline">\(\lambda_j\)</span> is equal to the geometric multiplicity <span class="math inline">\(\dim \mathcal{N}(L-\lambda_j I)\)</span>; and the sum of the sizes of the Jordan blocks is equal to the algebraic multiplicity <span class="math inline">\(\dim \mathcal{N}((L-\lambda_j I)^{d_j})\)</span>. Taking a basis formed from concatenating such Jordan chains for each space, we have the <em>Jordan canonical form</em>, a block diagonal matrix in which each diagonal block is a Jordan block.</p>
<p>The Jordan form is fragile: almost all operators are diagonalizable and have distinct eigenvalues, and infinitesimally small changes will usually completely destroy any nontrival Jordan blocks. Moreover, diagonalizable operators that are <em>close</em> to operators with nontrivial Jordan blocks may have eigenvector bases, but those eigenvector bases are not all that nice. We therefore would like an alternate canonical form that gives up some of the goal of being “as diagonal as possible.”</p>
</section>
<section id="schur-form" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="schur-form"><span class="header-section-number">4.3.2.2</span> Schur form</h4>
<p>In our discussion of the Jordan form, we started with the decomposition of <span class="math inline">\(\mathcal{V}\)</span> into maximal invariant subspaces associated with each eigenvalue. For the Schur form, we decompose <span class="math inline">\(\mathcal{V}\)</span> in terms of <em>nested</em> invariant subspaces: <span class="math display">\[
  \mathcal{W}_k = \oplus_{j=1}^k \mathcal{V}_j.
\]</span> Assuming <span class="math inline">\(\mathcal{V}\)</span> is an inner product space, we can also write <span class="math display">\[
  \mathcal{W}_k = \oplus_{j=1}^k \mathcal{U}_j
\]</span> where <span class="math inline">\(\mathcal{U}_1 = \mathcal{V}_1\)</span> and otherwise <span class="math inline">\(\mathcal{U}_j\)</span> is the orthogonal complement of <span class="math inline">\(\mathcal{W}_{j-1}\)</span> in <span class="math inline">\(\mathcal{W}_j\)</span>. With respect to the decomposition <span class="math inline">\(\mathcal{V}= \oplus_{j=1}^s \mathcal{U}_j\)</span>, we have the block upper triangular quasimatrix representation <span class="math display">\[
  \begin{bmatrix}
    L_{11} &amp; L_{12} &amp; \ldots &amp; L_{1s} \\
           &amp; L_{22} &amp; \ldots &amp; L_{2s} \\
           &amp;        &amp; \ddots &amp; \vdots \\
           &amp;        &amp;        &amp; L_{ss}
  \end{bmatrix}
\]</span> With an appropriate choice of orthonormal basis <span class="math inline">\(U_j\)</span> for each <span class="math inline">\(\mathcal{U}_j\)</span> and setting <span class="math inline">\(U = \begin{bmatrix} U_1 &amp; U_2 &amp; \ldots &amp; U_s
\end{bmatrix}\)</span>, we have <span class="math display">\[
  U^* L U = T
\]</span> where <span class="math inline">\(T\)</span> is an upper triangular matrix for which the eigenvalues are on the diagonal. This is a (complex) <em>Schur canonical form</em>.</p>
<p>The complex Schur form may in general involve complex choices of the basis <span class="math inline">\(U\)</span> and a complex matrix representation <span class="math inline">\(T\)</span>, even if <span class="math inline">\(\mathcal{V}\)</span> is most naturally treated as a vector space over the reals. However, there is a <em>real</em> Schur form which involves a real orthonormal basis and a block upper triangular matrix <span class="math inline">\(T\)</span> where the diagonal blocks are 1-by-1 (for real eigenvalues) or 2-by-2 (for conjugate pairs of eigenvalues).</p>
</section>
</section>
<section id="similar-matrices" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="similar-matrices"><span class="header-section-number">4.3.3</span> Similar matrices</h3>
<p>So far, we have focused on matrices as representations of operators on abstract vector spaces, where we choose one basis <span class="math inline">\(V\)</span> for the space <span class="math inline">\(\mathcal{V}\)</span>: <span class="math display">\[
  A = V^{-1} L V.
\]</span> If we consider an alternate basis <span class="math inline">\(V' = VX\)</span> for an invertible matrix <span class="math inline">\(X\)</span>, we have the associated matrix representation <span class="math display">\[
  A' = V'^{-1} L V' = (V^{-1} V')^{-1} A (V^{-1} V') = X^{-1} A X.
\]</span> The transformation <span class="math inline">\(A \mapsto X^{-1} A X\)</span> is a <em>similarity transformation</em>, and the matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(A'\)</span> are said to be <em>similar</em>.</p>
<p>The properties we have discussed so far (eigenvalues, the minimal and characteristic polynomial, the Jordan form) are fundamentally properties of operators, and do not depend on the basis in which those operators are expressed. As much as possible, we try to make this clear by giving basis-free explanations when possible. But it is also possible to give matrix-based arguments in which we argue for invariance under similarity transformations. For example, if <span class="math inline">\(\hat{A}
= X^{-1} A X\)</span>, then <span class="math display">\[
  \hat{A}^j = (X^{-1} A X)^j = X^{-1} A^j X
\]</span> and, more generally, <span class="math inline">\(p(\hat{A}) = X^{-1} p(A) X\)</span>. Therefore, any annihilating polynomial for <span class="math inline">\(p(A)\)</span> is also an annihilating polynomial for <span class="math inline">\(\hat{A}\)</span>; and the minimal and characteristic polynomials for <span class="math inline">\(A\)</span> will similarly be the minimal and characteristic polynomials for <span class="math inline">\(\hat{A}\)</span>.</p>
</section>
<section id="trace" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="trace"><span class="header-section-number">4.3.4</span> Trace</h3>
<p>We typically describe the <em>trace</em> in terms of a matrix representation: the trace of a matrix is the sum of its diagonal entries, i.e. <span class="math display">\[
  \operatorname{tr}(A) = \sum_{i=1}^n a_{ii}.
\]</span> The trace satisfies the <em>cyclic</em> property that for any <span class="math inline">\(B \in \mathbb{F}^{m
\times n}\)</span> and <span class="math inline">\(C \in \mathbb{F}^{n \times m}\)</span> we have <span class="math display">\[\begin{aligned}
  \operatorname{tr}(AB)
  &amp;= \sum_{i=1}^m \sum_{j=1}^n b_{ij} c_{ji} \\
  &amp;= \sum_{j=1}^n \sum_{i=1}^m c_{ji} b_{ij} \\
  &amp;= \operatorname{tr}(BA).
\end{aligned}\]</span> Using this property, for any invertible <span class="math inline">\(X \in \mathbb{F}^{n \times n}\)</span> we have <span class="math display">\[
  \operatorname{tr}(X^{-1} A X) = \operatorname{tr}(A X X^{-1}) = \operatorname{tr}(A).
\]</span> That is, the trace is <em>invariant under similarity</em>, and is thus a property of the underlyling linear operator and not just of a particular matrix representation. In particular, if <span class="math inline">\(X^{-1} A X = J\)</span> is a Jordan canonical form, we can see that the trace is the sum of the eigenvalues (counting geometric multiplicity).</p>
</section>
<section id="frobenius-inner-product" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="frobenius-inner-product"><span class="header-section-number">4.3.5</span> Frobenius inner product</h3>
<p>The trace is also useful for defining other structures on spaces of linear maps in a basis-free way. Let <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{U})\)</span> be a linear map between two inner product spaces, and let <span class="math inline">\(L = U \Sigma
V^*\)</span> be the singular value decomposition. Then <span class="math display">\[
  \operatorname{tr}(L^* L) = \operatorname{tr}(V \Sigma^2 V^*) = \operatorname{tr}(\Sigma^2 V^* V) =
  \operatorname{tr}(\Sigma^2) = \sum_{j=1}^n \sigma_j^2 = \|L\|_F^2.
\]</span> where <span class="math inline">\(\|L\|_F^2\)</span> is the squared Frobenius norm. Also, if <span class="math inline">\(B\)</span> is any matrix representation of <span class="math inline">\(L\)</span> with respect to orthonormal bases, then we have <span class="math display">\[
  \|L\|_F^2 = \|B\|_F^2 = \operatorname{tr}(B^* B) = \sum_{i,j} |b_{ij}|^2,
\]</span> so it is very simple to compute the Frobenius norm of <span class="math inline">\(L\)</span> given any matrix representation with respect to orthonormal bases.</p>
<p>More generally, the trace can be used to define the <em>Frobenius inner product</em> on the space <span class="math inline">\(L(\mathcal{V}, \mathcal{W})\)</span> via <span class="math display">\[
  \langle L, M \rangle_F = \operatorname{tr}(M^* L).
\]</span> The Frobenius norm is the standard Euclidean norm associated with the Frobenius inner product.</p>
</section>
<section id="hermitian-and-skew" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="hermitian-and-skew"><span class="header-section-number">4.3.6</span> Hermitian and skew</h3>
<p>If <span class="math inline">\(L \in L(\mathcal{V}, \mathcal{V})\)</span>, then <span class="math display">\[
  L = H + S, \quad H = \frac{1}{2} (L+L^*), \quad S = \frac{1}{2}(L-L^*).
\]</span></p>
<p>The operators <span class="math inline">\(H\)</span> and <span class="math inline">\(S\)</span> are known as the Hermitian and skew-Hermitian parts of <span class="math inline">\(L\)</span>. We note that and <span class="math inline">\(\langle H, S \rangle_F
= 0\)</span>, so by the Pythagorean theorem, <span class="math display">\[
  \|L\|_F^2 = \|H\|_F^2 + \|S\|_F^2.
\]</span> More generally, <span class="math inline">\(L(\mathcal{V}, \mathcal{V})\)</span> is a direct sum of Hermitian and skew-Hermitian subspaces, and these spaces are orthogonal complements of each other.</p>
<p>Any operator <span class="math inline">\(L\)</span> has a Schur canonical form <span class="math display">\[
  U^* L U = T
\]</span> where <span class="math inline">\(T\)</span> is an upper triangular matrix. For a Hermitian matrix <span class="math inline">\(H\)</span>, we have <span class="math display">\[
  T = U^* H U = (U^* H U)^* = T^*,
\]</span> which implies that <span class="math inline">\(T\)</span> must be diagonal (since the subdiagonal elements of <span class="math inline">\(T\)</span> are zero and the superdiagonal elements of <span class="math inline">\(T^*\)</span> are zero), and that the diagonal part of <span class="math inline">\(T\)</span> must be real (since <span class="math inline">\(t_{ii} =
t_{ii}^*\)</span>). Similarly, for a skew-Hermitian matrix <span class="math inline">\(S\)</span>, we have <span class="math display">\[
  T = U^* S U = -(U^* S U)^* = -T^*,
\]</span> which simplies that in this case <span class="math inline">\(T\)</span> is diagonal and the diagonal part is imaginary. Hence, the decomposition of a matrix into Hermitian and skew-Hermitian parts in many ways mirrors the decomposition of a complex number into real and imaginary parts.</p>
<p>There is an even stronger number between the Hermitian / skew-Hermitian decomposition and the complex numbers for the case of <span class="math inline">\(\mathbb{R}^{2 \times 2}\)</span>. Let <span class="math inline">\(g : \mathbb{C}\rightarrow \mathbb{R}^{2 \times 2}\)</span> be the map <span class="math display">\[
  g(a + bi) = aI + bJ, \quad J = \begin{bmatrix} 0 &amp; -1 \\ 1 &amp; 0 \end{bmatrix}.
\]</span> Then <span class="math display">\[\begin{aligned}
g(0) &amp;= 0 \\
g(1) &amp;= I \\
g(z+w) &amp;= g(z) + g(w) \\
g(zw) &amp;= g(z) g(w) \\
g(z^{-1}) &amp;= g(z)^{-1}.
\end{aligned}\]</span> That is, the complex matrices are isomorphic to the subset of the 2-by-2 real matrix where the symmetric part is proportional to the identity.</p>
</section>
</section>
<section id="hermitian-and-quadratic-forms" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="hermitian-and-quadratic-forms"><span class="header-section-number">4.4</span> Hermitian and quadratic forms</h2>
<p>A sesquilinear form <span class="math inline">\(a : \mathcal{V}\times \mathcal{V}\rightarrow \mathbb{F}\)</span> is <em>Hermitian</em> if <span class="math inline">\(a(v,w) = \overline{a(w,v)}\)</span>.<br>
If <span class="math inline">\(a(v,w) = -\overline{a(w,v)}\)</span>, the form is called <em>skew-Hermitian</em>. Any sesquilinear form on <span class="math inline">\(\mathcal{V}\times \mathcal{V}\)</span> can be decomposed into Hermitian and skew-Hermitian parts: <span class="math display">\[\begin{aligned}
  a(v,w) &amp;= a^H(v,w) + a^S(v,w) \\
  a^H(v,w) &amp;= \frac{1}{2} \left( a(v,w) + \overline{a(w,v)} \right) \\
  a^S(v,w) &amp;= \frac{1}{2} \left( a(v,w) - \overline{a(w,v)} \right).
\end{aligned}\]</span> We use the terms Hermitian and skew-Hermitian generically to also refer to symmetric and skew-symmetric forms on real vector spaces.</p>
<p>If <span class="math inline">\(\mathcal{V}\)</span> is an inner product space, then for any sesquilinear form <span class="math inline">\(a : \mathcal{V}\times \mathcal{V}\rightarrow \mathbb{F}\)</span>, there is an associated operator <span class="math inline">\(L : \mathcal{V}\rightarrow \mathcal{V}\)</span> such that <span class="math display">\[
  a(v,w) = \langle Lv, w \rangle.
\]</span> When <span class="math inline">\(a\)</span> is Hermitian, we have <span class="math display">\[
  \langle Lv, w \rangle = a(v,w) = \overline{a(w,v)} = \langle v, Lw \rangle,
\]</span> i.e.&nbsp;<span class="math inline">\(L = L^*\)</span> is a self-adjoint operator. A similar argument says that if <span class="math inline">\(a\)</span> is skew-Hermitian, the corresponding operator will satisfy <span class="math inline">\(L = -L^*\)</span>. Hence, the study of Hermitian forms is closely linked to the study of self-adjoint operators.</p>
<p>A <em>quadratic form</em> is a function <span class="math inline">\(\phi : \mathcal{V}\rightarrow \mathbb{F}\)</span> that is homogeneous of degree 2 (i.e.&nbsp;<span class="math inline">\(\phi(\alpha v) = \alpha^2 \phi(v)\)</span>) and such that <span class="math inline">\((u, v) \mapsto \phi(u+v) - \phi(u) - \phi(v)\)</span> is bilinear. The associated bilinear form is always symmetric. Hence, on real vector spaces the study of Hermitian forms is also closely linked to the study of quadratic forms.</p>
<section id="matrices-1" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="matrices-1"><span class="header-section-number">4.4.1</span> Matrices</h3>
<p>Given a basis <span class="math inline">\(V\)</span> for <span class="math inline">\(\mathcal{V}\)</span>, the standard matrix representation of a sesquilinear form on <span class="math inline">\(\mathcal{V}\times \mathcal{V}\)</span> is a square matrix with entries <span class="math inline">\(a_{ij} = a(v_j, v_i)\)</span> so that <span class="math display">\[
  a(Vc, Vd) = d^* A c.
\]</span> Decomposing the form into Hermitian and skew-Hermitian parts corresponds to decomposing <span class="math inline">\(A = H+S\)</span> where <span class="math inline">\(H=H^*\)</span> and <span class="math inline">\(S=-S^*\)</span> are the Hermitian and skew-Hermitian parts of the matrix.</p>
<p>A quadratic form <span class="math inline">\(\phi\)</span> has an associated symmetric bilinear form <span class="math display">\[
  a(u, v) = \frac{1}{2} \left( \phi(u+v) - \phi(u) - \phi(v) \right).
\]</span> The matrix representation for a quadratic form is <span class="math display">\[
  \phi(Vc) = c^T A c
\]</span> where the entries of <span class="math inline">\(A\)</span> are <span class="math inline">\(a_{ij} = a(v_i, v_j)\)</span>. Conversely, for any real bilinear form, <span class="math inline">\(a\)</span>, we have that <span class="math inline">\(\phi(v) := a(v,v)\)</span> is a quadratic form, and <span class="math inline">\(\phi(Vc) = c^T H c\)</span> where <span class="math inline">\(H\)</span> is the matrix for the symmetric part of <span class="math inline">\(a\)</span>.</p>
<p>Let <span class="math inline">\(A\)</span> be a matrix representing a sesquilinear form <span class="math inline">\(a : \mathcal{V}\times \mathcal{V}
\rightarrow \mathcal{F}\)</span> with respect to a basis <span class="math inline">\(V\)</span>, i.e. <span class="math display">\[
  a(Vc, Vd) = d^* A v.
\]</span> We can write any other basis as <span class="math inline">\(\hat{V} = VX\)</span> for some nonsingular <span class="math inline">\(X\)</span>; with respect to the <span class="math inline">\(\hat{V}\)</span> basis, we have <span class="math display">\[
  a(\hat{V}c \hat{V}d) = a(VXc, VXd) = d^* (X^* A X) c.
\]</span> For any nonsingular <span class="math inline">\(X\)</span>, we say <span class="math inline">\(A\)</span> and <span class="math inline">\(\hat{A} = X^* A X\)</span> are <em>congruent</em>. Just as similar matrices represent the same operator under different bases, congruent matrices represent the same sesquilinear form under different bases. When we restrict our attention to orthonormal bases, the matrix <span class="math inline">\(X\)</span> will be unitary; we note that <span class="math inline">\(X^* = X^{-1}\)</span> for unitary <span class="math inline">\(X\)</span>, so a unitary congruence and a unitary similarity are the same thing.</p>
</section>
<section id="canonical-forms-2" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="canonical-forms-2"><span class="header-section-number">4.4.2</span> Canonical forms</h3>
<p>In the case of a general basis, there exists is a basis such that the matrix representation of a Hermitian form is <span class="math display">\[
  \begin{bmatrix}
    I_{\nu_+} &amp; &amp;  \\
    &amp; 0_{\nu_0} &amp; \\
    &amp; &amp; -I_{\nu_{-}}
  \end{bmatrix}
\]</span> The triple <span class="math inline">\((\nu_+, \nu_0, \nu_-)\)</span> is the <em>inertia</em> of the form. Inertia, like rank, is a property of the linear algebraic object (in this case the Hermitian form) rather than its representation in any specific basis. Let <span class="math inline">\(n = \dim(\mathcal{V})\)</span>; then we classify the form based on its inertia as:</p>
<ul>
<li>Positive definite if <span class="math inline">\(\nu = (n, 0, 0)\)</span></li>
<li>Positive semidefinite if <span class="math inline">\(\nu = (r, n-r, 0)\)</span></li>
<li>Negative definite if <span class="math inline">\(\nu = (0, 0, n)\)</span></li>
<li>Negative semidefinite if <span class="math inline">\(\nu  (0, n-r, r)\)</span></li>
<li>Strongly indefinite if <span class="math inline">\(\nu_+ &gt; 0\)</span> and <span class="math inline">\(\nu_- &gt; 0\)</span>.</li>
</ul>
<p>A Hermitian positive definite form is an inner product.</p>
<p>If <span class="math inline">\(\mathcal{V}\)</span> is an inner product space and we restrict ourselves to orthonormal bases, we have a diagonal matrix <span class="math inline">\(\Lambda\)</span> with <span class="math inline">\(\nu_+\)</span> positive values, <span class="math inline">\(\nu_0\)</span> zeros, and <span class="math inline">\(\nu_-\)</span> negative values. If we identify <span class="math inline">\(a(v, w)\)</span> with <span class="math inline">\(\langle Lv, w \rangle\)</span>, then this canonical form gives that <span class="math inline">\(a(v_i, v_j) = \langle Lv_i, v_j \rangle = \lambda_i
\delta_{ij}\)</span>. The Hermitian property implies that <span class="math inline">\(a(v_i, v_i) =
\overline{a(v_i, v_i)} = \lambda\)</span>, so <span class="math inline">\(\lambda\)</span> must be real even when the form is over <span class="math inline">\(\mathbb{C}\)</span>. Given the orthonormality of the basis, this means <span class="math display">\[
  Lv_j = v_j \lambda_j,
\]</span> i.e.&nbsp;the canonical decomposition of the Hermitian form is really the same as the eigenvalue decomposition of the associated self-adjoint operator <span class="math inline">\(L\)</span>.</p>
<p>The Hermitian eigenvalue problem has an enormous amount of structure that comes from the fact that it can be interpreted <em>either</em> in terms of a Hermitian form or the associated quadratic <em>or</em> in terms of an operator.</p>
</section>
<section id="a-derivative-example" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="a-derivative-example"><span class="header-section-number">4.4.3</span> A derivative example</h3>
<p>As before, it is useful to consider a specific example that does not involve a concrete vector space. We will use the real symmetric form on <span class="math inline">\(\mathcal{P}_d\)</span> given by <span class="math display">\[
  a(p, q) = \left\langle \frac{dp}{dx}, \frac{dq}{dx} \right\rangle
\]</span> using the <span class="math inline">\(L^2([-1,1])\)</span> inner product between polynomials. Integration by parts implies that <span class="math display">\[\begin{aligned}
  a(p,q)
  &amp;= \int_{-1}^1 \frac{dp}{dx} \frac{dq}{dx} \, dx \\
  &amp;= \left. \frac{dp}{dx} q \right|_{-1}^1 - \int_{-1}^1 \frac{d^2p}{dx^2} q \, dx \\
  &amp;= \left\langle \delta_1 \delta_1^* \frac{dp}{dx}  -
             \delta_{-1} \delta_{-1}^* \frac{dp}{dx} -
             \frac{d^2 p}{dx^2}, q \right\rangle,
\end{aligned}\]</span> where <span class="math inline">\(\delta_1^*\)</span> and <span class="math inline">\(\delta_{-1}^*\)</span> are the evaluation functionals at <span class="math inline">\(\pm 1\)</span> and <span class="math inline">\(\delta_1\)</span> and <span class="math inline">\(\delta_{-1}\)</span> are the associated vectors under the Riesz map. Hence, the self-adjoint linear map associated with the form is <span class="math display">\[
  L = \delta_1 \delta_1^* \frac{d}{dx} - \delta_{-1} \delta_{-1}^*
  \frac{d}{dx} - \frac{d^2}{dx^2}.
\]</span> We can check ourselves by implementing this relation in code</p>
<div id="575de21a" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Implement the L map</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    δp1 <span class="op">=</span> <span class="fu">dualL2_δx</span>( <span class="fl">1.0</span>, d)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    δn1 <span class="op">=</span> <span class="fu">dualL2_δx</span>(<span class="op">-</span><span class="fl">1.0</span>, d)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">L</span>(p)</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>        Dp <span class="op">=</span> <span class="fu">derivative</span>(p)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>        D2p <span class="op">=</span> <span class="fu">derivative</span>(Dp)</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">δp1*Dp</span>(<span class="fl">1</span>) <span class="op">-</span> <span class="fu">δn1*Dp</span>(<span class="op">-</span><span class="fl">1</span>) <span class="op">-</span> D2p</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test polynomials p and q</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">2.0</span>; <span class="op">-</span><span class="fl">3.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    q <span class="op">=</span> <span class="fu">Polynomial</span>([<span class="fl">1.0</span>; <span class="fl">1.0</span>; <span class="fl">1.0</span>])</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test agreement with the form and self-adjointness</span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dotL2</span>(<span class="fu">derivative</span>(p), <span class="fu">derivative</span>(q)) <span class="op">≈</span> <span class="fu">dotL2</span>(<span class="fu">L</span>(p), q),</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dotL2</span>(<span class="fu">L</span>(p), q) <span class="op">≈</span> <span class="fu">dotL2</span>(p, <span class="fu">L</span>(q))</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>(true, true)</code></pre>
</div>
</div>
<p>The form is positive semidefinite, since <span class="math inline">\(a(1,1) = 0\)</span> but <span class="math inline">\(a\)</span> cannot ever by negative (by positive definiteness of the inner product); the inertia is <span class="math inline">\((d, 1, 0)\)</span>. While we can compute the eigenvalues in terms of a matrix derived from <span class="math inline">\(L\)</span>, it is simpler to compute the matrix directly from the form:</p>
<div id="c3d4c9c8" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the matrix in terms of the normalized Legendre polynomials</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    P̄ <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(d)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    AP̄ <span class="op">=</span> <span class="fu">gram</span>(dotL2, <span class="fu">derivative</span>.(P̄))</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the eigendecomposition</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">eigen</span>(AP̄)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> P̄<span class="op">*</span>F.vectors</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check orthonormality of the U basis,</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and that the associated matrix is Λ</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gram</span>(dotL2, U) <span class="op">≈</span> I,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gram</span>(dotL2, <span class="fu">derivative</span>.(U)) <span class="op">≈</span> <span class="fu">Diagonal</span>(F.values)</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>(true, true)</code></pre>
</div>
</div>
<p>Similar to what we saw in our discussion of the singular value decomposition, the <span class="math inline">\(k\)</span>th nonzero eigenvalue converges as a function of <span class="math inline">\(d\)</span> to a limiting value of <span class="math inline">\((k \pi/2)^2\)</span>. We plot the convergence of the first few eigenvalues below:</p>
<div id="9602e0da" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fl">15</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    P̄ <span class="op">=</span> <span class="fu">normalized_legendre_basis</span>(d)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    AP̄ <span class="op">=</span> <span class="fu">gram</span>(dotL2, <span class="fu">derivative</span>.(P̄))</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">plot</span>()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">5</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>        λs <span class="op">=</span> [<span class="fu">eigvals</span>(AP̄[<span class="fl">1</span><span class="op">:</span>n,<span class="fl">1</span><span class="op">:</span>n])[j] for n<span class="op">=</span>j<span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot!</span>(j<span class="op">:</span>d<span class="op">+</span><span class="fl">1</span>, <span class="fu">abs</span>.(λs<span class="op">.-</span>((j<span class="op">-</span><span class="fl">1</span>)<span class="op">*</span><span class="cn">π</span><span class="op">/</span><span class="fl">2</span>)<span class="op">^</span><span class="fl">2</span>),</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>              yscale<span class="op">=:</span>log10, label<span class="op">=</span><span class="st">"λ[</span><span class="sc">$</span>j<span class="st">]"</span>)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip540">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip540)" d="M0 1920 L2688 1920 L2688 -4.26326e-14 L0 -4.26326e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip541">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip540)" d="M216.487 1800.78 L2640.76 1800.78 L2640.76 47.2441 L216.487 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip542">
    <rect x="216" y="47" width="2425" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="366.779,1800.78 366.779,47.2441 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="775.18,1800.78 775.18,47.2441 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1183.58,1800.78 1183.58,47.2441 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1591.98,1800.78 1591.98,47.2441 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2000.38,1800.78 2000.38,47.2441 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2408.78,1800.78 2408.78,47.2441 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="216.487,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="366.779,1800.78 366.779,1781.88 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="775.18,1800.78 775.18,1781.88 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1183.58,1800.78 1183.58,1781.88 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1591.98,1800.78 1591.98,1781.88 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2000.38,1800.78 2000.38,1781.88 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2408.78,1800.78 2408.78,1781.88 "></polyline>
<path clip-path="url(#clip540)" d="M338.515 1861.55 L354.835 1861.55 L354.835 1865.48 L332.89 1865.48 L332.89 1861.55 Q335.552 1858.79 340.136 1854.16 Q344.742 1849.51 345.923 1848.17 Q348.168 1845.65 349.048 1843.91 Q349.95 1842.15 349.95 1840.46 Q349.95 1837.71 348.006 1835.97 Q346.085 1834.23 342.983 1834.23 Q340.784 1834.23 338.33 1835 Q335.9 1835.76 333.122 1837.31 L333.122 1832.59 Q335.946 1831.46 338.4 1830.88 Q340.853 1830.3 342.89 1830.3 Q348.261 1830.3 351.455 1832.98 Q354.649 1835.67 354.649 1840.16 Q354.649 1842.29 353.839 1844.21 Q353.052 1846.11 350.946 1848.7 Q350.367 1849.37 347.265 1852.59 Q344.163 1855.78 338.515 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M364.649 1859.6 L369.534 1859.6 L369.534 1865.48 L364.649 1865.48 L364.649 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M379.765 1830.92 L398.121 1830.92 L398.121 1834.86 L384.047 1834.86 L384.047 1843.33 Q385.066 1842.98 386.085 1842.82 Q387.103 1842.64 388.122 1842.64 Q393.909 1842.64 397.288 1845.81 Q400.668 1848.98 400.668 1854.4 Q400.668 1859.97 397.196 1863.08 Q393.723 1866.15 387.404 1866.15 Q385.228 1866.15 382.96 1865.78 Q380.714 1865.41 378.307 1864.67 L378.307 1859.97 Q380.39 1861.11 382.612 1861.66 Q384.835 1862.22 387.311 1862.22 Q391.316 1862.22 393.654 1860.11 Q395.992 1858.01 395.992 1854.4 Q395.992 1850.78 393.654 1848.68 Q391.316 1846.57 387.311 1846.57 Q385.436 1846.57 383.561 1846.99 Q381.71 1847.4 379.765 1848.28 L379.765 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M742.345 1830.92 L760.701 1830.92 L760.701 1834.86 L746.627 1834.86 L746.627 1843.33 Q747.645 1842.98 748.664 1842.82 Q749.683 1842.64 750.701 1842.64 Q756.488 1842.64 759.868 1845.81 Q763.247 1848.98 763.247 1854.4 Q763.247 1859.97 759.775 1863.08 Q756.303 1866.15 749.983 1866.15 Q747.808 1866.15 745.539 1865.78 Q743.294 1865.41 740.886 1864.67 L740.886 1859.97 Q742.97 1861.11 745.192 1861.66 Q747.414 1862.22 749.891 1862.22 Q753.895 1862.22 756.233 1860.11 Q758.571 1858.01 758.571 1854.4 Q758.571 1850.78 756.233 1848.68 Q753.895 1846.57 749.891 1846.57 Q748.016 1846.57 746.141 1846.99 Q744.289 1847.4 742.345 1848.28 L742.345 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M772.46 1859.6 L777.344 1859.6 L777.344 1865.48 L772.46 1865.48 L772.46 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M797.529 1834 Q793.918 1834 792.09 1837.57 Q790.284 1841.11 790.284 1848.24 Q790.284 1855.34 792.09 1858.91 Q793.918 1862.45 797.529 1862.45 Q801.164 1862.45 802.969 1858.91 Q804.798 1855.34 804.798 1848.24 Q804.798 1841.11 802.969 1837.57 Q801.164 1834 797.529 1834 M797.529 1830.3 Q803.34 1830.3 806.395 1834.9 Q809.474 1839.49 809.474 1848.24 Q809.474 1856.96 806.395 1861.57 Q803.34 1866.15 797.529 1866.15 Q791.719 1866.15 788.641 1861.57 Q785.585 1856.96 785.585 1848.24 Q785.585 1839.49 788.641 1834.9 Q791.719 1830.3 797.529 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1149.9 1830.92 L1172.12 1830.92 L1172.12 1832.91 L1159.58 1865.48 L1154.69 1865.48 L1166.5 1834.86 L1149.9 1834.86 L1149.9 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1181.24 1859.6 L1186.13 1859.6 L1186.13 1865.48 L1181.24 1865.48 L1181.24 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1196.36 1830.92 L1214.72 1830.92 L1214.72 1834.86 L1200.64 1834.86 L1200.64 1843.33 Q1201.66 1842.98 1202.68 1842.82 Q1203.7 1842.64 1204.72 1842.64 Q1210.5 1842.64 1213.88 1845.81 Q1217.26 1848.98 1217.26 1854.4 Q1217.26 1859.97 1213.79 1863.08 Q1210.32 1866.15 1204 1866.15 Q1201.82 1866.15 1199.55 1865.78 Q1197.31 1865.41 1194.9 1864.67 L1194.9 1859.97 Q1196.98 1861.11 1199.21 1861.66 Q1201.43 1862.22 1203.91 1862.22 Q1207.91 1862.22 1210.25 1860.11 Q1212.59 1858.01 1212.59 1854.4 Q1212.59 1850.78 1210.25 1848.68 Q1207.91 1846.57 1203.91 1846.57 Q1202.03 1846.57 1200.16 1846.99 Q1198.3 1847.4 1196.36 1848.28 L1196.36 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1544.05 1861.55 L1551.69 1861.55 L1551.69 1835.18 L1543.38 1836.85 L1543.38 1832.59 L1551.65 1830.92 L1556.32 1830.92 L1556.32 1861.55 L1563.96 1861.55 L1563.96 1865.48 L1544.05 1865.48 L1544.05 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1583.41 1834 Q1579.79 1834 1577.97 1837.57 Q1576.16 1841.11 1576.16 1848.24 Q1576.16 1855.34 1577.97 1858.91 Q1579.79 1862.45 1583.41 1862.45 Q1587.04 1862.45 1588.85 1858.91 Q1590.67 1855.34 1590.67 1848.24 Q1590.67 1841.11 1588.85 1837.57 Q1587.04 1834 1583.41 1834 M1583.41 1830.3 Q1589.22 1830.3 1592.27 1834.9 Q1595.35 1839.49 1595.35 1848.24 Q1595.35 1856.96 1592.27 1861.57 Q1589.22 1866.15 1583.41 1866.15 Q1577.6 1866.15 1574.52 1861.57 Q1571.46 1856.96 1571.46 1848.24 Q1571.46 1839.49 1574.52 1834.9 Q1577.6 1830.3 1583.41 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1603.57 1859.6 L1608.45 1859.6 L1608.45 1865.48 L1603.57 1865.48 L1603.57 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1628.64 1834 Q1625.03 1834 1623.2 1837.57 Q1621.39 1841.11 1621.39 1848.24 Q1621.39 1855.34 1623.2 1858.91 Q1625.03 1862.45 1628.64 1862.45 Q1632.27 1862.45 1634.08 1858.91 Q1635.91 1855.34 1635.91 1848.24 Q1635.91 1841.11 1634.08 1837.57 Q1632.27 1834 1628.64 1834 M1628.64 1830.3 Q1634.45 1830.3 1637.5 1834.9 Q1640.58 1839.49 1640.58 1848.24 Q1640.58 1856.96 1637.5 1861.57 Q1634.45 1866.15 1628.64 1866.15 Q1622.83 1866.15 1619.75 1861.57 Q1616.69 1856.96 1616.69 1848.24 Q1616.69 1839.49 1619.75 1834.9 Q1622.83 1830.3 1628.64 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1952.95 1861.55 L1960.59 1861.55 L1960.59 1835.18 L1952.28 1836.85 L1952.28 1832.59 L1960.55 1830.92 L1965.22 1830.92 L1965.22 1861.55 L1972.86 1861.55 L1972.86 1865.48 L1952.95 1865.48 L1952.95 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M1986.33 1861.55 L2002.65 1861.55 L2002.65 1865.48 L1980.71 1865.48 L1980.71 1861.55 Q1983.37 1858.79 1987.95 1854.16 Q1992.56 1849.51 1993.74 1848.17 Q1995.98 1845.65 1996.86 1843.91 Q1997.77 1842.15 1997.77 1840.46 Q1997.77 1837.71 1995.82 1835.97 Q1993.9 1834.23 1990.8 1834.23 Q1988.6 1834.23 1986.15 1835 Q1983.72 1835.76 1980.94 1837.31 L1980.94 1832.59 Q1983.76 1831.46 1986.22 1830.88 Q1988.67 1830.3 1990.71 1830.3 Q1996.08 1830.3 1999.27 1832.98 Q2002.47 1835.67 2002.47 1840.16 Q2002.47 1842.29 2001.66 1844.21 Q2000.87 1846.11 1998.76 1848.7 Q1998.18 1849.37 1995.08 1852.59 Q1991.98 1855.78 1986.33 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2012.47 1859.6 L2017.35 1859.6 L2017.35 1865.48 L2012.47 1865.48 L2012.47 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2027.58 1830.92 L2045.94 1830.92 L2045.94 1834.86 L2031.86 1834.86 L2031.86 1843.33 Q2032.88 1842.98 2033.9 1842.82 Q2034.92 1842.64 2035.94 1842.64 Q2041.73 1842.64 2045.11 1845.81 Q2048.48 1848.98 2048.48 1854.4 Q2048.48 1859.97 2045.01 1863.08 Q2041.54 1866.15 2035.22 1866.15 Q2033.04 1866.15 2030.78 1865.78 Q2028.53 1865.41 2026.12 1864.67 L2026.12 1859.97 Q2028.21 1861.11 2030.43 1861.66 Q2032.65 1862.22 2035.13 1862.22 Q2039.13 1862.22 2041.47 1860.11 Q2043.81 1858.01 2043.81 1854.4 Q2043.81 1850.78 2041.47 1848.68 Q2039.13 1846.57 2035.13 1846.57 Q2033.25 1846.57 2031.38 1846.99 Q2029.53 1847.4 2027.58 1848.28 L2027.58 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2360.86 1861.55 L2368.49 1861.55 L2368.49 1835.18 L2360.18 1836.85 L2360.18 1832.59 L2368.45 1830.92 L2373.12 1830.92 L2373.12 1861.55 L2380.76 1861.55 L2380.76 1865.48 L2360.86 1865.48 L2360.86 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2390.25 1830.92 L2408.61 1830.92 L2408.61 1834.86 L2394.54 1834.86 L2394.54 1843.33 Q2395.56 1842.98 2396.57 1842.82 Q2397.59 1842.64 2398.61 1842.64 Q2404.4 1842.64 2407.78 1845.81 Q2411.16 1848.98 2411.16 1854.4 Q2411.16 1859.97 2407.68 1863.08 Q2404.21 1866.15 2397.89 1866.15 Q2395.72 1866.15 2393.45 1865.78 Q2391.2 1865.41 2388.8 1864.67 L2388.8 1859.97 Q2390.88 1861.11 2393.1 1861.66 Q2395.32 1862.22 2397.8 1862.22 Q2401.8 1862.22 2404.14 1860.11 Q2406.48 1858.01 2406.48 1854.4 Q2406.48 1850.78 2404.14 1848.68 Q2401.8 1846.57 2397.8 1846.57 Q2395.93 1846.57 2394.05 1846.99 Q2392.2 1847.4 2390.25 1848.28 L2390.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2420.37 1859.6 L2425.25 1859.6 L2425.25 1865.48 L2420.37 1865.48 L2420.37 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2445.44 1834 Q2441.83 1834 2440 1837.57 Q2438.19 1841.11 2438.19 1848.24 Q2438.19 1855.34 2440 1858.91 Q2441.83 1862.45 2445.44 1862.45 Q2449.07 1862.45 2450.88 1858.91 Q2452.71 1855.34 2452.71 1848.24 Q2452.71 1841.11 2450.88 1837.57 Q2449.07 1834 2445.44 1834 M2445.44 1830.3 Q2451.25 1830.3 2454.3 1834.9 Q2457.38 1839.49 2457.38 1848.24 Q2457.38 1856.96 2454.3 1861.57 Q2451.25 1866.15 2445.44 1866.15 Q2439.63 1866.15 2436.55 1861.57 Q2433.49 1856.96 2433.49 1848.24 Q2433.49 1839.49 2436.55 1834.9 Q2439.63 1830.3 2445.44 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="216.487,1281.7 2640.76,1281.7 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="216.487,272.9 2640.76,272.9 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="216.487,1800.78 216.487,47.2441 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="216.487,1281.7 235.385,1281.7 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="216.487,272.9 235.385,272.9 "></polyline>
<path clip-path="url(#clip540)" d="M50.2234 1301.49 L57.8623 1301.49 L57.8623 1275.13 L49.5521 1276.79 L49.5521 1272.53 L57.816 1270.87 L62.4919 1270.87 L62.4919 1301.49 L70.1307 1301.49 L70.1307 1305.43 L50.2234 1305.43 L50.2234 1301.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M89.5751 1273.95 Q85.964 1273.95 84.1353 1277.51 Q82.3297 1281.05 82.3297 1288.18 Q82.3297 1295.29 84.1353 1298.85 Q85.964 1302.4 89.5751 1302.4 Q93.2093 1302.4 95.0148 1298.85 Q96.8435 1295.29 96.8435 1288.18 Q96.8435 1281.05 95.0148 1277.51 Q93.2093 1273.95 89.5751 1273.95 M89.5751 1270.24 Q95.3852 1270.24 98.4408 1274.85 Q101.519 1279.43 101.519 1288.18 Q101.519 1296.91 98.4408 1301.52 Q95.3852 1306.1 89.5751 1306.1 Q83.7649 1306.1 80.6862 1301.52 Q77.6307 1296.91 77.6307 1288.18 Q77.6307 1279.43 80.6862 1274.85 Q83.7649 1270.24 89.5751 1270.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M101.519 1264.34 L125.631 1264.34 L125.631 1267.54 L101.519 1267.54 L101.519 1264.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M134.489 1274.82 L140.696 1274.82 L140.696 1253.4 L133.944 1254.75 L133.944 1251.29 L140.658 1249.94 L144.458 1249.94 L144.458 1274.82 L150.664 1274.82 L150.664 1278.02 L134.489 1278.02 L134.489 1274.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M166.463 1252.44 Q163.529 1252.44 162.043 1255.33 Q160.576 1258.21 160.576 1264.01 Q160.576 1269.78 162.043 1272.68 Q163.529 1275.55 166.463 1275.55 Q169.415 1275.55 170.882 1272.68 Q172.368 1269.78 172.368 1264.01 Q172.368 1258.21 170.882 1255.33 Q169.415 1252.44 166.463 1252.44 M166.463 1249.43 Q171.183 1249.43 173.666 1253.17 Q176.167 1256.9 176.167 1264.01 Q176.167 1271.1 173.666 1274.84 Q171.183 1278.56 166.463 1278.56 Q161.742 1278.56 159.24 1274.84 Q156.758 1271.1 156.758 1264.01 Q156.758 1256.9 159.24 1253.17 Q161.742 1249.43 166.463 1249.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M105.462 292.693 L113.101 292.693 L113.101 266.327 L104.791 267.994 L104.791 263.734 L113.054 262.068 L117.73 262.068 L117.73 292.693 L125.369 292.693 L125.369 296.628 L105.462 296.628 L105.462 292.693 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M144.813 265.146 Q141.202 265.146 139.374 268.711 Q137.568 272.253 137.568 279.382 Q137.568 286.489 139.374 290.054 Q141.202 293.595 144.813 293.595 Q148.448 293.595 150.253 290.054 Q152.082 286.489 152.082 279.382 Q152.082 272.253 150.253 268.711 Q148.448 265.146 144.813 265.146 M144.813 261.443 Q150.624 261.443 153.679 266.049 Q156.758 270.632 156.758 279.382 Q156.758 288.109 153.679 292.716 Q150.624 297.299 144.813 297.299 Q139.003 297.299 135.925 292.716 Q132.869 288.109 132.869 279.382 Q132.869 270.632 135.925 266.049 Q139.003 261.443 144.813 261.443 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M166.463 243.639 Q163.529 243.639 162.043 246.535 Q160.576 249.413 160.576 255.206 Q160.576 260.979 162.043 263.876 Q163.529 266.753 166.463 266.753 Q169.415 266.753 170.882 263.876 Q172.368 260.979 172.368 255.206 Q172.368 249.413 170.882 246.535 Q169.415 243.639 166.463 243.639 M166.463 240.629 Q171.183 240.629 173.666 244.372 Q176.167 248.096 176.167 255.206 Q176.167 262.296 173.666 266.039 Q171.183 269.763 166.463 269.763 Q161.742 269.763 159.24 266.039 Q156.758 262.296 156.758 255.206 Q156.758 248.096 159.24 244.372 Q161.742 240.629 166.463 240.629 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip542)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="285.099,300.501 448.459,300.501 611.82,561.643 775.18,561.643 938.54,896.956 1101.9,896.956 1265.26,1289.46 1428.62,1289.49 1591.98,1743.16 1755.34,1725.4 1918.7,1602.73 2082.06,1751.15 2245.42,1629.68 2408.78,1688.28 2572.14,1573.86 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="448.459,201.26 611.82,201.26 775.18,388.409 938.54,388.409 1101.9,624.118 1265.26,624.118 1428.62,912.594 1591.98,912.594 1755.34,1240.91 1918.7,1240.88 2082.06,1541.7 2245.42,1587.82 2408.78,1563.78 2572.14,1682.43 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="611.82,140.947 775.18,140.947 938.54,295.298 1101.9,295.298 1265.26,477.654 1428.62,477.654 1591.98,708.655 1755.34,708.655 1918.7,977.922 2082.06,977.922 2245.42,1277.8 2408.78,1277.79 2572.14,1506.07 "></polyline>
<polyline clip-path="url(#clip542)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="775.18,96.8724 938.54,96.8724 1101.9,232.74 1265.26,232.74 1428.62,380.71 1591.98,380.71 1755.34,572.212 1918.7,572.212 2082.06,801.084 2245.42,801.084 2408.78,1059.76 2572.14,1059.76 "></polyline>
<path clip-path="url(#clip540)" d="M2227.8 364.895 L2559.95 364.895 L2559.95 105.695 L2227.8 105.695  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip540)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2227.8,364.895 2559.95,364.895 2559.95,105.695 2227.8,105.695 2227.8,364.895 "></polyline>
<polyline clip-path="url(#clip540)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2254.73,157.535 2416.35,157.535 "></polyline>
<path clip-path="url(#clip540)" d="M2456.55 142.848 L2468.52 174.815 L2464.01 174.815 L2456.74 155.649 L2447.8 174.815 L2443.29 174.815 L2454.65 149.954 L2452.94 145.371 Q2451.85 142.454 2449.38 142.454 L2447.15 142.454 L2447.15 138.797 L2449.86 138.843 Q2455.09 138.913 2456.55 142.848 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2474.01 138.797 L2483.82 138.797 L2483.82 142.107 L2478.27 142.107 L2478.27 177.755 L2483.82 177.755 L2483.82 181.065 L2474.01 181.065 L2474.01 138.797 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2497.52 170.88 L2513.84 170.88 L2513.84 174.815 L2491.9 174.815 L2491.9 170.88 Q2494.56 168.125 2499.15 163.496 Q2503.75 158.843 2504.93 157.501 Q2507.18 154.977 2508.06 153.241 Q2508.96 151.482 2508.96 149.792 Q2508.96 147.038 2507.02 145.302 Q2505.09 143.565 2501.99 143.565 Q2499.79 143.565 2497.34 144.329 Q2494.91 145.093 2492.13 146.644 L2492.13 141.922 Q2494.96 140.788 2497.41 140.209 Q2499.86 139.63 2501.9 139.63 Q2507.27 139.63 2510.46 142.315 Q2513.66 145.001 2513.66 149.491 Q2513.66 151.621 2512.85 153.542 Q2512.06 155.44 2509.96 158.033 Q2509.38 158.704 2506.27 161.922 Q2503.17 165.116 2497.52 170.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2533.01 138.797 L2533.01 181.065 L2523.2 181.065 L2523.2 177.755 L2528.73 177.755 L2528.73 142.107 L2523.2 142.107 L2523.2 138.797 L2533.01 138.797 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip540)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2254.73,209.375 2416.35,209.375 "></polyline>
<path clip-path="url(#clip540)" d="M2456.55 194.688 L2468.52 226.655 L2464.01 226.655 L2456.74 207.489 L2447.8 226.655 L2443.29 226.655 L2454.65 201.794 L2452.94 197.211 Q2451.85 194.294 2449.38 194.294 L2447.15 194.294 L2447.15 190.637 L2449.86 190.683 Q2455.09 190.753 2456.55 194.688 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2474.01 190.637 L2483.82 190.637 L2483.82 193.947 L2478.27 193.947 L2478.27 229.595 L2483.82 229.595 L2483.82 232.905 L2474.01 232.905 L2474.01 190.637 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2507.66 208.021 Q2511.02 208.739 2512.9 211.007 Q2514.79 213.276 2514.79 216.609 Q2514.79 221.725 2511.27 224.526 Q2507.76 227.327 2501.27 227.327 Q2499.1 227.327 2496.78 226.887 Q2494.49 226.47 2492.04 225.614 L2492.04 221.1 Q2493.98 222.234 2496.3 222.813 Q2498.61 223.391 2501.14 223.391 Q2505.53 223.391 2507.83 221.655 Q2510.14 219.919 2510.14 216.609 Q2510.14 213.553 2507.99 211.841 Q2505.86 210.104 2502.04 210.104 L2498.01 210.104 L2498.01 206.262 L2502.22 206.262 Q2505.67 206.262 2507.5 204.896 Q2509.33 203.507 2509.33 200.915 Q2509.33 198.253 2507.43 196.841 Q2505.56 195.405 2502.04 195.405 Q2500.12 195.405 2497.92 195.822 Q2495.72 196.239 2493.08 197.118 L2493.08 192.952 Q2495.74 192.211 2498.06 191.841 Q2500.4 191.47 2502.46 191.47 Q2507.78 191.47 2510.88 193.901 Q2513.98 196.308 2513.98 200.429 Q2513.98 203.299 2512.34 205.29 Q2510.7 207.257 2507.66 208.021 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2533.01 190.637 L2533.01 232.905 L2523.2 232.905 L2523.2 229.595 L2528.73 229.595 L2528.73 193.947 L2523.2 193.947 L2523.2 190.637 L2533.01 190.637 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip540)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2254.73,261.215 2416.35,261.215 "></polyline>
<path clip-path="url(#clip540)" d="M2456.55 246.528 L2468.52 278.495 L2464.01 278.495 L2456.74 259.329 L2447.8 278.495 L2443.29 278.495 L2454.65 253.634 L2452.94 249.051 Q2451.85 246.134 2449.38 246.134 L2447.15 246.134 L2447.15 242.477 L2449.86 242.523 Q2455.09 242.593 2456.55 246.528 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2474.01 242.477 L2483.82 242.477 L2483.82 245.787 L2478.27 245.787 L2478.27 281.435 L2483.82 281.435 L2483.82 284.745 L2474.01 284.745 L2474.01 242.477 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2506.34 248.009 L2494.54 266.458 L2506.34 266.458 L2506.34 248.009 M2505.12 243.935 L2511 243.935 L2511 266.458 L2515.93 266.458 L2515.93 270.347 L2511 270.347 L2511 278.495 L2506.34 278.495 L2506.34 270.347 L2490.74 270.347 L2490.74 265.833 L2505.12 243.935 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2533.01 242.477 L2533.01 284.745 L2523.2 284.745 L2523.2 281.435 L2528.73 281.435 L2528.73 245.787 L2523.2 245.787 L2523.2 242.477 L2533.01 242.477 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip540)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2254.73,313.055 2416.35,313.055 "></polyline>
<path clip-path="url(#clip540)" d="M2456.55 298.368 L2468.52 330.335 L2464.01 330.335 L2456.74 311.169 L2447.8 330.335 L2443.29 330.335 L2454.65 305.474 L2452.94 300.891 Q2451.85 297.974 2449.38 297.974 L2447.15 297.974 L2447.15 294.317 L2449.86 294.363 Q2455.09 294.433 2456.55 298.368 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2474.01 294.317 L2483.82 294.317 L2483.82 297.627 L2478.27 297.627 L2478.27 333.275 L2483.82 333.275 L2483.82 336.585 L2474.01 336.585 L2474.01 294.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2493.54 295.775 L2511.9 295.775 L2511.9 299.71 L2497.83 299.71 L2497.83 308.183 Q2498.84 307.835 2499.86 307.673 Q2500.88 307.488 2501.9 307.488 Q2507.69 307.488 2511.07 310.659 Q2514.45 313.831 2514.45 319.247 Q2514.45 324.826 2510.97 327.928 Q2507.5 331.007 2501.18 331.007 Q2499.01 331.007 2496.74 330.636 Q2494.49 330.266 2492.08 329.525 L2492.08 324.826 Q2494.17 325.96 2496.39 326.516 Q2498.61 327.071 2501.09 327.071 Q2505.09 327.071 2507.43 324.965 Q2509.77 322.858 2509.77 319.247 Q2509.77 315.636 2507.43 313.53 Q2505.09 311.423 2501.09 311.423 Q2499.21 311.423 2497.34 311.84 Q2495.49 312.257 2493.54 313.136 L2493.54 295.775 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip540)" d="M2533.01 294.317 L2533.01 336.585 L2523.2 336.585 L2523.2 333.275 L2528.73 333.275 L2528.73 297.627 L2523.2 297.627 L2523.2 294.317 L2533.01 294.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</section>
</section>
<section id="sec-tensor-bg-sec" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-tensor-bg-sec"><span class="header-section-number">4.5</span> Tensors and determinants</h2>
<p>So far, we have dealt with linear, bilinear, sesquilinear, and quadratic functions on vector spaces. Going beyond this to functions that are linear in several arguments takes us into the land of <em>tensors</em>.</p>
<section id="takes-on-tensors" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="takes-on-tensors"><span class="header-section-number">4.5.1</span> Takes on tensors</h3>
<p>There are several ways to approach tensors. In much of numerical analysis, only tensors of concrete spaces are considered, and tensors are treated as arrays of multi-dimensional arrays of numbers (with matrices as a special case where there are two dimensions used for indexing). For example, a tensor with three indices is represented by an element <span class="math inline">\(a_{ijk}\)</span> of <span class="math inline">\(\mathbb{F}^{m \times n \times p}\)</span>. We will see this perspective in detail later, both in our discussion of numerical linear algebra and in our discussion of tensors in latent factor models.</p>
<p>Here, though, we will focus on tensors as basic objects of <em>multilinear</em> algebra. There are still several ways to approach this:</p>
<ul>
<li><p>We can consider tensors purely in terms of bases, along with change-of-basis rules. This view, common in some corners of physics, says that “a tensor is an object that transforms like a tensor,” a perspective similar to “a vector is an object that transforms like a vector” that we mentioned earlier. We will prefer a discussion that gives changes of basis as a consequence of a more fundamental definition, rather than as the definition itself.</p></li>
<li><p>We can consider tensors from an algebraic perspective as a quotient space: the <em>tensor product</em> space <span class="math inline">\(\mathcal{V}\otimes \mathcal{W}\)</span> is a vector space spanned by elements of the Cartesian product <span class="math inline">\(\mathcal{V}\times
\mathcal{W}\)</span>, modulo the equivalence relations <span class="math display">\[\begin{aligned}
  \alpha (v, w) &amp;\sim (\alpha v, w) \sim (v, \alpha w) \\
  (u+v, w) &amp;\sim (u,w) + (v,w) \\
  (u, v+w) &amp;\sim (u,v) + (u,w)
\end{aligned}\]</span> We write <span class="math inline">\(v \otimes w\)</span> to denote the equivalence class associated with <span class="math inline">\((v,w)\)</span>. While this definition has the advantage of being very general (it can generalize to structures other than vector spaces) and it does not depending on a basis, it can be a bit overly abstract.</p></li>
<li><p>We will mostly consider tensors as <em>multilinear forms</em>, generalizing the notion of bilinear forms discussed above. This has the advantage of extending our discussion of bilinear and sesquilinear forms from earlier, remaining abstracted away from a specific basis while not too abstract.</p></li>
</ul>
</section>
<section id="multilinear-forms" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="multilinear-forms"><span class="header-section-number">4.5.2</span> Multilinear forms</h3>
<p>Let <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> be two vector spaces. For any <span class="math inline">\(u \in \mathcal{U}\)</span> and <span class="math inline">\(w^* \in \mathcal{V}^*\)</span>, the <em>outer product</em> <span class="math inline">\(uw^*\)</span> is associated with a rank 1 map in <span class="math inline">\(L(\mathcal{V}, \mathcal{U})\)</span> given by <span class="math inline">\(v \mapsto u w^* v\)</span>. Alternately, we can see <span class="math inline">\(uw^*\)</span> as a bilinear map from <span class="math inline">\(\mathcal{U}^* \times
\mathcal{V}\rightarrow \mathbb{F}\)</span> given by <span class="math inline">\((f^*, v) \mapsto f^* u w^* v\)</span>; or we can see <span class="math inline">\(uw^*\)</span> as a dual map in <span class="math inline">\(L(\mathcal{U}^*, \mathcal{V}^*)\)</span> given by <span class="math inline">\(f^* \mapsto f^* u w^*\)</span>. We will use the uniform notation <span class="math inline">\(u \otimes w^*\)</span> to cover all of these possible interpretations of the outer product.</p>
<p>More generally, let <span class="math inline">\(\mathcal{V}_1, \mathcal{V}_2, \ldots, \mathcal{V}_d\)</span> be vector spaces. Then for any vectors <span class="math inline">\(v_1, v_2, \ldots, v_d\)</span> in these spaces, the tensor product <span class="math inline">\(v_1 \otimes v_2 \otimes \ldots \otimes v_d\)</span> can be interpreted as the multilinear map from <span class="math inline">\(\mathcal{V}_1^* \times
\mathcal{V}_2^* \times \ldots \mathcal{V}_d^* \rightarrow \mathbb{F}\)</span> given by <span class="math display">\[
  (v_1 \otimes v_2 \otimes \ldots \otimes v_d)(w_1^*, w_2^*, \ldots,
  w_d^*) =
  (w_1^* v_1) (w_2^* v_d) \ldots (w_d^* v_d).
\]</span> As in the case of just two vector spaces, we can define other maps by partial evaluation. For example, we can consider this as a map from <span class="math inline">\(\mathcal{V}_2^* \times \ldots \times \mathcal{V}_d^* \rightarrow \mathcal{V}_1\)</span> by <span class="math display">\[
  (w_d^*, \ldots, w_d^*) \mapsto a(\cdot, w_2^*, \ldots, w_d^*)
\]</span> where “filling in” all but the first argument gives an element of <span class="math inline">\(\mathcal{V}_1\)</span> (or technically of <span class="math inline">\(\mathcal{V}_1^{**}\)</span>, but this is isomorphic<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> to <span class="math inline">\(\mathcal{V}_1\)</span>).</p>
<p>The vector space of all multilinear forms <span class="math inline">\(\mathcal{V}_1^* \times \ldots
\mathcal{V}_d^* \rightarrow \mathbb{F}\)</span> is written as <span class="math inline">\(\mathcal{V}_1 \otimes \ldots \otimes \mathcal{V}_d\)</span>. If <span class="math inline">\(\mathcal{V}_j\)</span> has a basis <span class="math inline">\(V^{(j)}\)</span> and associated dual basis <span class="math inline">\((W^{(j)})^*\)</span>, then an arbitrary element <span class="math inline">\(a \in \mathcal{V}_1 \otimes \ldots \otimes
\mathcal{V}_d\)</span> can be written uniquely as <span class="math display">\[
  a = \sum_{i_1, \ldots, i_d} a_{i_1 \ldots i_d} \, v_{i_1}^{(1)} \otimes
  \ldots \otimes v_{i_d}^{(d)}.
\]</span> where <span class="math display">\[
  a_{i_1 \ldots i_d} = a(w_{i_1}^{(1)*}, \ldots w_{i_d}^{(d)*}).
\]</span> That is, the set of all tensor products of basis vectors for the spaces <span class="math inline">\(\mathcal{V}_j\)</span> form a basis for the tensor product space <span class="math inline">\(\mathcal{V}_1 \otimes \ldots \otimes \mathcal{V}_d\)</span>.</p>
<p>In terms of the partial evaluation operation discussed above, we might consider <span class="math inline">\(a\)</span> as a map from <span class="math inline">\(\mathcal{V}_2^* \otimes \ldots \otimes
\mathcal{V}_d^*\)</span> to <span class="math inline">\(\mathcal{V}_1\)</span> by taking <span class="math display">\[\begin{aligned}
  b &amp;= \sum_{i_2, \ldots, i_d} b_{i_2 \ldots i_d} \,
  w_{i_2}^{(2)*} \otimes w_{i_d}^{(d)*} \\
  &amp;\mapsto
  \sum_{i_2, \ldots, i_d} b_{i_2 \ldots i_d} \,
  a(\cdot, w_{i_2}^{(2)*}, \ldots w_{i_d}^{(d)*}) \\
  &amp;=
  \sum_{i_1, i_2, \ldots, i_d} v_{i_1}^{(1)} \, a_{i_1 \ldots i_d} b_{i_2 \ldots i_d}.
\end{aligned}\]</span> This generalized partial evaluation operation is known as a <em>tensor contraction</em>. In general, we can contract two tensors on any pairs of “slots” in the form that take vectors from a dual pair of spaces.</p>
<p>When a real inner product space <span class="math inline">\(\mathcal{V}\)</span> appears in a tensor, we can construct a new tensor in which <span class="math inline">\(\mathcal{V}^*\)</span> appears in the same slot by composing that slot with the inverse Riesz map (“lowering the index” in the physics parlance). Similarly, we can convert a <span class="math inline">\(\mathcal{V}^*\)</span> slot to a <span class="math inline">\(\mathcal{V}\)</span> slot via the Riesz map (“raising the index”). When a tensor is represented with respect to orthonormal bases, raising or lowering operations do not change any of the coefficients.</p>
<p>It is tempting to ask if the coefficients might be made simple by a special choices of the bases for the component spaces, analogous to the anonical forms we discussed before. Unfortunately, tensors beyond bilinear forms lack any nice canonical representation.</p>
</section>
<section id="polynomial-products" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="polynomial-products"><span class="header-section-number">4.5.3</span> Polynomial products</h3>
<p>As an example of tensor product spaces in action, we consider the space of polynomials in three variables with maximum degree per variable of <span class="math inline">\(d\)</span>. In the power basis, we would write this as <span class="math display">\[
  \mathcal{P}_d \otimes \mathcal{P}_d \otimes \mathcal{P}_d =
  \left\{ \sum_{i,j,k} c_{ijk} x^i y^j z^k : c_{ijk} \in \mathbb{R}^{d \times d
  \times d} \right\}.
\]</span> Evaluating a polynomial <span class="math inline">\(p \in \mathcal{P}_d \otimes \mathcal{P}_d \otimes
\mathcal{P}_d\)</span> at a particular point <span class="math inline">\((\alpha, \beta, \gamma)\)</span> is associated with evaluation of a trilinear form, or equivalently with contraction against a tensor in <span class="math inline">\(\mathcal{P}_d^* \otimes \mathcal{P}_d^* \otimes
\mathcal{P}_d^*\)</span>; i.e. <span class="math display">\[
  p \cdot (\delta_{\alpha}^* \otimes \delta_{\beta}^* \otimes \delta_{\gamma}^*)
\]</span> We can similarly think about contracting in some slots but not others, or contracting against other linear functionals (like integration).</p>
<p>For concrete tensors, contractions can also be used to express operations like changing basis. For example, if <span class="math inline">\(T_{0:d} A = X_{0:d}\)</span>, we can write <span class="math display">\[\begin{aligned}
  p(x,y,z) &amp;= \sum_{i,j,k} c_{ijk} \, x^i y^j z^k \\
  &amp;= \sum_{l,m,n} d_{lmn} \, T_l(x) T_m(y) T_n(z) \\
  d_{lmn} &amp;=
  \sum_{i,j,k} c_{ijk} a_{li} a_{jm} a_{kn}
\end{aligned}\]</span> That is, we change bases by applying <span class="math inline">\(A\)</span> on each “fiber” of the coefficient tensor (i.e.&nbsp;a vector associated with holding two indices fixed and letting the other vary). Indeed, the transformation from the <span class="math inline">\(c_{ijk}\)</span> to the <span class="math inline">\(d_{lmn}\)</span> coefficients is most easily coded in terms of such a matrix operation:</p>
<div id="8141b651" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    d <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> <span class="fu">rand</span>(d<span class="op">+</span><span class="fl">1</span>,d<span class="op">+</span><span class="fl">1</span>,d<span class="op">+</span><span class="fl">1</span>)  <span class="co"># Power coeffs</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Transform to the Chebyshev coefficients</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>    D <span class="op">=</span> <span class="fu">copy</span>(C)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> <span class="fu">chebyshev_power_coeffs</span>(d)  <span class="co"># A = inv(M)</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Contract with a_li</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>            D[<span class="op">:</span>,j,k] <span class="op">=</span> M<span class="op">\</span>D[<span class="op">:</span>,j,k]</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Contract with a_mj</span></span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>            D[i,<span class="op">:</span>,k] <span class="op">=</span> M<span class="op">\</span>D[i,<span class="op">:</span>,k]</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Contract with a_nk</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a>            D[i,j,<span class="op">:</span>] <span class="op">=</span> M<span class="op">\</span>D[i,j,<span class="op">:</span>]</span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb113-29"><a href="#cb113-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-30"><a href="#cb113-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check correctness by comparing evaluations a random point</span></span>
<span id="cb113-31"><a href="#cb113-31" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> <span class="fu">chebyshev_basis</span>(d)</span>
<span id="cb113-32"><a href="#cb113-32" aria-hidden="true" tabindex="-1"></a>    x,y,z <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">3</span>)</span>
<span id="cb113-33"><a href="#cb113-33" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb113-34"><a href="#cb113-34" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb113-35"><a href="#cb113-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-36"><a href="#cb113-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-37"><a href="#cb113-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k<span class="op">=</span><span class="fl">1</span><span class="op">:</span>d<span class="op">+</span><span class="fl">1</span></span>
<span id="cb113-38"><a href="#cb113-38" aria-hidden="true" tabindex="-1"></a>                p1 <span class="op">+=</span> C[i,j,k] <span class="op">*</span> x<span class="op">^</span>(i<span class="op">-</span><span class="fl">1</span>) <span class="op">*</span> y<span class="op">^</span>(j<span class="op">-</span><span class="fl">1</span>) <span class="op">*</span> z<span class="op">^</span>(k<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb113-39"><a href="#cb113-39" aria-hidden="true" tabindex="-1"></a>                p2 <span class="op">+=</span> D[i,j,k] <span class="op">*</span> T[i](x) <span class="op">*</span> T[j](y) <span class="op">*</span> T[k](z)</span>
<span id="cb113-40"><a href="#cb113-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb113-41"><a href="#cb113-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb113-42"><a href="#cb113-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb113-43"><a href="#cb113-43" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">≈</span> p2</span>
<span id="cb113-44"><a href="#cb113-44" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>true</code></pre>
</div>
</div>
</section>
<section id="alternating-forms" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="alternating-forms"><span class="header-section-number">4.5.4</span> Alternating forms</h3>
<p>An <em>alternating form</em> is a multilinear form on several copies of the same vector space <span class="math inline">\(\mathcal{V}\)</span> with the property that it is zero if any input is repeated. This implies that swapping the order of any pair of arguments reverses the sign; for example, if <span class="math inline">\(a : \mathcal{V}\times \mathcal{V}
\times \mathcal{V}\rightarrow \mathbb{F}\)</span> is a multilinear form, then <span class="math display">\[\begin{aligned}
  a(u, v, w) + a(w, v, u)
  &amp;= a(u, v, w) + a(u, v, u) + a(w, v, w) + a(w, v, u) \\
  &amp;= a(u, v, w+u) + a(w, v, w+u) \\
  &amp;= a(u+w, v, w+u) \\
  &amp;= 0.
\end{aligned}\]</span> The set of all alternating forms on <span class="math inline">\(k\)</span> copies of <span class="math inline">\(\mathcal{V}\)</span> is written as <span class="math inline">\(\mathcal{V}^* \wedge \ldots \wedge \mathcal{V}^*\)</span>, a subspace of <span class="math inline">\(\mathcal{V}^* \otimes \ldots \otimes \mathcal{V}^*\)</span>.</p>
<p>The <em>wedge product</em> of two tensors over copies of the same space is <span class="math display">\[
  f \wedge g = f \otimes g - g \otimes f.
\]</span> Alternating forms of a given number of arguments also form a vector space. For example, <span class="math inline">\(\mathcal{V}^* \wedge \mathcal{V}^* \wedge \mathcal{V}^*\)</span> has a basis of vectors <span class="math inline">\(w_i^* \wedge w_j^* \wedge w_k^*\)</span> for each possible subset <span class="math inline">\(\{i, j, k\}\)</span> of three distinct indices from the range <span class="math inline">\(1, \ldots, n\)</span>. Hence, it has dimension <span class="math inline">\(n\)</span> choose <span class="math inline">\(3\)</span>.</p>
<p>If <span class="math inline">\(\mathcal{V}\)</span> is <span class="math inline">\(n\)</span>-dimensional, the space of <span class="math inline">\(n\)</span> copies of <span class="math inline">\(\mathcal{V}^*\)</span> wedged together has <span class="math inline">\(n\)</span> choose <span class="math inline">\(n\)</span> dimensions — that is, there is only one alternating form on <span class="math inline">\(n\)</span> inputs, up to scaling. We arbitrarily choose one such form by picking a basis <span class="math inline">\(V\)</span> and letting <span class="math inline">\(a(v_1, v_2, \ldots, v_n) = 1\)</span> and declaring this to be the <em>signed volume</em> form. In most situations, <span class="math inline">\(\mathcal{V}\)</span> is an inner product space and we choose <span class="math inline">\(V\)</span> to be an orthonormal basis.</p>
</section>
<section id="sec-determinant-sec" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="sec-determinant-sec"><span class="header-section-number">4.5.5</span> Determinants</h3>
<p>Let <span class="math inline">\(f \in \mathcal{V}^* \wedge \ldots \wedge \mathcal{V}^*\)</span> be the signed volume form for a space <span class="math inline">\(\mathcal{V}\)</span>. Rather than writing evaluation of <span class="math inline">\(f\)</span> as <span class="math inline">\(f(v_1, v_2, \ldots, v_n)\)</span>, we will collect the arguments into a quasimatrix and write <span class="math inline">\(f(V)\)</span> for the volume associated with a parallelipiped whose edges are vectors <span class="math inline">\(V\)</span>.</p>
<p>If <span class="math inline">\(U\)</span> is a basis such that <span class="math inline">\(f(U) = 1\)</span>, then we can write any other set of <span class="math inline">\(n\)</span> vectors as <span class="math inline">\(UA\)</span> for some matrix <span class="math inline">\(A\)</span>. The <em>determinant</em> of <span class="math inline">\(A\)</span> is the function such that <span class="math inline">\(f(UA) = f(U) \det(A) = \det(A)\)</span>. Put differently, the determinant represents the change of volume in a mapping <span class="math inline">\(L = UAU^{-1}\)</span> represented with respect to a basis quasimatrix <span class="math inline">\(U\)</span> corresponding to a parallelipiped of unit (signed) volume. In order to satisfy this definition, the determinant must be</p>
<ul>
<li><p>An alternating form on the concrete space <span class="math inline">\(\mathbb{F}^n \otimes \ldots
\otimes \mathbb{F}^n\)</span> (written in terms of matrices <span class="math inline">\(\mathbb{F}^{n \times n}\)</span>)</p></li>
<li><p>Equal to one for the identity matrix.</p></li>
</ul>
<p>The interpretation of the determinant as representing a scaling of (signed) volumes explains various other properties, such as the important fact that <span class="math inline">\(\det(AB) = \det(A) \det(B)\)</span>. It also explains why determinants arise in the change-of-variables formula for integration, which is one of the main places where we will see them.</p>
<p>The determinant of a singular matrix must be zero, which explains why we can write the characteristic polynomial for a matrix as <span class="math inline">\(\det(zI-A)\)</span>. However, we prefer to treat both determinants and characteristic polynomials as interesting objects in their own right, and the connection through the determinant as a derived fact.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-axler-2024" class="csl-entry" role="listitem">
Axler, Sheldon. 2024. <em>Linear Algebra Done Right</em>. Fourth. Springer.
</div>
<div id="ref-lax-2007" class="csl-entry" role="listitem">
Lax, Peter D. 2007. <em>Linear Algebra and Its Applications</em>. Second. Wiley.
</div>
<div id="ref-lay-2015" class="csl-entry" role="listitem">
Lay, David C., Steven R. Lay, and Judi J. McDonald. 2015. <em>Linear Algebra and Its Applications</em>. Fifth. Pearson.
</div>
<div id="ref-strang-2023" class="csl-entry" role="listitem">
Strang, Gilbert. 2023. <em>Introduction to Linear Algebra</em>. Sixth. Wellesley-Cambridge Press.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>“Vector spaces are like potato chips: you cannot have just one.” - W. Kahan<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In infinite-dimensional settings, we will restrict our attention to <em>continuous</em> linear functionals (the continuous dual space) rather than all linear functionals (the algebraic dual space).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The set containing only the zero vector is the smallest subspace we ever talk about.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>“Caveat lector”: let the reader beware!<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Pafnuty Chebyshev was a nineteenth century Russian mathematician, and his name has been transliterated from the Cyrillic alphabet into the Latin alphabet in several different ways. We inherit our usual spelling from one of the French transliterations, but the symbol <span class="math inline">\(T\)</span> for the polynomials comes from the German transliteration Tschebyscheff.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Some authors write <span class="math inline">\(L(\mathcal{V}, \mathcal{U})\)</span> for the set of <em>bounded</em> linear maps between two spaces. This distinction matters when we are dealing with infinite-dimensional normed vector spaces — since we are <em>mostly</em> concerned with the finite-dimensional case, we will not worry about it.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>In the absence of an inner product, the coimage is most naturally thought of as a subspace of <span class="math inline">\(\mathcal{V}^*\)</span> and the cokernel as a subspace of <span class="math inline">\(\mathcal{W}^*\)</span>. The Riesz map allows us to move these back to subspaces of <span class="math inline">\(\mathcal{V}\)</span> and <span class="math inline">\(\mathcal{W}\)</span>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The notion of an induced norm makes sense in infinite-dimensional spaces as well, but there the supremum may not be achieved.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>A monic polynomial is one in which the coefficient in front of the highest-degree term is 1.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>There is a canonical injection <span class="math inline">\(\mathcal{V}\rightarrow \mathcal{V}^{**}\)</span> via <span class="math inline">\(v \mapsto (w^* \mapsto w^* v)\)</span>. In finite-dimensional spaces, this is alway also surjective; in infinite-dimensional spaces, it is only surjective when the space is <em>reflexive</em>.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../00-Background/02-Performance.html" class="pagination-link" aria-label="Performance Basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Performance Basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../00-Background/04-Calculus.html" class="pagination-link" aria-label="Calculus and analysis">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Calculus and analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>